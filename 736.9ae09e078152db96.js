"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[736],{2491:(G,y,s)=>{s.d(y,{L:()=>T});var _=s(93075);class T{static isEmptyInputValue(l){return null==l||0===l.length}static mustMatch(l,m){return u=>{const g=u.get(l),c=u.get(m);if(!g||!c||(c.hasError("mustMatch")&&(delete c.errors.mustMatch,c.updateValueAndValidity()),this.isEmptyInputValue(c.value)||g.value===c.value))return null;const f={mustMatch:"Las contrase\xf1a no coinciden."};return c.setErrors(f),f}}static strongPassWord(l,m,u,g,c){return f=>{const v=f.value;if(!v)return null;const Z=!l||/[A-Z]+/.test(v),C=!m||/[a-z]+/.test(v),k=!u||/[0-9]+/.test(v),b=!g||!/^[a-zA-Z0-9]+$/.test(v);return Z&&C&&k&&b&&v.length>=c?null:{password:"La contrase\xf1a no cumple con los est\xe1ndares de seguridad requeridos"}}}static onlyNumber(l){return m=>{const u=m.get(l);if(!u||!u.value||(u.hasError("onlyNumber")&&(delete u.errors.onlyNumber,u.updateValueAndValidity()),/^[a-zA-Z0-9]+$/.test(u.value.toString())))return null;const c={onlyNumber:"Solo se admiten n\xfameros."};return console.log(c),u.setErrors(c),c}}static strongPasWordPattern(){return _.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)}static emailPattern(){return _.kI.pattern("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$")}static onlyNumbersPattern(){return _.kI.pattern("^[0-9]*$")}static numbersAndDecimalsPattern(){return _.kI.pattern(/^-?\d*[.,]?\d{0,2}$/)}static onlyAlphabetsWithAccentPattern(){return _.kI.pattern("^[a-zA-Z \xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda\xf1\xd1\xfc\xdc]*$")}static onlyAlphabetsPattern(){return _.kI.pattern("^[a-zA-Z ]*$")}static validateIdNumber(){return l=>{if(!l)return null;let m=l.value;if(!m)return null;void 0!==l.value.idNumber&&(m=l.value.idNumber);const u=parseInt(m.substring(0,2),10),g=parseInt(m.substring(2,4),10)-1,c=parseInt(m.substring(4,6),10),f=new Date(u,g,c);if(f.getFullYear().toString().substring(2,4)===u.toString()&&f.getMonth()===g&&f.getDate()===c)return null;const Z={validateIdNumber:"El n\xfamero de identidad introducido es incorrecto"};return l.setErrors(Z),Z}}static validFullName(l){return m=>{const u=m.get(l);if(!u||!l||(u.hasError("validFullName")&&(delete u.errors.validFullName,u.updateValueAndValidity()),this._isEmptyInputValue(u.value))||u.value.trim().split(" ").length>1)return null;const g={validFullName:"El nombre completo deber\xe1 tener al menos un nombre y un apellido"};return u.setErrors(g),g}}static checkOnSaleQty(l,m){return u=>{const g=u.get(l),c=u.get(m);if(!g||!c||(c.hasError("invalid")&&(delete c.errors.invalid,c.updateValueAndValidity()),g.value>=c.value))return null;const f={invalid:"La cantidad en venta no debe ser mayor a la disponible"};return c.setErrors(f),f}}static luhnValidator(){return l=>l.value?this.luhnCheck(l.value)?null:{luhnCheck:"Formato no v\xe1lido"}:null}static _isEmptyInputValue(l){return null==l||0===l.length}static luhnCheck(l){if(!l||!l.length)return!1;l=l.replace(/\s/g,"");const m=Number(l[l.length-1]),u=l.slice(0,l.length-1).split("").reverse().map(c=>Number(c));let g=0;for(let c=0;c<=u.length-1;c+=2)u[c]=2*u[c],u[c]>9&&(u[c]=u[c]-9);return g=u.reduce((c,f)=>c+f,0),(g+m)%10==0}}},94736:(G,y,s)=>{s.r(y),s.d(y,{UsersModule:()=>ht});var _=s(35357),T=s(17460),a=s(93075),l=s(77579),m=s(82722),u=s(45840),g=s(22594),c=s(88765),f=s(60628),v=s(8035),Z=s(63844),C=s(59784);const k={id:null,userId:null,active:!0,name:null,lastname1:"",lastname2:"",email:null,role:null,roleId:null,employeeId:null,merchantId:null,appConfig:null,username:null,avatar:null,bio:null,fullname:null};var b=s(2491),e=s(5e3),F=s(71683),w=s(71329),J=s(57261),A=s(85094),h=s(69808),L=s(29071),H=s(90508),Q=s(47423),P=s(77446),I=s(80288),D=s(25245),x=s(67322),N=s(98833),j=s(74107),S=s(32368);function W(n,i){1&n&&(e.ynx(0),e.TgZ(1,"a",40),e._uU(2,"Nuevo"),e.qZA(),e.BQk())}function X(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"a",40),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.lnq("",t.selectedUser.name," ",t.selectedUser.lastname1," ",t.selectedUser.lastname2,"")}}function ee(n,i){1&n&&(e.ynx(0),e._uU(1," Nuevo "),e.BQk())}function te(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.lnq(" ",t.selectedUser.name," ",t.selectedUser.lastname1," ",t.selectedUser.lastname2," ")}}const z=function(n){return{"cursor-not-allowed":n}};function ne(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",41),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.createUser())}),e._UZ(1,"mat-icon",42),e.TgZ(2,"span",43),e._uU(3,"Guardar"),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,z,t.userForm.invalid))("disabled",t.userForm.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function re(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.updateUser())}),e._UZ(1,"mat-icon",42),e.TgZ(2,"span",43),e._uU(3,"Actualizar"),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.userForm.invalid)("ngClass",e.VKq(3,z,t.userForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}function oe(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function ie(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre debe contener entre 3 y 255 caracteres. "),e.qZA())}function se(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre no debe poseer n\xfameros. "),e.qZA())}function ae(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El primer apellido es obligatorios. "),e.qZA())}function le(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El primer apellido debe contener entre 3 y 255 caracteres. "),e.qZA())}function ce(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El primer apellido no debe poseer n\xfameros. "),e.qZA())}function me(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El segundo apellido es obligatorio. "),e.qZA())}function ue(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El segundo apellido debe contener entre 3 y 255 caracteres. "),e.qZA())}function de(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El segundo apellido no debe poseer n\xfameros. "),e.qZA())}function pe(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El correo electr\xf3nico es obligatorio. "),e.qZA())}function ge(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El correo no posee un formato v\xe1lido. "),e.qZA())}function fe(n,i){if(1&n&&(e.TgZ(0,"mat-option",45),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("value",t.id),e.xp6(1),e.lnq(" ",t.name," ",t.lastname1," ",t.lastname2," ")}}function _e(n,i){1&n&&e._UZ(0,"mat-icon",55),2&n&&e.Q6J("svgIcon","mat_solid:visibility")}function he(n,i){1&n&&e._UZ(0,"mat-icon",55),2&n&&e.Q6J("svgIcon","mat_solid:visibility-off")}function xe(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La contrase\xf1a es obligatoria. "),e.qZA())}function ve(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,' La contrase\xf1a deber\xe1 tener entre 8 y 100 caracteres e incluir may\xfasculas, min\xfasculas n\xfameros y s\xedmbolos como: ! " ? $ % ^ &. '),e.qZA())}function be(n,i){1&n&&e._UZ(0,"mat-icon",55),2&n&&e.Q6J("svgIcon","mat_solid:visibility")}function Ue(n,i){1&n&&e._UZ(0,"mat-icon",55),2&n&&e.Q6J("svgIcon","mat_solid:visibility-off")}function Ze(n,i){1&n&&(e.TgZ(0,"mat-error",56),e._uU(1," La contrase\xf1a es obligatoria "),e.qZA())}function Ce(n,i){if(1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userForm.get("pwd2").getError("mustMatch")," ")}}function we(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",46)(1,"mat-expansion-panel-header",21)(2,"mat-panel-title",22)(3,"div",23),e._uU(4," Contrase\xf1a "),e.qZA()()(),e.TgZ(5,"div",47)(6,"div",25)(7,"mat-form-field",26)(8,"mat-label"),e._uU(9,"Contrase\xf1a"),e.qZA(),e._UZ(10,"input",48,49),e.TgZ(12,"button",50),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(11);return e.KtG(o.type="password"===o.type?"text":"password")}),e.YNc(13,_e,1,1,"mat-icon",51),e.YNc(14,he,1,1,"mat-icon",51),e.qZA(),e.YNc(15,xe,2,0,"mat-error",7),e.YNc(16,ve,2,0,"mat-error",7),e.qZA()(),e.TgZ(17,"div",25)(18,"mat-form-field",26)(19,"mat-label"),e._uU(20,"Confirmar contrase\xf1a"),e.qZA(),e._UZ(21,"input",52,53),e.TgZ(23,"button",50),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(22);return e.KtG(o.type="password"===o.type?"text":"password")}),e.YNc(24,be,1,1,"mat-icon",51),e.YNc(25,Ue,1,1,"mat-icon",51),e.qZA(),e.YNc(26,Ze,2,0,"mat-error",54),e.YNc(27,Ce,2,1,"mat-error",7),e.qZA()()()()}if(2&n){const t=e.MAs(11),r=e.MAs(22),o=e.oxw();e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(9),e.Q6J("formControlName","pwd")("minlength",8)("maxlength",100),e.xp6(3),e.Q6J("ngIf","password"===t.type),e.xp6(1),e.Q6J("ngIf","text"===t.type),e.xp6(1),e.Q6J("ngIf",o.userForm.get("pwd").hasError("required")),e.xp6(1),e.Q6J("ngIf",o.userForm.get("pwd").hasError("pattern")||o.userForm.get("pwd").hasError("minlength")),e.xp6(5),e.Q6J("formControlName","pwd2"),e.xp6(3),e.Q6J("ngIf","password"===r.type),e.xp6(1),e.Q6J("ngIf","text"===r.type),e.xp6(1),e.Q6J("ngIf",o.userForm.get("pwd2").hasError("required")),e.xp6(1),e.Q6J("ngIf",o.userForm.get("pwd2").hasError("mustMatch"))}}function ye(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",62)(1,"mat-checkbox",63),e.NdJ("change",function(o){const p=e.CHM(t).$implicit,U=e.oxw(2);return e.KtG(U.markRole(p.id,o.checked))}),e.qZA(),e.TgZ(2,"div",64),e.NdJ("click",function(){const d=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.markRole(d.id,!d.checked))}),e.TgZ(3,"span",65),e._uU(4),e.qZA(),e.TgZ(5,"div",66),e._uU(6),e.qZA()()()}if(2&n){const t=i.$implicit;e.xp6(1),e.Q6J("color","primary")("color","primary")("checked",t.checked),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.description," ")}}function Ae(n,i){if(1&n&&(e.TgZ(0,"mat-expansion-panel",57)(1,"mat-expansion-panel-header",21)(2,"mat-panel-title",22)(3,"div",23),e._uU(4," Roles "),e.qZA()()(),e.TgZ(5,"div",58)(6,"div",59)(7,"div",60),e.YNc(8,ye,7,5,"div",61),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(7),e.Q6J("ngForOf",t.roles)}}let Ie=(()=>{class n{constructor(t,r,o,d,p,U,M,R){this._activatedRoute=t,this._fuseConfirmationService=r,this._changeDetectorRef=o,this._formBuilder=d,this._router=p,this._userService=U,this._snackBar=M,this.store=R,this.windowMode="new",this.selectedUser=k,this.roles=[],this.employees=[],this._unsubscribeAll=new l.x}ngOnInit(){this.store.select(g.Qs).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(v.ri).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.employees=t,this._changeDetectorRef.markForCheck()}),this.store.select(c.dy).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.selectedUser=t}),this.userForm=this._formBuilder.group({id:[null],active:[!0],merchantId:[this.currentMerchant.id,[a.kI.required]],employeeId:[{value:"",disabled:!0},[a.kI.required]],name:[null,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255),b.L.onlyAlphabetsWithAccentPattern()]],lastname1:[null,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255),b.L.onlyAlphabetsWithAccentPattern()]],lastname2:[null,[a.kI.minLength(3),a.kI.maxLength(255),b.L.onlyAlphabetsWithAccentPattern()]],email:[null,[a.kI.email,a.kI.required]],pwd:["",[a.kI.minLength(8),a.kI.maxLength(100),b.L.strongPasWordPattern()]],pwd2:[""],roleId:[null,[a.kI.required]]},{validators:b.L.mustMatch("pwd","pwd2")}),this._activatedRoute.params.pipe((0,m.R)(this._unsubscribeAll)).subscribe(({userId:t})=>{this.windowMode="new"===t?"new":"edit",this._fillUserData(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createUser(){const t=this.userForm.getRawValue();delete t.id,delete t.pwd2,this._fuseConfirmationService.open({title:"Crear usuario",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,m.R)(this._unsubscribeAll)).subscribe(o=>{"confirmed"===o&&this._userService.createUser(t).pipe((0,m.R)(this._unsubscribeAll)).subscribe(({data:d})=>{d&&(this._snackBar.openFromComponent(C.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Usuario creado correctamente",title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._router.navigateByUrl("/modules/users"))})}),this._changeDetectorRef.markForCheck()}updateUser(){const t=this.userForm.getRawValue();delete t.pwd,delete t.pwd2,this._fuseConfirmationService.open({title:"Actualizar datos del usuario",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._userService.updateUser(t).pipe((0,m.R)(this._unsubscribeAll)).subscribe(({data:d})=>{d&&(this._snackBar.openFromComponent(C.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Usuario actualizado correctamente",title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._router.navigateByUrl("/modules/users"))})}),this._changeDetectorRef.markForCheck()}trackByFn(t,r){return r.id||t}markRole(t,r){for(const o of this.roles)o.id===t&&r?(o.checked=!0,this.userForm.get("roleId").setValue(o.id)):o.checked=!1;this.roles.some(o=>o.checked)||this.userForm.get("roleId").setValue(null),this._changeDetectorRef.markForCheck()}_fillUserData(){"edit"===this.windowMode&&(this.userForm.patchValue(this.selectedUser),this.userForm.get("pwd").removeValidators([a.kI.required]),this.userForm.get("pwd").removeValidators([a.kI.required])),"new"===this.windowMode&&(this.userForm.get("pwd").setValidators([a.kI.required]),this.userForm.get("pwd2").setValidators([a.kI.required]),this.store.select(f.g$).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.roles=(0,u.Z)(t),this._changeDetectorRef.markForCheck()}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(_.gz),e.Y36(F.R),e.Y36(e.sBO),e.Y36(a.QS),e.Y36(_.F0),e.Y36(w.K),e.Y36(J.ux),e.Y36(A.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ath-user-detail"]],decls:83,vars:52,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[4,"ngIf"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-raised-button","","class","ml-4 text-white bg-primary-500 hover:shadow-lg","mat-button","",3,"ngClass","disabled","click",4,"ngIf"],["mat-raised-button","","class","ml-4 text-white bg-primary-500 hover:shadow-lg","mat-button","",3,"disabled","ngClass","click",4,"ngIf"],[1,"flex-auto","p-4","shadow","sm:p-6","bg-mine-200","sm:p-10","rounded-t-2xl"],[1,"flex","flex-col","flex-auto","min-w-0"],[3,"formGroup","autocomplete"],["multi","",1,"w-full","bg-transparent"],[2,"border-top-left-radius","0.5rem !important","border-top-right-radius","0.5rem !important",3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"grid","w-full","pt-8","pb-8","pl-4","pr-4","border-t-2","gap-y-3","gap-x-6","sm:grid-cols-4"],[1,"sm:col-span-2"],[1,"w-full"],["matInput","","required","",3,"type","formControlName","placeholder","minlength","maxlength"],[1,""],["matInput","","required","",3,"type","formControlName","minlength","maxlength"],["matInput","",3,"type","formControlName","minlength","maxlength"],["matInput","","required","",3,"type","formControlName","placeholder"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","sm:col-span-2"],[1,"flex","flex-col","w-1/4"],[1,"items-start","font-medium"],[3,"formControlName","color"],["style","border-bottom-left-radius: 0.5rem !important; border-bottom-right-radius:0.5rem !important",3,"expanded",4,"ngIf"],["style","border-bottom-left-radius: 0.5rem !important; border-bottom-right-radius:0.5rem !important",4,"ngIf"],[1,"ml-1","text-primary-700"],["mat-raised-button","","mat-button","",1,"ml-4","text-white","bg-primary-500","hover:shadow-lg",3,"ngClass","disabled","click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["mat-raised-button","","mat-button","",1,"ml-4","text-white","bg-primary-500","hover:shadow-lg",3,"disabled","ngClass","click"],[3,"value"],[2,"border-bottom-left-radius","0.5rem !important","border-bottom-right-radius","0.5rem !important",3,"expanded"],[1,"grid","w-full","pt-8","pb-8","pl-4","pr-4","border-t-2","gap-y-3","gap-x-6","sm:grid-cols-2","md:grid-cols-4"],["type","password","placeholder","Contrase\xf1a","matInput","","required","",3,"formControlName","minlength","maxlength"],["passwordField1",""],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["type","password","placeholder","Repita la contrase\xf1a","matInput","","required","",3,"formControlName"],["passwordField2",""],["class","pb-5",4,"ngIf"],[1,"icon-size-5",3,"svgIcon"],[1,"pb-5"],[2,"border-bottom-left-radius","0.5rem !important","border-bottom-right-radius","0.5rem !important"],[1,"flex","flex-col","w-full","px-4","pt-8","pb-8","border-t-2"],[1,"flex","flex-col"],[1,"flex","flex-wrap","w-full","gap-4","sm:grid","sm:grid-cols-3","md:grid-cols-4"],["class","relative w-full p-3 overflow-hidden border border-dashed rounded-sm cursor-pointer sm:w-auto border-primary-700 max-h-30 ",4,"ngFor","ngForOf"],[1,"relative","w-full","p-3","overflow-hidden","border","border-dashed","rounded-sm","cursor-pointer","sm:w-auto","border-primary-700","max-h-30"],[1,"absolute","top-2.5","left-3",3,"color","checked","change"],[1,"h-full",3,"click"],[1,"h-6","ml-6","font-medium","truncate"],[1,"whitespace-pre-line","text-md","text-hint","line-clamp-3"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",5),e._uU(11,"Usuarios"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.YNc(14,W,3,0,"ng-container",7),e.YNc(15,X,3,3,"ng-container",7),e.qZA()(),e.TgZ(16,"div",8)(17,"a",9),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",10),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",11)(22,"div",12),e.YNc(23,ee,2,0,"ng-container",7),e.YNc(24,te,2,3,"ng-container",7),e.qZA()()(),e.TgZ(25,"div",13),e.YNc(26,ne,4,5,"button",14),e.YNc(27,re,4,5,"button",15),e.qZA()(),e.TgZ(28,"div",16)(29,"div",17)(30,"form",18)(31,"mat-accordion",19)(32,"mat-expansion-panel",20)(33,"mat-expansion-panel-header",21)(34,"mat-panel-title",22)(35,"div",23),e._uU(36," Informaci\xf3n General "),e.qZA()()(),e.TgZ(37,"div",24)(38,"div",25)(39,"mat-form-field",26)(40,"mat-label"),e._uU(41,"Nombre"),e.qZA(),e._UZ(42,"input",27),e.YNc(43,oe,2,0,"mat-error",7),e.YNc(44,ie,2,0,"mat-error",7),e.YNc(45,se,2,0,"mat-error",7),e.qZA()(),e.TgZ(46,"div",28)(47,"mat-form-field",26)(48,"mat-label"),e._uU(49,"Primer Apellido"),e.qZA(),e._UZ(50,"input",29),e.YNc(51,ae,2,0,"mat-error",7),e.YNc(52,le,2,0,"mat-error",7),e.YNc(53,ce,2,0,"mat-error",7),e.qZA()(),e.TgZ(54,"div",28)(55,"mat-form-field",26)(56,"mat-label"),e._uU(57,"Segundo apellido"),e.qZA(),e._UZ(58,"input",30),e.YNc(59,me,2,0,"mat-error",7),e.YNc(60,ue,2,0,"mat-error",7),e.YNc(61,de,2,0,"mat-error",7),e.qZA()(),e.TgZ(62,"div",25)(63,"mat-form-field",26)(64,"mat-label"),e._uU(65,"Correo electr\xf3nico"),e.qZA(),e._UZ(66,"input",31),e.YNc(67,pe,2,0,"mat-error",7),e.YNc(68,ge,2,0,"mat-error",7),e.qZA()(),e.TgZ(69,"div",25)(70,"mat-form-field",26)(71,"mat-label"),e._uU(72,"Empleado"),e.qZA(),e.TgZ(73,"mat-select",32),e.YNc(74,fe,2,4,"mat-option",33),e.qZA()()(),e.TgZ(75,"div",34)(76,"div",35)(77,"span",36),e._uU(78,"Estado"),e.qZA(),e.TgZ(79,"mat-slide-toggle",37),e._uU(80),e.qZA()()()()(),e.YNc(81,we,28,14,"mat-expansion-panel",38),e.YNc(82,Ae,9,2,"mat-expansion-panel",39),e.qZA()()()()()),2&t&&(e.xp6(6),e.Q6J("routerLink","/desktop"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink","/modules/users"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("ngIf","new"===r.windowMode),e.xp6(1),e.Q6J("ngIf","new"!==r.windowMode),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(5),e.Q6J("ngIf","new"===r.windowMode),e.xp6(1),e.Q6J("ngIf","new"!==r.windowMode),e.xp6(2),e.Q6J("ngIf","new"===r.windowMode),e.xp6(1),e.Q6J("ngIf","new"!==r.windowMode),e.xp6(3),e.Q6J("formGroup",r.userForm)("autocomplete","off"),e.xp6(2),e.Udp("border-bottom-left-radius","new"!==r.windowMode?"0.5rem !important":""),e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(9),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre")("minlength",3)("maxlength",255),e.xp6(1),e.Q6J("ngIf",r.userForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",r.userForm.get("name").hasError("maxlength")||r.userForm.get("name").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",r.userForm.get("name").hasError("pattern")),e.xp6(5),e.Q6J("type","text")("formControlName","lastname1")("minlength",3)("maxlength",255),e.xp6(1),e.Q6J("ngIf",r.userForm.get("lastname1").hasError("required")),e.xp6(1),e.Q6J("ngIf",r.userForm.get("lastname1").hasError("maxlength")||r.userForm.get("lastname1").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",r.userForm.get("lastname1").hasError("pattern")),e.xp6(5),e.Q6J("type","text")("formControlName","lastname2")("minlength",3)("maxlength",255),e.xp6(1),e.Q6J("ngIf",r.userForm.get("lastname2").hasError("required")),e.xp6(1),e.Q6J("ngIf",r.userForm.get("lastname2").hasError("maxlength")||r.userForm.get("lastname2").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",r.userForm.get("lastname2").hasError("pattern")),e.xp6(5),e.Q6J("type","email")("formControlName","email")("placeholder","Correo electr\xf3nico"),e.xp6(1),e.Q6J("ngIf",r.userForm.get("email").hasError("required")),e.xp6(1),e.Q6J("ngIf",r.userForm.get("email").hasError("email")),e.xp6(5),e.Q6J("formControlName","employeeId"),e.xp6(1),e.Q6J("ngForOf",r.employees),e.xp6(5),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===r.userForm.get("active").value?"Activo":"Inactivo"," "),e.xp6(1),e.Q6J("ngIf","edit"!==r.windowMode),e.xp6(1),e.Q6J("ngIf","edit"!==r.windowMode))},dependencies:[_.yS,h.mk,h.sg,h.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.sg,a.u,L.PQ,H.ey,Q.lW,P.oG,I.pp,I.ib,I.yz,I.yK,D.Hw,x.TO,x.KE,x.hX,x.R9,N.Nt,j.gD,S.Rr],encapsulation:2,data:{animation:Z.L},changeDetection:0}),n})();var Te=s(15861),B=s(86087),q=s(84847),O=s(39646),ke=s(78372),Fe=s(68675),V=s(63900),Je=s(54004),Qe=s(56451),De=s(86428),E=s(48966),Ne=s(17489),$=s(87238);function qe(n,i){1&n&&e._UZ(0,"mat-icon",25),2&n&&e.Q6J("svgIcon","mat_solid:visibility")}function Ee(n,i){1&n&&e._UZ(0,"mat-icon",25),2&n&&e.Q6J("svgIcon","mat_solid:visibility-off")}function Ye(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La contrase\xf1a es obligatoria "),e.qZA())}function Me(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,' La contrase\xf1a deber\xe1 tener entre 8 y 100 caracteres e incluir may\xfasculas, min\xfasculas n\xfameros y s\xedmbolos como: !" ? $ % ^ &. '),e.qZA())}function Re(n,i){1&n&&e._UZ(0,"mat-icon",25),2&n&&e.Q6J("svgIcon","mat_solid:visibility")}function Le(n,i){1&n&&e._UZ(0,"mat-icon",25),2&n&&e.Q6J("svgIcon","mat_solid:visibility-off")}function Pe(n,i){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La contrase\xf1a es obligatoria "),e.qZA())}function Se(n,i){if(1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.userPasswordForm.get("pwd2").getError("mustMatch")," ")}}function ze(n,i){if(1&n){const t=e.EpF();e.ynx(0)(1),e.TgZ(2,"div",13)(3,"div",14)(4,"div",15)(5,"form",16)(6,"div",17)(7,"mat-form-field",18)(8,"mat-label"),e._uU(9,"Contrase\xf1a"),e.qZA(),e._UZ(10,"input",19,20),e.TgZ(12,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(11);return e.KtG(o.type="password"===o.type?"text":"password")}),e.YNc(13,qe,1,1,"mat-icon",22),e.YNc(14,Ee,1,1,"mat-icon",22),e.qZA(),e.YNc(15,Ye,2,0,"mat-error",9),e.YNc(16,Me,2,0,"mat-error",9),e.qZA(),e.TgZ(17,"mat-form-field",18)(18,"mat-label"),e._uU(19,"Confirmar contrase\xf1a "),e.qZA(),e._UZ(20,"input",23,24),e.TgZ(22,"button",21),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(21);return e.KtG(o.type="password"===o.type?"text":"password")}),e.YNc(23,Re,1,1,"mat-icon",22),e.YNc(24,Le,1,1,"mat-icon",22),e.qZA(),e.YNc(25,Pe,2,0,"mat-error",9),e.YNc(26,Se,2,1,"mat-error",9),e.qZA()()()()()(),e.BQk()()}if(2&n){const t=e.MAs(11),r=e.MAs(21),o=e.oxw();e.xp6(5),e.Q6J("formGroup",o.userPasswordForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","pwd")("minlength",8)("maxlength",100),e.xp6(3),e.Q6J("ngIf","password"===t.type),e.xp6(1),e.Q6J("ngIf","text"===t.type),e.xp6(1),e.Q6J("ngIf",o.userPasswordForm.get("pwd").hasError("required")),e.xp6(1),e.Q6J("ngIf",o.userPasswordForm.get("pwd").hasError("pattern")||o.userPasswordForm.get("pwd").hasError("minlength")),e.xp6(4),e.Q6J("formControlName","pwd2"),e.xp6(3),e.Q6J("ngIf","password"===r.type),e.xp6(1),e.Q6J("ngIf","text"===r.type),e.xp6(1),e.Q6J("ngIf",o.userPasswordForm.get("pwd2").hasError("required")),e.xp6(1),e.Q6J("ngIf",o.userPasswordForm.get("pwd2").hasError("mustMatch"))}}function Be(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",30)(1,"mat-checkbox",31),e.NdJ("change",function(o){const p=e.CHM(t).$implicit,U=e.oxw(2);return e.KtG(U.markRole(p.id,o.checked))}),e.qZA(),e.TgZ(2,"div",32),e.NdJ("click",function(){const d=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.markRole(d.id,!d.checked))}),e.TgZ(3,"span",33),e._uU(4),e.qZA(),e.TgZ(5,"div",34),e._uU(6),e.qZA()()()}if(2&n){const t=i.$implicit;e.xp6(1),e.Q6J("color","primary")("color","primary")("checked",t.checked),e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.description," ")}}function Oe(n,i){if(1&n&&(e.ynx(0)(1),e.TgZ(2,"div",13)(3,"div",14)(4,"div",26)(5,"div",27)(6,"div",28),e.YNc(7,Be,7,5,"div",29),e.qZA()()()()(),e.BQk()()),2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngForOf",t.roles)}}const K=function(n){return{"cursor-not-allowed":n}};function Ve(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.updateUser())}),e._uU(1," Actualizar Rol "),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.selectedRoleId)("matTooltip","Actualizar")("ngClass",e.VKq(3,K,!t.selectedRoleId))}}function $e(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.updateUserPassword())}),e._uU(1," Actualizar Contrase\xf1a "),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.userPasswordForm.invalid)("matTooltip","Actualizar")("ngClass",e.VKq(3,K,t.userPasswordForm.invalid))}}let Ke=(()=>{class n{constructor(t,r,o,d,p,U,M,R){this.data=t,this._dialogRef=r,this._changeDetectorRef=o,this._formBuilder=d,this._fuseConfirmationService=p,this._userService=U,this._snackBar=M,this.store=R,this.dialogMode="edit",this.roles=[],this.selectedRoleId="",this._unsubscribeAll=new l.x,this.dialogMode=t.dialogMode,this.selectedUser=t.user}ngOnInit(){"editPass"===this.dialogMode&&(this.userPasswordForm=this._formBuilder.group({id:[this.selectedUser.id,[a.kI.required]],pwd:[null,[a.kI.required,a.kI.minLength(8),a.kI.maxLength(100),b.L.strongPasWordPattern()]],pwd2:[null,[a.kI.required]]},{validators:b.L.mustMatch("pwd","pwd2")})),"edit"===this.dialogMode&&this.store.select(f.g$).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{const r=(0,Ne.cloneDeep)(t);r.forEach(o=>{o.checked=this.selectedUser.roleId===o.id,o.checked&&(this.selectedRoleId=o.id)}),this.roles=r,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}updateUser(){this._fuseConfirmationService.open({title:"Actualizar roles de usuario",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._userService.updateUser({id:this.selectedUser.id,roleId:this.selectedRoleId,email:this.selectedUser.email,name:this.selectedUser.name,employeeId:this.selectedUser.employeeId}).pipe((0,m.R)(this._unsubscribeAll)).subscribe(({data:o})=>{o&&(this._snackBar.openFromComponent(C.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Rol actualizado correctamente",title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this.closeDialog())})})}updateUserPassword(){const t=this.userPasswordForm.getRawValue();delete t.pwd2,this._fuseConfirmationService.open({title:"Actualizar contrase\xf1a",message:"\xbfEst\xe1 seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._userService.resetUserPwd({id:t.id,newPwd:t.pwd}).pipe((0,m.R)(this._unsubscribeAll)).subscribe(({data:d})=>{d&&(this._snackBar.openFromComponent(C.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.resetUserPwd,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this.closeDialog())})})}markRole(t,r){for(const o of this.roles)o.id===t&&r?(o.checked=!0,this.selectedRoleId=o.id):o.checked=!1;this.roles.some(o=>o.checked)||(this.selectedRoleId=null),this._changeDetectorRef.markForCheck()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(E.WI),e.Y36(E.so),e.Y36(e.sBO),e.Y36(a.QS),e.Y36(F.R),e.Y36(w.K),e.Y36(J.ux),e.Y36(A.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["user-role-dialog"]],decls:19,vars:11,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","flex-auto","w-full"],[1,"w-full","px-12","py-5"],[1,"flex","w-full"],[1,"flex","flex-col","justify-end","w-4/5","my-2"],[1,"text-2xl","font-bold","truncate","sm:text-2xl"],[1,"flex","text-xl","font-normal","text-red-900","truncate","cursor-pointer","hover:underline"],[1,"mr-2.5","text-mine-900",3,"svgIcon"],["target","_blank",1,"text-primary-900","hover:text-primary-700",3,"href"],[4,"ngIf"],[1,"flex","items-center","w-full","px-8","py-4","space-x-3","sm:justify-end","sm:px-12","bg-gray-50","dark:bg-transparent"],["mat-stroked-button","",3,"matTooltip","click"],["mat-flat-button","","class","text-white bg-primary-500",3,"disabled","matTooltip","ngClass","click",4,"ngIf"],[1,"flex","flex-col","border-t","gap-y-5"],[1,"flex","flex-col","w-full","gap-8","md:flex-row"],[1,"flex","flex-col","w-full","space-y-4"],[1,"flex","flex-col",3,"formGroup","autocomplete"],[1,"flex","flex-col","w-full","gap-4","mt-5","mb-2"],[1,"w-full"],["id","pwd","matInput","","type","password","placeholder","Contrase\xf1a","required","",3,"formControlName","minlength","maxlength"],["passwordUpdateField1",""],["mat-icon-button","","type","button","matSuffix","",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],["type","password","matInput","","placeholder","Repita la contrase\xf1a","required","",3,"formControlName"],["passwordUpdateField2",""],[1,"icon-size-5",3,"svgIcon"],[1,"flex","flex-col","w-full","pt-6","space-y-4","sm:mt-4","sm:space-y-8"],[1,"flex","flex-col","mb-10"],[1,"flex","flex-wrap","w-full","gap-4","sm:grid","sm:grid-cols-2"],["class","relative w-full p-3 overflow-hidden border border-dashed rounded-sm cursor-pointer sm:w-auto border-primary-700 max-h-30 ",4,"ngFor","ngForOf"],[1,"relative","w-full","p-3","overflow-hidden","border","border-dashed","rounded-sm","cursor-pointer","sm:w-auto","border-primary-700","max-h-30"],[1,"absolute","top-2.5","left-3",3,"color","checked","change"],[1,"h-full",3,"click"],[1,"h-6","ml-6","font-medium","truncate"],[1,"whitespace-pre-line","text-md","text-hint","line-clamp-3"],["mat-flat-button","",1,"text-white","bg-primary-500",3,"disabled","matTooltip","ngClass","click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),e._uU(6),e.qZA(),e.TgZ(7,"span",6),e._UZ(8,"mat-icon",7),e.TgZ(9,"a",8),e._uU(10),e.qZA()()()(),e.YNc(11,ze,27,14,"ng-container",9),e.YNc(12,Oe,8,1,"ng-container",9),e.qZA(),e.ynx(13),e.TgZ(14,"div",10)(15,"button",11),e.NdJ("click",function(){return r.closeDialog()}),e._uU(16," Cancelar "),e.qZA(),e.YNc(17,Ve,2,5,"button",12),e.YNc(18,$e,2,5,"button",12),e.qZA(),e.BQk(),e.qZA()()),2&t&&(e.xp6(6),e.lnq(" ",r.selectedUser.name," ",r.selectedUser.lastname1," ",r.selectedUser.lastname2," "),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:mail"),e.xp6(1),e.Q6J("href","mailto:"+r.selectedUser.email,e.LSH),e.xp6(1),e.Oqu(r.selectedUser.email),e.xp6(1),e.Q6J("ngIf","editPass"===r.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===r.dialogMode),e.xp6(3),e.Q6J("matTooltip","Cancelar"),e.xp6(2),e.Q6J("ngIf","edit"===r.data.dialogMode),e.xp6(1),e.Q6J("ngIf","editPass"===r.data.dialogMode))},dependencies:[h.mk,h.sg,h.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.sg,a.u,Q.lW,P.oG,D.Hw,x.TO,x.KE,x.hX,x.R9,N.Nt,$.gM],encapsulation:2,data:{animation:Z.L},changeDetection:0}),n})();var Ge=s(20773),He=s(1235);function je(n,i){if(1&n&&(e.TgZ(0,"div",19)(1,"mat-form-field",20),e._UZ(2,"mat-icon",21)(3,"input",22),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Buscar usuario")}}function We(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.lnq("",t.employee.name," ",t.employee.lastname1," ",t.employee.lastname2,"")}}function Xe(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-slide-toggle",41),e.NdJ("change",function(o){e.CHM(t);const d=e.oxw().$implicit,p=e.oxw(3);return e.KtG(p.updateUserStatus(o,d,p.i))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("checked",t.active)("color","primary")}}function et(n,i){1&n&&(e.ynx(0),e._UZ(1,"mat-spinner",42),e.BQk()),2&n&&(e.xp6(1),e.Q6J("diameter",20)("color","primary"))}const tt=function(n){return[n]};function nt(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",31)(2,"div",32),e._uU(3),e.qZA(),e.TgZ(4,"div",33),e._uU(5),e.qZA(),e.TgZ(6,"div",27),e._uU(7),e.qZA(),e.TgZ(8,"div",27),e.YNc(9,We,2,3,"div",16),e.qZA(),e.TgZ(10,"div",34),e.YNc(11,Xe,2,2,"ng-container",16),e.YNc(12,et,2,2,"ng-container",16),e.qZA(),e.TgZ(13,"div",35)(14,"button",36),e._UZ(15,"mat-icon",37),e.qZA(),e.TgZ(16,"button",38),e.NdJ("click",function(){const d=e.CHM(t).$implicit,p=e.oxw(3);return e.KtG(p.openDialog(d,"editPass","720px"))}),e._UZ(17,"mat-icon",37),e.qZA(),e.TgZ(18,"button",39),e.NdJ("click",function(){const d=e.CHM(t).$implicit,p=e.oxw(3);return e.KtG(p.openDialog(d,"edit","720px"))}),e._UZ(19,"mat-icon",37),e.qZA(),e.TgZ(20,"button",40),e.NdJ("click",function(){const d=e.CHM(t).$implicit,p=e.oxw(3);return e.KtG(p.deleteUser(d))}),e._UZ(21,"mat-icon",37),e.qZA()()(),e.BQk()}if(2&n){const t=i.$implicit,r=e.oxw(3);e.xp6(3),e.lnq(" ",t.name," ",t.lastname1," ",t.lastname2," "),e.xp6(2),e.hij(" ",t.email," "),e.xp6(2),e.hij(" ",t.role.name," "),e.xp6(2),e.Q6J("ngIf",t.employee),e.xp6(2),e.Q6J("ngIf",!(r.isLoading&&r.selectedSlide===r.i)),e.xp6(1),e.Q6J("ngIf",r.isLoading&&r.selectedSlide===r.i),e.xp6(2),e.Q6J("routerLink",e.VKq(13,tt,t.id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:key"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:shield-check"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function rt(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"div",24)(2,"div",25)(3,"div",26),e._uU(4," Nombre y Apellidos "),e.qZA(),e.TgZ(5,"div",26)(6,"span"),e._uU(7,"Correo electr\xf3nico"),e.qZA()(),e.TgZ(8,"div",27),e._uU(9," Rol "),e.qZA(),e.TgZ(10,"div",27),e._uU(11," Empleado "),e.qZA(),e.TgZ(12,"div",28)(13,"span"),e._uU(14,"Activo"),e.qZA()(),e.TgZ(15,"div",29),e._uU(16," Acciones "),e.qZA()(),e.YNc(17,nt,22,15,"ng-container",30),e.qZA(),e.BQk()),2&n){const t=e.oxw().ngIf,r=e.oxw();e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","email"),e.xp6(7),e.Q6J("mat-sort-header","active"),e.xp6(5),e.Q6J("ngForOf",t)("ngForTrackBy",r.trackByFn)}}function ot(n,i){if(1&n&&(e.ynx(0),e.YNc(1,rt,18,5,"ng-container",23),e.BQk()),2&n){const t=i.ngIf;e.oxw();const r=e.MAs(27);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",r)}}const it=function(n){return{"pointer-events-none":n}},st=function(){return[10,25,50,100]};function at(n,i){if(1&n&&e._UZ(0,"mat-paginator",44),2&n){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(6,it,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(8,st))("showFirstLastButtons",!0)}}function lt(n,i){if(1&n&&(e.ynx(0),e.YNc(1,at,1,9,"mat-paginator",43),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.pagination.length>0)}}function ct(n,i){if(1&n&&(e.TgZ(0,"div",46),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.searchInputControl.value?"\xa1No se han encontrado usuarios!":"\xa1No se ha creado ning\xfan usuario a\xfan!"," ")}}const Y=function(){return["Due\xf1o"]};function mt(n,i){1&n&&e.YNc(0,ct,2,1,"div",45),2&n&&e.Q6J("ngxPermissionsOnly",e.DdM(1,Y))}let ut=(()=>{class n{constructor(t,r,o,d,p,U){this._changeDetectorRef=t,this._fuseConfirmationService=r,this._userDialog=o,this._userService=d,this._snackBar=p,this.store=U,this.searchInputControl=new a.NI(null),this.users$=(0,O.of)([]),this.isLoading=!1,this.selectedSlide=null,this._unsubscribeAll=new l.x}ngOnInit(){this.users$=this.store.select(c.YN),this.store.select(De.B).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(g.Qs).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.searchInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,ke.b)(300),(0,Fe.O)(null),(0,V.w)(t=>(null!==t&&(this.isLoading=!0,this._userService.getUsers(this.currentMerchant.id,0,10,"name","asc",t)),(0,O.of)())),(0,Je.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.waitForPaginatorLoad().then(()=>{this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,Qe.T)(this._sort.sortChange,this._paginator.page).pipe((0,V.w)(()=>this._userService.getUsers(this.currentMerchant.id,this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))).subscribe())})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}updateUserStatus(t,r,o){this.isLoading=!0,this.selectedSlide=o,this._userService.updateUserStatus({id:r.id,active:t.checked}).pipe((0,m.R)(this._unsubscribeAll)).subscribe(d=>{d&&(this._snackBar.openFromComponent(C.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isLoading=!1,this.selectedSlide=-1,this._changeDetectorRef.markForCheck())})}deleteUser(t){this._fuseConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar el usuario ${t.name} ${t.lastname1} ${t.lastname2}?`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(o=>{"confirmed"===o&&this._userService.removeUser(t.id,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).pipe((0,m.R)(this._unsubscribeAll)).subscribe(({data:d})=>{d&&this._snackBar.openFromComponent(C.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:`Usuario ${t.name} ${t.lastname1} ${t.lastname2} eliminado correctamente`,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}trackByFn(t,r){return r.id||t}openDialog(t,r,o){this._userDialog.open(Ke,{data:{user:t,dialogMode:r},width:o,panelClass:"ath-dialog-panel"})}waitForPaginatorLoad(){var t=this;return(0,Te.Z)(function*(){for(;!t._paginator||void 0===t._paginator;)yield new Promise(r=>{setTimeout(r,200)});return t._paginator})()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(F.R),e.Y36(E.uw),e.Y36(w.K),e.Y36(J.ux),e.Y36(A.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ath-users"]],viewQuery:function(t,r){if(1&t&&(e.Gf(B.NW,5),e.Gf(q.YE,5)),2&t){let o;e.iGM(o=e.CRH())&&(r._paginator=o.first),e.iGM(o=e.CRH())&&(r._sort=o.first)}},decls:28,vars:11,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","overflow-x-auto","overflow-y-auto","bg-card","dark:bg-transparent","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight"],["class","flex flex-wrap items-center mt-2 sm:mt-0 shrink-0 sm:ml-4",4,"ngxPermissionsOnly"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],[4,"ngIf"],[4,"ngxPermissionsOnly"],["noUsers",""],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:ml-4"],[1,"mt-4","mr-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5","users-table"],[3,"mat-sort-header"],[1,"text-center","truncate"],[1,"flex","items-center","justify-center",3,"mat-sort-header"],[1,"pr-10","mr-6","text-right"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","md:px-8","users-table"],[1,"flex","truncate"],[1,"truncate"],[1,"flex","justify-center","mr-4","text-center"],[1,"flex","flex-row","justify-end","gap-2"],["mat-stroked-button","","matTooltip","Editar","routerLinkActive","router-link-active",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Cambiar contrase\xf1a",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Asignar Roles",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],["mat-stroked-button","","matTooltip","Eliminar",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[3,"checked","color","change"],[3,"diameter","color"],["class","z-10 border-b sm:inset-x-0 sm:bottom-0 sm:border-t sm:border-b-0 bg-gray-50 dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons",4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],["class","p-8 text-4xl font-semibold tracking-tight text-center sm:p-16",4,"ngxPermissionsOnly"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","sm:p-16"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Usuarios"),e.qZA()()(),e.TgZ(12,"div",8)(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA()()()(),e.TgZ(17,"div",11)(18,"div",12),e._uU(19," Listado de usuarios "),e.qZA()()(),e.YNc(20,je,4,4,"div",13),e.qZA(),e.TgZ(21,"div",14)(22,"div",15),e.YNc(23,ot,2,2,"ng-container",16),e.ALo(24,"async"),e.YNc(25,lt,2,1,"ng-container",17),e.YNc(26,mt,1,2,"ng-template",null,18,e.W1O),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("routerLink","/desktop"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(6),e.Q6J("ngxPermissionsOnly",e.DdM(9,Y)),e.xp6(3),e.Q6J("ngIf",e.lcZ(24,7,r.users$)),e.xp6(2),e.Q6J("ngxPermissionsOnly",e.DdM(10,Y)))},dependencies:[_.rH,_.yS,_.Od,h.mk,h.sg,h.O5,a.Fj,a.JJ,a.oH,L.PQ,Q.lW,D.Hw,x.KE,x.qo,N.Nt,B.NW,Ge.Ou,S.Rr,q.YE,q.nU,$.gM,He.gE,h.Ov],encapsulation:2,data:{animation:Z.L},changeDetection:0}),n})(),dt=(()=>{class n{constructor(t,r){this._userService=t,this.store=r,this.store.select(g.Qs).subscribe(o=>{this.currentMerchant=o})}resolve(t,r){return this.currentMerchant?this._userService.getUsers(this.currentMerchant.id):null}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(w.K),e.LFG(A.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pt=(()=>{class n{constructor(t){this._userService=t}resolve(t,r){const o=t.params.userId;if("new"!==o)return this._userService.getUserById(o)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(w.K))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var gt=s(62127),ft=s(84271);const _t=[{path:"",component:ut,resolve:{users:dt,roles:gt.xQ}},{path:":userId",component:Ie,resolve:{employee:ft.HB,user:pt}}];let ht=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[_.Bz.forChild(_t),T.m]}),n})()}}]);