"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[494],{50123:(re,S,l)=>{l.d(S,{u:()=>D});var f=l(48966),J=l(81042),W=l(59784),u=l(5e3),e=l(57261),R=l(22313),A=l(47423),c=l(83877);let D=(()=>{class C{constructor(b,g,p,T){this.data=b,this._dialogRef=g,this._snackBar=p,this.sanitizer=T,this.imageChangedEvent="",this.croppedImage="",this.imageChangedEvent=b.image}ngOnInit(){}imageCropped(b){this.croppedImage=this.sanitizer.bypassSecurityTrustUrl(b.objectUrl),this.blob=b.blob}imageLoaded(b){}cropperReady(){}loadImageFailed(){this._snackBar.openFromComponent(W.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"No se pudo cargar la imagen, int\xe9ntelo nuevamente.",type:"warning",svgIcon:"mat_solid:warning"}}),this._dialogRef.close()}saveImage(){const b=new File([this.blob],`${(0,J.Z)()}.${this.blob.type.split("/")[1]}`,{type:this.blob.type});this._dialogRef.close(b)}}return C.\u0275fac=function(b){return new(b||C)(u.Y36(f.WI),u.Y36(f.so),u.Y36(e.ux),u.Y36(R.H7))},C.\u0275cmp=u.Xpm({type:C,selectors:[["cropper-image-dialog"]],decls:16,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left","border-b"],["mat-dialog-title",""],[1,"flex","flex-row","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-1/2"],[3,"imageChangedEvent","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"flex-","flex-col","w-1/2"],[1,"text-xl","font-semibold","w-full","text-center","mb-2"],[3,"src"],[1,"flex","items-center","justify-between","w-full","px-8","py-4","bg-gray-50"],["mat-button","","mat-dialog-close","",1,"-ml-4","rounded-full",3,"color"],["mat-flat-button","",1,"rounded-full",3,"color","click"]],template:function(b,g){1&b&&(u.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),u._uU(3,"Ajustar Imagen"),u.qZA()(),u.TgZ(4,"div",3)(5,"div",4)(6,"image-cropper",5),u.NdJ("imageCropped",function(T){return g.imageCropped(T)})("imageLoaded",function(T){return g.imageLoaded(T)})("cropperReady",function(){return g.cropperReady()})("loadImageFailed",function(){return g.loadImageFailed()}),u.qZA()(),u.TgZ(7,"div",6)(8,"div",7),u._uU(9," Resultado "),u.qZA(),u._UZ(10,"img",8),u.qZA()(),u.TgZ(11,"div",9)(12,"button",10),u._uU(13,"Cancelar"),u.qZA(),u.TgZ(14,"button",11),u.NdJ("click",function(){return g.saveImage()}),u._uU(15,"Guardar"),u.qZA()()()),2&b&&(u.xp6(6),u.Q6J("imageChangedEvent",g.imageChangedEvent)("maintainAspectRatio",!0),u.xp6(4),u.Q6J("src",g.croppedImage,u.LSH),u.xp6(2),u.Q6J("color","warn"),u.xp6(2),u.Q6J("color","primary"))},dependencies:[A.lW,f.ZT,f.uh,c.ap],encapsulation:2}),C})()},4024:(re,S,l)=>{l.d(S,{J:()=>W});var f=l(5e3),J=l(40462);let W=(()=>{class u{constructor(R){this._brandsService=R}resolve(R,A){return this._brandsService.getBrands()}}return u.\u0275fac=function(R){return new(R||u)(f.LFG(J.G))},u.\u0275prov=f.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},23425:(re,S,l)=>{l.d(S,{gg:()=>u});var f=l(85094);const J=e=>e.brands,u=((0,f.P1)(J,e=>e.brand),(0,f.P1)(J,e=>e.brands))},40462:(re,S,l)=>{l.d(S,{G:()=>p});var f=l(40520),J=l(18505),W=l(94813),u=l(95698),e=l(63900),R=l(54004),A=l(75714),c=l(92340),D=l(67505),C=l(23425),U=l(5e3),b=l(85094);const g=c.N.API_URL;let p=(()=>{class T{constructor(x,h){this._httpClient=x,this.store=h}getBrands(x=1,h=10,O="name",L="asc",w=""){const y=(new f.LE).append("offset",h*(x-1)).append("limit",h).append("sort",O).append("order",L).append("search",w);return this._httpClient.get(`${g}/brands/`,{params:y}).pipe((0,J.b)(({pagination:de,brands:Fe})=>{this.store.dispatch((0,A.Jr)({pagination:de})),this.store.dispatch((0,D.dk)({brands:Fe}))}))}getBrandById(x){return this._httpClient.get(`${g}/brands/${x}`).pipe((0,W.j)("brand"),(0,J.b)(h=>{this.store.dispatch((0,D.HB)({brand:h}))}))}createBrand(x){return this.store.select(C.gg).pipe((0,u.q)(1),(0,e.w)(h=>this._httpClient.post(`${g}/brands/`,x).pipe((0,J.b)(O=>{this.store.dispatch((0,D.dk)({brands:[O.brand,...h]}))}))))}updateBrand(x){return this.store.select(C.gg).pipe((0,u.q)(1),(0,e.w)(h=>this._httpClient.patch(`${g}/brands/${x.id}`,x).pipe((0,R.U)(O=>{const L=[...h];return L[h.findIndex(y=>y.id===x.id)]=O.brand,this.store.dispatch((0,D.dk)({brands:L})),O}))))}deleteBrand(x){return this.store.select(C.gg).pipe((0,u.q)(1),(0,e.w)(h=>this._httpClient.delete(`${g}/brands/${x}`).pipe((0,R.U)(O=>{const L=h.findIndex(y=>y.id===x),w=[...h];return w.splice(L,1),this.store.dispatch((0,D.dk)({brands:w})),O}))))}}return T.\u0275fac=function(x){return new(x||T)(U.LFG(f.eN),U.LFG(b.yh))},T.\u0275prov=U.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})()},16494:(re,S,l)=>{l.r(S),l.d(S,{WarehouseModule:()=>Oi});var f=l(35357),J=l(83877),W=l(8314),u=l(17460),e=l(5e3),R=l(35265);let A=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-warehouse"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"ath-content-menu")},dependencies:[R.p],encapsulation:2}),o})();var c=l(93075),D=l(86087),C=l(84847),U=l(39646),b=l(77579),g=l(56451),p=l(82722),T=l(78372),v=l(63900),x=l(54004),h=l(15439),O=l.t(h,2),L=l(58493),w=l(54641),y=l(85094);const de=o=>o.depots,ae=((0,y.P1)(de,o=>o.depot),(0,y.P1)(de,o=>o.depots));var X=l(86428),pe=l(54787),Z=l(59784),M=l(48966),z=l(45840),$=l(95698),P=l(18505),me=l(75714),ee=l(74906),Q=l(33921);const Ge=Q.Ps`
   query FindAllDepots($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllDepots(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            depots {
                id
                active
                name
                code
                codev
            }
        }
    }
`,He=Q.Ps`
    query FindDepotById($findDepotById: String!) {
        findDepotById(id: $findDepotById) {
            ok
            message

            depot {
                id
                active
                name
                code
                codev
            }
        }
    }
`,Ve=Q.Ps`
    mutation CreateDepot($createDepotInput: CreateDepotInput!) {
        createDepot(createDepotInput: $createDepotInput) {
            ok
            message

            depot {
                id
                active
                name
                code
                codev
            }
        }
    }
`,Xe=Q.Ps`
    mutation UpdateDepot($updateDepotInput: UpdateDepotInput!) {
        updatedDepot(updateDepotInput: $updateDepotInput) {
            ok
            message

            depot {
                id
                active
                name
                code
                codev
            }
        }
    }
`,et=Q.Ps`
    mutation RemoveDepot($removeDepotId: String!) {
        removeDepot(id: $removeDepotId) {
            ok
            message
        }
    }
`,tt=Q.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateDepotStatus(updateEntityStatusInput: $updateEntityStatusInput) {
            ok
            message
        }
    }
`;var N=l(57261);let Ce=(()=>{class o{constructor(t,n,i){this.apolloProvider=t,this._snackBar=n,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}createDepot(t){return this.store.select(ae).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:Ve,variables:{createDepotInput:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i,data:a})=>{if(i){let d="";i.forEach(m=>d+=`\n ${m.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:d,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const s=(0,z.Z)(n);s.push(a.createDepot.depot),this.store.dispatch((0,ee.Us)({depots:s}))}))))}getDepots(t=1,n=10,i="code",a="asc",s=""){return this._apollo.query({query:Ge,errorPolicy:"all",variables:{offset:n*(t-1),limit:n,sort:i,order:a,search:s}}).pipe((0,P.b)(({errors:d,data:m})=>{if(d){let I="";d.forEach(q=>I+=`\n ${q.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:I,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,ee.Us)({depots:m.findAllDepots.depots})),this.store.dispatch((0,me.Jr)({pagination:m.findAllDepots.pagination}))}))}getDepotById(t){return this._apollo.query({query:He,variables:{findDepotByIdId:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:n,data:i})=>{if(n){let a="";n.forEach(s=>a+=`\n ${s.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:a,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,ee.IH)({depot:i.createDepot.depot}))}))}updateDepot(t){return this.store.select(ae).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:Xe,variables:{updateDepotInput:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i,data:a})=>{if(i){let m="";i.forEach(I=>m+=`\n ${I.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:m,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const s=(0,z.Z)(n);s[n.findIndex(m=>m.id===t.id)]=a.updateDepot.depot,this.store.dispatch((0,ee.Us)({depots:s}))}))))}updateDepotStatus(t){return this.store.select(ae).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:tt,variables:{updateEntityStatusInput:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i})=>{if(i){let d="";i.forEach(m=>d+=`\n ${m.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:d,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const a=(0,z.Z)(n);a[n.findIndex(d=>d.id===t.id)].active=t.active,this.store.dispatch((0,ee.Us)({depots:a}))}))))}removeDepot(t){return this.store.select(ae).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:et,variables:{removeDepotId:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i})=>{if(i){let d="";i.forEach(m=>d+=`\n ${m.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:d,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const a=(0,z.Z)(n),s=n.findIndex(d=>d.id===t);a.splice(s,1),this.store.dispatch((0,ee.Us)({depots:a}))}))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Q._M),e.LFG(N.ux),e.LFG(y.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var j=l(71683),_=l(69808),E=l(47423),k=l(67322),K=l(98833);function ot(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Almac\xe9n "),e.qZA())}function nt(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Almac\xe9n "),e.qZA())}function it(o,r){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.depot.name||"Sin nombre")}}function rt(o,r){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"mat-form-field",18)(4,"mat-label"),e._uU(5,"Nombre"),e.qZA(),e._UZ(6,"input",19),e.qZA(),e.TgZ(7,"mat-form-field",18)(8,"mat-label"),e._uU(9,"C\xf3digo en Versat"),e.qZA(),e._UZ(10,"input",20),e.TgZ(11,"mat-hint"),e._uU(12,"C\xf3digo del almac\xe9n en Sistema Contable Versat"),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.depotForm)("autocomplete","off"),e.xp6(4),e.Q6J("formControlName","name")("placeholder","Nombre del Almac\xe9n"),e.xp6(4),e.Q6J("formControlName","codev")("placeholder","Ejemplo: 0001")}}function at(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updateDepot())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.depotForm.invalid)("matDialogClose","confirmed")}}function st(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.createDepot())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.depotForm.invalid)("matDialogClose","confirmed")}}function ct(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",21),e.ynx(2),e.TgZ(3,"button",22),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,at,3,3,"ng-container",6),e.YNc(6,st,3,3,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let lt=(()=>{class o{constructor(t,n,i,a,s,d){this.data=t,this._depotsService=n,this._changeDetectorRef=i,this._formBuilder=a,this._fuseConfirmationService=s,this._dialogRef=d,this.dialogMode="view",this.imageChangedEvent="",this.croppedImage="",this._unsubscribeAll=new b.x,this.dialogMode=t.dialogMode,this.depot=t.depot}ngOnInit(){this.depotForm=this._formBuilder.group({id:[null],name:[null,[c.kI.required,c.kI.minLength(3),c.kI.maxLength(255)]],codev:[null]}),"edit"===this.dialogMode&&this.depotForm.patchValue(this.depot)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createDepot(){const t=this.depotForm.getRawValue();delete t.id,this._fuseConfirmationService.open({title:"Crear almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._depotsService.createDepot(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:a.createDepot.message,icon:{show:!0,name:"mat_solid:done",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}updateDepot(){const t=this.depotForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar almac\xe9n",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._depotsService.updateDepot(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:a.updateDepot.message,icon:{show:!0,name:"mat_solid:done",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(M.WI),e.Y36(Ce),e.Y36(e.sBO),e.Y36(c.qu),e.Y36(j.R),e.Y36(M.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-depot-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","py-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","my-1","gat-5",3,"formGroup","autocomplete"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["matInput","","type","text","maxlength","250",3,"formControlName","placeholder"],[1,"flex","items-center","px-6","py-4","space-x-3","justify-between","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,ot,2,0,"h2",2),e.YNc(4,nt,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,it,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,rt,13,6,"div",5),e.BQk(),e.qZA(),e.YNc(10,ct,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},dependencies:[_.O5,c._Y,c.Fj,c.JJ,c.JL,c.Q7,c.nD,c.sg,c.u,E.lW,M.ZT,k.KE,k.bx,k.hX,K.Nt],encapsulation:2}),o})();class dt{}var ue=l(22594),B=l(25245),Ue=l(20773),Ze=l(32368);function pt(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-slide-toggle",32),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,d=a.index,m=e.oxw(4);return e.KtG(m.updateDepotStatus(i,s,d))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("checked",t.active)("color","primary")}}function mt(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-spinner",33),e.BQk()),2&o&&(e.xp6(1),e.Q6J("diameter",20)("color","primary"))}function ut(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",27)(2,"div",28),e._uU(3),e.qZA(),e.TgZ(4,"div",28),e._uU(5),e.qZA(),e.TgZ(6,"div",29),e._uU(7),e.qZA(),e.TgZ(8,"div",28),e.YNc(9,pt,2,2,"ng-container",19),e.YNc(10,mt,2,2,"ng-container",19),e.qZA(),e.TgZ(11,"div")(12,"button",30),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(4);return e.KtG(s.updateDepot(a))}),e._UZ(13,"mat-icon",31),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit,n=r.index,i=e.oxw(4);e.xp6(3),e.hij(" ",t.code," "),e.xp6(2),e.hij(" ",t.codev," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",!(i.isSlideLoading&&i.selectedSlide===n)),e.xp6(1),e.Q6J("ngIf",i.isSlideLoading&&i.selectedSlide===n),e.xp6(3),e.Q6J("svgIcon","mat_solid:edit")}}function gt(o,r){if(1&o&&(e.ynx(0),e.YNc(1,ut,14,6,"ng-container",26),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const _t=function(o){return{"pointer-events-none":o}},ht=function(){return[5,10,25,100]};function ft(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22)(2,"div",23)(3,"div",24),e._uU(4,"C\xf3digo"),e.qZA(),e.TgZ(5,"div",24),e._uU(6,"C\xf3digo en Versat"),e.qZA(),e.TgZ(7,"div",24),e._uU(8,"Nombre"),e.qZA(),e.TgZ(9,"div"),e._uU(10,"Activo"),e.qZA(),e.TgZ(11,"div"),e._uU(12,"Detalles"),e.qZA()(),e.YNc(13,gt,2,2,"ng-container",19),e.ALo(14,"async"),e.qZA(),e._UZ(15,"mat-paginator",25),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","code"),e.xp6(2),e.Q6J("mat-sort-header","codev"),e.xp6(2),e.Q6J("mat-sort-header","name"),e.xp6(6),e.Q6J("ngIf",e.lcZ(14,10,t.depots$)),e.xp6(2),e.Q6J("ngClass",e.VKq(12,_t,t.isLoading))("length",t.pagination.length)("page",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(14,ht))("showFirstLastButtons",!0)}}function xt(o,r){if(1&o&&(e.ynx(0),e.YNc(1,ft,16,15,"ng-container",21),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function vt(o,r){1&o&&(e.TgZ(0,"div",34),e._uU(1,"\xa1No se ha creado ninguna almac\xe9n!"),e.qZA())}w.vfs=L.I.vfs;let bt=(()=>{class o{constructor(t,n,i,a,s){this._depotsService=t,this._changeDetectorRef=n,this._dialog=i,this._snackBar=a,this.store=s,this.depots=[],this.depots$=(0,U.of)([]),this.isLoading=!1,this.isSlideLoading=!1,this.merchant=null,this.merchantInputControl=new c.NI,this.searchInputControl=new c.NI,this.selectedSlide=null,this.user=null,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(pe.rk).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(ue.Qs).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.depots$=this.store.select(ae),this.depots$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.depots=t,this._changeDetectorRef.markForCheck()}),this.store.select(X.B).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,p.R)(this._unsubscribeAll),(0,T.b)(300),(0,v.w)(t=>(this.isLoading=!0,this._depotsService.getDepots(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,t))),(0,x.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"code",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,g.T)(this._sort.sortChange,this._paginator.page).pipe((0,v.w)(()=>(this.isLoading=!0,this._depotsService.getDepots(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,x.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createDepot(){this._openDialog(new dt,"add")}updateDepot(t){this._openDialog(t,"edit")}trackByFn(t,n){return t||n.id}updateDepotStatus(t,n,i){this.isSlideLoading=!0,this.selectedSlide=i,this._depotsService.updateDepotStatus({id:n.id,active:t.checked}).subscribe(({data:a})=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.updateDepotStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isSlideLoading=!1,this.selectedSlide=null,this._changeDetectorRef.markForCheck()})}generatePDF(t="open"){const n={header:{text:"LISTADO DE MARCAS",style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[30,"*",80],body:[[{text:"N\xba",style:"table_header"},{text:"Nombre de Marca",style:"table_header",alignment:"left"},{text:"Estado",style:"table_header"}],...this.depots.map(i=>[{text:this.depots.indexOf(i)+1,alignment:"center",style:"table_body"},{text:i.name,style:"table_body"},{text:!0===i.active?"ACTIVA":"INACTIVA",alignment:"center",style:"table_body"}])]},layout:"lightHorizontalLines",margin:[0,30,0,20]}],footer:(i,a)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.name} ${this.user.lastname1} ${this.user.lastname2} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${i.toString()}/${a} - Fecha de impresi\xf3n ${h().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"portrait",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:"Listado de marcas",author:`${this.user.name} ${this.user.lastname1} ${this.user.lastname2}`,creationDate:h().toDate(),modDate:h().toDate(),producer:this.merchant.name}};switch(t){case t="download":w.createPdf(n).download();break;case t="open":w.createPdf(n).open();break;case t="print":w.createPdf(n).print()}}_openDialog(t,n){this._dialog.open(lt,{data:{depot:t,dialogMode:n},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(Ce),e.Y36(e.sBO),e.Y36(M.uw),e.Y36(N.ux),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-depots"]],viewQuery:function(t,n){if(1&t&&(e.Gf(D.NW,5),e.Gf(C.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:32,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noDepots",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","depots-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[3,"mat-sort-header"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","depots-grid","md:px-8"],[1,""],[1,"truncate"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[3,"checked","color","change"],[3,"diameter","color"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Almacenes"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Listado de Almacenes "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return n.createDepot()}),e._UZ(23,"mat-icon",15),e.TgZ(24,"span",16),e._uU(25,"Agregar"),e.qZA()()()(),e.TgZ(26,"div",17)(27,"div",18),e.YNc(28,xt,2,2,"ng-container",19),e.ALo(29,"async"),e.YNc(30,vt,2,0,"ng-template",null,20,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(2),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.Q6J("ngIf",e.lcZ(29,8,n.depots$)))},dependencies:[f.yS,_.mk,_.sg,_.O5,c.Fj,c.JJ,c.oH,E.lW,B.Hw,k.KE,k.qo,K.Nt,D.NW,Ue.Ou,Ze.Rr,C.YE,C.nU,_.Ov],encapsulation:2,changeDetection:0}),o})();var Y=l(90508);const H=h||O,Me=new e.OlP("MAT_MOMENT_DATE_ADAPTER_OPTIONS",{providedIn:"root",factory:function yt(){return{useUtc:!1}}});function Ct(o,r){const t=Array(o);for(let n=0;n<o;n++)t[n]=r(n);return t}let Zt=(()=>{class o extends Y._A{constructor(t,n){super(),this._options=n,this.setLocale(t||H.locale())}setLocale(t){super.setLocale(t);let n=H.localeData(t);this._localeData={firstDayOfWeek:n.firstDayOfWeek(),longMonths:n.months(),shortMonths:n.monthsShort(),dates:Ct(31,i=>this.createDate(2017,0,i+1).format("D")),longDaysOfWeek:n.weekdays(),shortDaysOfWeek:n.weekdaysShort(),narrowDaysOfWeek:n.weekdaysMin()}}getYear(t){return this.clone(t).year()}getMonth(t){return this.clone(t).month()}getDate(t){return this.clone(t).date()}getDayOfWeek(t){return this.clone(t).day()}getMonthNames(t){return"long"==t?this._localeData.longMonths:this._localeData.shortMonths}getDateNames(){return this._localeData.dates}getDayOfWeekNames(t){return"long"==t?this._localeData.longDaysOfWeek:"short"==t?this._localeData.shortDaysOfWeek:this._localeData.narrowDaysOfWeek}getYearName(t){return this.clone(t).format("YYYY")}getFirstDayOfWeek(){return this._localeData.firstDayOfWeek}getNumDaysInMonth(t){return this.clone(t).daysInMonth()}clone(t){return t.clone().locale(this.locale)}createDate(t,n,i){const a=this._createMoment({year:t,month:n,date:i}).locale(this.locale);return a.isValid(),a}today(){return this._createMoment().locale(this.locale)}parse(t,n){return t&&"string"==typeof t?this._createMoment(t,n,this.locale):t?this._createMoment(t).locale(this.locale):null}format(t,n){return t=this.clone(t),this.isValid(t),t.format(n)}addCalendarYears(t,n){return this.clone(t).add({years:n})}addCalendarMonths(t,n){return this.clone(t).add({months:n})}addCalendarDays(t,n){return this.clone(t).add({days:n})}toIso8601(t){return this.clone(t).format()}deserialize(t){let n;if(t instanceof Date)n=this._createMoment(t).locale(this.locale);else if(this.isDateInstance(t))return this.clone(t);if("string"==typeof t){if(!t)return null;n=this._createMoment(t,H.ISO_8601).locale(this.locale)}return n&&this.isValid(n)?this._createMoment(n).locale(this.locale):super.deserialize(t)}isDateInstance(t){return H.isMoment(t)}isValid(t){return this.clone(t).isValid()}invalid(){return H.invalid()}_createMoment(t,n,i){const{strict:a,useUtc:s}=this._options||{};return s?H.utc(t,n,i,a):H(t,n,i,a)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Y.Ad,8),e.LFG(Me,8))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();const It=(0,y.P1)(o=>o.kardex,o=>o.kardex);var Qe=l(68675),V=l(17489),te=l(17264);const qe=o=>o.movements,ge=((0,y.P1)(qe,o=>o.movement),(0,y.P1)(qe,o=>o.movements));var se=l(76696),_e=l(38253),he=l(44066);let Te=(()=>{class o{constructor(t,n,i){this.apolloProvider=t,this._snackBar=n,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}createMovement(t){return this.store.select(ge).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:_e.RV,variables:{createMovementInput:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i,data:a})=>{if(i){let d="";i.forEach(m=>d+=`\n ${m.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:d,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const s=(0,z.Z)(n);s.push(a.createdMovement),this.store.dispatch((0,se.jn)({movements:s}))}))))}getMovements(t=1,n=5,i="no",a="desc",s=""){return this._apollo.query({query:he.pu,errorPolicy:"all",variables:{offset:n*(t-1),limit:n,sort:i,order:a,search:s}}).pipe((0,P.b)(({errors:d,data:m})=>{if(d){let I="";d.forEach(q=>I+=`\n ${q.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:I,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,se.jn)({movements:m.findAllMovements.movements})),this.store.dispatch((0,me.Jr)({pagination:m.findAllMovements.pagination}))}))}getMovementById(t){return this._apollo.query({query:he.tD,variables:{findMovementByIdId:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:n,data:i})=>{if(n){let a="";n.forEach(s=>a+=`\n ${s.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:a,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,se.sw)({movement:i.movement}))}))}updateMovement(t){return this.store.select(ge).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:_e.Av,variables:{updateMovementInput:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i,data:a})=>{if(i){let m="";i.forEach(I=>m+=`\n ${I.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:m,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const s=(0,z.Z)(n);s[n.findIndex(m=>m.id===t.id)]=a.updatedMovement,this.store.dispatch((0,se.jn)({movements:s}))}))))}removeMovement(t){return this.store.select(ge).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:_e.o2,variables:{removeMovementId:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i})=>{if(i){let d="";i.forEach(m=>d+=`\n ${m.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:d,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const a=(0,z.Z)(n),s=n.findIndex(d=>d.id===t);a.splice(s,1),this.store.dispatch((0,se.jn)({movements:a}))}))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Q._M),e.LFG(N.ux),e.LFG(y.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var fe=l(91079),Je=l(74107);function At(o,r){1&o&&(e.TgZ(0,"h2",6),e._uU(1,"Agregar movimiento"),e.qZA())}function kt(o,r){1&o&&(e.TgZ(0,"h2",6),e._uU(1,"Editar movimiento"),e.qZA())}function wt(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",22),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.addProductIdToMovement(a.id))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(1),e.hij(" ",t.name," ")}}function Dt(o,r){if(1&o&&(e.TgZ(0,"div",7)(1,"div",8)(2,"form",9)(3,"div",10)(4,"form",11)(5,"mat-form-field",12),e._UZ(6,"mat-icon",13)(7,"input",14),e.TgZ(8,"mat-autocomplete",15,16),e.YNc(10,wt,2,2,"mat-option",17),e.ALo(11,"async"),e.qZA()()(),e.TgZ(12,"div",18)(13,"mat-form-field",12)(14,"mat-label"),e._uU(15,"Motivo"),e.qZA(),e.TgZ(16,"mat-select",19)(17,"mat-option",20),e._uU(18," Inventario inicial "),e.qZA(),e.TgZ(19,"mat-option",20),e._uU(20," Por ajuste de inventario "),e.qZA(),e.TgZ(21,"mat-option",20),e._uU(22," Por aver\xeda del producto "),e.qZA(),e.TgZ(23,"mat-option",20),e._uU(24," Por promoci\xf3n del proveedor "),e.qZA(),e.TgZ(25,"mat-option",20),e._uU(26," Por compra de mercanc\xedas "),e.qZA(),e.TgZ(27,"mat-option",20),e._uU(28," Por venta de mercanc\xedas "),e.qZA()()(),e.TgZ(29,"mat-form-field",12)(30,"mat-label"),e._uU(31,"Cantidad"),e.qZA(),e._UZ(32,"input",21),e.qZA()()()()()()),2&o){const t=e.MAs(9),n=e.oxw();e.xp6(2),e.Q6J("formGroup",n.movementForm)("autocomplete","off"),e.xp6(4),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchProductControl)("matAutocomplete",t)("placeholder","Buscar productos"),e.xp6(1),e.Q6J("displayWith",n.displayFn),e.xp6(2),e.Q6J("ngForOf",e.lcZ(11,18,n.productsFiltered)),e.xp6(6),e.Q6J("formControlName","reason")("required",!0),e.xp6(1),e.Q6J("value","inicial"),e.xp6(2),e.Q6J("value","ajuste"),e.xp6(2),e.Q6J("value","averia"),e.xp6(2),e.Q6J("value","promocion"),e.xp6(2),e.Q6J("value","compra"),e.xp6(2),e.Q6J("value","venta"),e.xp6(5),e.Q6J("formControlName","quantity")("required",!0)}}function Pt(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updateMovement())}),e._uU(1,"Actualizar"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.movementForm.invalid)("color","primary")}}function Ft(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.createMovement())}),e._uU(1,"Agregar"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",t.movementForm.invalid)("color","primary")}}function Ut(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",23)(2,"button",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.closeDialog())}),e._uU(3,"Cancelar"),e.qZA(),e.YNc(4,Pt,2,2,"button",25),e.YNc(5,Ft,2,2,"button",25),e.qZA(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Re=(()=>{class o{constructor(t,n,i,a,s,d,m){this.data=t,this._changeDetectorRef=n,this._dialogRef=i,this._formBuilder=a,this._fuseConfirmationService=s,this._movementsService=d,this.store=m,this.searchProductControl=new c.NI(""),this.products=[],this._unsubscribeAll=new b.x,this.dialogMode=t.dialogMode,this.movement=this.data.movement}ngOnInit(){this.movementForm=this._formBuilder.group({id:new c.NI,productId:new c.NI(null),reason:new c.NI(null),quantity:new c.NI(null,[c.kI.min(0),c.kI.maxLength(9)]),type:new c.NI(null)}),null!==this.movement.id&&this.movementForm.patchValue(this.movement),this.store.select(te.nR).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.products=t,this._changeDetectorRef.markForCheck()}),this.productsFiltered=this.searchProductControl.valueChanges.pipe((0,Qe.O)(""),(0,x.U)(t=>{const n="string"==typeof t?t:null==t?void 0:t.name;return n?this._filterProducts(n):this.products.slice()}))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}addProductIdToMovement(t){this.movementForm.get("productId").setValue(t)}createMovement(){let t=this.movementForm.getRawValue();t=(0,V.omit)(t,["id"]),t.type=this.data.type,this._fuseConfirmationService.open({title:"Registrar movimiento",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,p.R)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._movementsService.createMovement(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:"Movimiento registrado correctamente",icon:{show:!0,name:"mat_solid:done",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck(),this.closeDialog()})})}updateMovement(){const t=this.movementForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar movimiento",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,p.R)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._movementsService.updateMovement(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:"Movimiento actualizado correctamente",icon:{show:!0,name:"mat_solid:done",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this.closeDialog(),this._changeDetectorRef.markForCheck()})})}_filterProducts(t){const n=t.toLowerCase();return this.products.filter(i=>i.name.toLowerCase().includes(n))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(M.WI),e.Y36(e.sBO),e.Y36(M.so),e.Y36(c.qu),e.Y36(j.R),e.Y36(Te),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["movement-dialog"]],decls:9,vars:4,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["mat-dialog-title","",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],["mat-dialog-title",""],[1,"w-full","overflow-hidden"],[1,"flex","border-t"],[1,"flex","flex-col","w-full","pt-8",3,"formGroup","autocomplete"],[1,"flex","flex-col","flex-auto","gap-4"],[1,"w-full"],["appearance","fill",1,"w-full","fuse-mat-dense"],["matPrefix","",3,"svgIcon"],["type","text","matInput","",3,"formControl","matAutocomplete","placeholder"],[3,"displayWith"],["productsAutocomplete","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],[1,"flex","flex-row","gap-5"],[3,"formControlName","required"],[3,"value"],["matInput","","type","number","min","0","maxlength","9",3,"formControlName","required"],[3,"value","click"],[1,"flex","items-center","justify-between","w-full","px-8","py-4"],["mat-button","",1,"-ml-4",3,"color","click"],["mat-flat-button","",3,"disabled","color","click",4,"ngIf"],["mat-flat-button","",3,"disabled","color","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,At,2,0,"h2",2),e.YNc(4,kt,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,Dt,33,20,"div",4),e.BQk(),e.qZA(),e.YNc(8,Ut,6,3,"ng-container",5),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",!n.data.movement.id&&"add"===n.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.movement.id&&"edit"===n.dialogMode),e.xp6(3),e.Q6J("ngIf","view"!==n.dialogMode),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},dependencies:[_.sg,_.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.Q7,c.nD,c.qQ,c.F,c.oH,c.sg,c.u,fe.XC,fe.ZL,Y.ey,E.lW,M.uh,B.Hw,k.KE,k.hX,k.qo,K.Nt,Je.gD,_.Ov],encapsulation:2}),o})();class Ee{}var Mt=l(76791);let Se=(()=>{class o{constructor(t,n,i){this.apolloProvider=t,this._snackBar=n,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}getKardex(t=new Date,n=1,i=5,a="product",s="asc",d=""){return this._apollo.query({query:he.k0,errorPolicy:"all",variables:{date:t,offset:i*(n-1),limit:i,sort:a,order:s,search:d}}).pipe((0,P.b)(({errors:m,data:I})=>{if(m){let q="";m.forEach(F=>q+=`\n ${F.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:q,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,Mt.hC)({kardex:I.getKardex.kardex})),this.store.dispatch((0,me.Jr)({pagination:I.getKardex.pagination}))}))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Q._M),e.LFG(N.ux),e.LFG(y.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Ie=l(86856),oe=l(92181);function Qt(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",36)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",37),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.qZA(),e.TgZ(8,"div",33),e._uU(9),e.ALo(10,"number"),e.qZA(),e.TgZ(11,"div",33),e._uU(12),e.ALo(13,"number"),e.qZA(),e.TgZ(14,"div",33),e._uU(15),e.ALo(16,"number"),e.qZA(),e.TgZ(17,"div",38),e._uU(18),e.ALo(19,"number"),e.qZA()(),e.BQk()),2&o){const t=r.$implicit,n=r.index;e.xp6(3),e.Oqu(n+1),e.xp6(2),e.hij(" ",t.product," "),e.xp6(2),e.hij(" ",t.brand," "),e.xp6(2),e.hij(" ",e.xi3(10,7,t.initQuantity*t.cost,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(13,10,t.incoming*t.cost,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(16,13,t.outcoming*t.cost,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(19,16,t.endQuantity*t.cost,"1.2-2")," ")}}const qt=function(o){return{"pointer-events-none":o}},Jt=function(){return[5,10,25,100]};function Rt(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",30)(2,"div",31),e._UZ(3,"div"),e.TgZ(4,"div",32),e._uU(5," Producto "),e.qZA(),e.TgZ(6,"div",32),e._uU(7," Marca "),e.qZA(),e.TgZ(8,"div",33),e._uU(9," Saldo Inicial "),e.qZA(),e.TgZ(10,"div",33),e._uU(11," Entradas "),e.qZA(),e.TgZ(12,"div",33),e._uU(13," Salidas "),e.qZA(),e.TgZ(14,"div",33),e._uU(15," Saldo Final "),e.qZA()(),e.YNc(16,Qt,20,19,"ng-container",34),e.qZA(),e._UZ(17,"mat-paginator",35),e.BQk()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("mat-sort-header","product"),e.xp6(2),e.Q6J("mat-sort-header","brand"),e.xp6(10),e.Q6J("ngForOf",t.kardex)("ngForTrackBy",t.trackByFn),e.xp6(1),e.Q6J("ngClass",e.VKq(10,qt,t.isLoading))("length",t.pagination.length)("page",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(12,Jt))("showFirstLastButtons",!0)}}function Et(o,r){1&o&&(e.TgZ(0,"div",39),e._uU(1," \xa1No se ha registrado ning\xfan movimiento! "),e.qZA())}h.locale("es"),w.vfs=L.I.vfs;const St={parse:{dateInput:"MM/YYYY"},display:{dateInput:"MM/YYYY",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};let Nt=(()=>{class o{constructor(t,n,i,a,s){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=i,this._kardexService=a,this.store=s,this.dateControl=new c.NI(h()),this.isLoading=!1,this.movement=new Ee,this.kardex=[],this.searchInputControl=new c.NI,this.user=null,this.merchant=null,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(X.B).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.store.select(pe.rk).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(ue.Qs).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(It).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.kardex=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,p.R)(this._unsubscribeAll),(0,T.b)(300),(0,v.w)(t=>(this.isLoading=!0,this._kardexService.getKardex(this.dateControl.value.toDate(),this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,t))),(0,x.U)(()=>{this.isLoading=!1})).subscribe(),this.dateControl.valueChanges.pipe((0,p.R)(this._unsubscribeAll),(0,T.b)(300),(0,v.w)(t=>(this.isLoading=!0,this._kardexService.getKardex(t.toDate()))),(0,x.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"product",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,g.T)(this._sort.sortChange,this._paginator.page).pipe((0,v.w)(()=>(this.isLoading=!0,this._kardexService.getKardex(this.dateControl.value.toDate(),this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,x.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openDialog(t,n,i){this._dialog.open(Re,{data:{movement:t,dialogMode:n,type:i},panelClass:"ath-dialog-panel"})}setMonthAndYear(t,n){const i=this.dateControl.value;i.month(t.month()),i.year(t.year()),this.dateControl.setValue(i),n.close()}generatePDF(t="open"){const n=this.dateControl.getRawValue(),i={header:{text:`RESUMEN Y SALDOS DE MOVIMIENTOS DE PRODUCTOS DEL MES ${h(n).format("MMMM")} DE ${h(n).format("YYYY")}`,style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:2,widths:["*","*",80,80,80,80],body:[[{text:"",border:[!1,!1,!1,!1]},{text:"",border:[!1,!1,!1,!1]},{text:"Movimientos",style:"table_header",colSpan:4},{},{},{}],[{text:"Producto",style:"table_header"},{text:"Marca",style:"table_header"},{text:"Saldo Inicial",style:"table_header"},{text:"Entradas",style:"table_header"},{text:"Salidas",style:"table_header"},{text:"Saldo Final",style:"table_header"}],...this.kardex.map(a=>[{text:a.product},{text:a.brand},{text:(a.initQuantity*a.cost).toFixed(2),alignment:"center"},{text:(a.incoming*a.cost).toFixed(2),alignment:"center"},{text:(a.outcoming*a.cost).toFixed(2),alignment:"center"},{text:(a.endQuantity*a.cost).toFixed(2),alignment:"center"}])]},layout:{hLineWidth:(a,s)=>.7,vLineWidth:(a,s)=>.7},margin:[0,30,0,20]}],footer:(a,s)=>({table:{widths:["*","*"],body:[[{text:`Resumen y saldos de movimientos de productos del mes ${h(n).format("MMMM")} de ${h(n).format("YYYY")}`,bold:!0,fontSize:8},{text:`P\xe1gina ${a.toString()}/${s} - Fecha de impresi\xf3n ${h().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:13,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]}},pageOrientation:"landscape",pageSize:"LETTER",info:{title:`Reporte Kardex ${h(n).format("MMMM")} de ${h(n).format("YYYY")}`,author:`${this.user.name} ${this.user.lastname1} ${this.user.lastname2}`,creationDate:h().toDate(),modDate:h().toDate(),producer:this.merchant.name}};switch(t){case t="download":w.createPdf(i).download();break;case t="open":w.createPdf(i).open();break;case t="print":w.createPdf(i).print()}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(M.uw),e.Y36(j.R),e.Y36(Se),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["kardex"]],viewQuery:function(t,n){if(1&t&&(e.Gf(D.NW,5),e.Gf(C.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},features:[e._Bn([{provide:Y._A,useClass:Zt,deps:[Y.Ad,Me]},{provide:Y.sG,useValue:St}])],decls:49,vars:17,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"fuse-mat-dense","fuse-mat-rounded"],["matInput","",3,"matDatepicker","formControl","placeholder"],["matIconSuffix","",3,"for"],["startView","year",3,"monthSelected"],["dp",""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"matMenuTriggerFor"],["itemMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf","ngIfElse"],["noKardex",""],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","kardex-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"hidden","sm:block",3,"mat-sort-header"],[1,"hidden","text-center","sm:block"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","kardex-grid","md:px-8"],[1,"hidden","truncate","sm:block"],[1,"hidden","text-center","uppercase","sm:block"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Kardex"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Kardex "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"mat-form-field",14),e._UZ(23,"input",15)(24,"mat-datepicker-toggle",16),e.TgZ(25,"mat-datepicker",17,18),e.NdJ("monthSelected",function(s){e.CHM(i);const d=e.MAs(26);return e.KtG(n.setMonthAndYear(s,d))}),e.qZA()(),e.TgZ(27,"button",19),e.NdJ("click",function(){return n.generatePDF()}),e._UZ(28,"mat-icon",20),e.TgZ(29,"span",21),e._uU(30,"Imprimir Reporte"),e.qZA()(),e.TgZ(31,"div",22)(32,"button",23),e._UZ(33,"mat-icon",20),e.TgZ(34,"span",21),e._uU(35,"Registrar Movimiento"),e.qZA()(),e.TgZ(36,"mat-menu",null,24)(38,"button",25),e.NdJ("click",function(){return n.openDialog(n.movement,"add","entrada")}),e._UZ(39,"mat-icon",20),e._uU(40," Registrar entrada "),e.qZA(),e.TgZ(41,"button",25),e.NdJ("click",function(){return n.openDialog(n.movement,"add","salida")}),e._UZ(42,"mat-icon",20),e._uU(43," Registrar salida "),e.qZA()()()()(),e.TgZ(44,"div",26)(45,"div",27),e.YNc(46,Rt,18,13,"ng-container",28),e.YNc(47,Et,2,0,"ng-template",null,29,e.W1O),e.qZA()()()}if(2&t){const i=e.MAs(26),a=e.MAs(37),s=e.MAs(48);e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar"),e.xp6(2),e.Q6J("matDatepicker",i)("formControl",n.dateControl)("placeholder","Mes"),e.xp6(1),e.Q6J("for",i),e.xp6(4),e.Q6J("svgIcon","mat_solid:print"),e.xp6(4),e.Q6J("matMenuTriggerFor",a),e.xp6(1),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(6),e.Q6J("svgIcon","mat_solid:login"),e.xp6(3),e.Q6J("svgIcon","mat_solid:logout"),e.xp6(4),e.Q6J("ngIf",n.kardex.length>0)("ngIfElse",s)}},dependencies:[f.yS,_.mk,_.sg,_.O5,c.Fj,c.JJ,c.oH,E.lW,Ie.Mq,Ie.hl,Ie.nW,B.Hw,k.KE,k.qo,K.Nt,oe.VK,oe.OP,oe.p6,D.NW,C.YE,C.nU,_.JJ],encapsulation:2,changeDetection:0}),o})();function Wt(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",30)(2,"div",31),e._uU(3),e.qZA(),e.TgZ(4,"div",31),e._uU(5),e.qZA(),e.TgZ(6,"div",27),e._uU(7),e.qZA(),e.TgZ(8,"div",31),e._uU(9),e.qZA(),e.TgZ(10,"div",27),e._uU(11),e.qZA(),e.TgZ(12,"div",27),e._uU(13),e.qZA(),e.TgZ(14,"div",32),e._uU(15),e.qZA(),e.TgZ(16,"div",33)(17,"button",34),e._UZ(18,"mat-icon",35),e.qZA(),e.TgZ(19,"button",34),e._UZ(20,"mat-icon",35),e.qZA(),e.TgZ(21,"button",34),e._UZ(22,"mat-icon",35),e.qZA()()(),e.BQk()),2&o){const t=r.$implicit;e.xp6(3),e.hij(" ",t.product.name," "),e.xp6(2),e.hij(" ",t.product.brand.name," "),e.xp6(2),e.hij(" ",t.reason," "),e.xp6(2),e.hij(" ",t.type," "),e.xp6(2),e.hij(" ",t.initQuantity," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",t.endQuantity," "),e.xp6(3),e.Q6J("svgIcon","mat_solid:visibility"),e.xp6(2),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(2),e.Q6J("svgIcon","mat_solid:delete")}}function Lt(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Wt,23,10,"ng-container",29),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Bt=function(o){return{"pointer-events-none":o}},Yt=function(){return[5,10,25,100]};function Ot(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",25)(2,"div",26)(3,"div",27),e._uU(4," Producto "),e.qZA(),e.TgZ(5,"div",27),e._uU(6," Marca "),e.qZA(),e.TgZ(7,"div",27),e._uU(8," Motivo "),e.qZA(),e.TgZ(9,"div",27),e._uU(10," Tipo "),e.qZA(),e.TgZ(11,"div",27),e._uU(12," Cantidad Inicial "),e.qZA(),e.TgZ(13,"div",27),e._uU(14," Cantidad "),e.qZA(),e.TgZ(15,"div",27),e._uU(16," Cantidad Final "),e.qZA(),e.TgZ(17,"div",27),e._uU(18," Acciones "),e.qZA()(),e.YNc(19,Lt,2,2,"ng-container",22),e.ALo(20,"async"),e.qZA(),e._UZ(21,"mat-paginator",28),e.BQk()),2&o){const t=e.oxw(2);e.xp6(19),e.Q6J("ngIf",e.lcZ(20,7,t.movements$)),e.xp6(2),e.Q6J("ngClass",e.VKq(9,Bt,t.isLoading))("length",t.pagination.length)("page",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(11,Yt))("showFirstLastButtons",!0)}}function zt(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Ot,22,12,"ng-container",24),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(40);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function $t(o,r){1&o&&(e.TgZ(0,"div",36),e._uU(1," \xa1No se ha registrado ning\xfan movimiento! "),e.qZA())}let jt=(()=>{class o{constructor(t,n,i,a){this._changeDetectorRef=t,this._dialog=n,this._movementsService=i,this.store=a,this.isLoading=!1,this.movement=new Ee,this.movements$=(0,U.of)([]),this.searchInputControl=new c.NI,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(X.B).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.movements$=this.store.select(ge),this.searchInputControl.valueChanges.pipe((0,p.R)(this._unsubscribeAll),(0,T.b)(300),(0,v.w)(t=>(this.isLoading=!0,this._movementsService.getMovements(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,t))),(0,x.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,g.T)(this._sort.sortChange,this._paginator.page).pipe((0,v.w)(()=>(this.isLoading=!0,this._movementsService.getMovements(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,x.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openDialog(t,n,i){this._dialog.open(Re,{data:{movement:t,dialogMode:n,type:i},panelClass:"ath-dialog-panel"})}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(M.uw),e.Y36(Te),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["movements"]],viewQuery:function(t,n){if(1&t&&(e.Gf(D.NW,5),e.Gf(C.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:41,vars:13,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,""],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-700",3,"matMenuTriggerFor"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],["movementMenu","matMenu"],["mat-menu-item","","matRipple","",3,"click"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noMovements",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","movement-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"hidden","text-center","sm:block"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","movement-grid","md:px-8"],[1,"hidden","text-center","truncate","sm:block"],[1,"hidden","text-center","uppercase","sm:block"],[1,"flex","flex-row","flex-wrap","justify-center","gap-3"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7"],[1,"icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Movimientos de inventario"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Movimientos de inventario "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"div",14)(23,"button",15),e._UZ(24,"mat-icon",16),e.TgZ(25,"span",17),e._uU(26,"Agregar"),e.qZA()(),e.TgZ(27,"mat-menu",null,18)(29,"button",19),e.NdJ("click",function(){return n.openDialog(n.movement,"add","entrada")}),e._UZ(30,"mat-icon",16),e._uU(31," Registrar entrada "),e.qZA(),e.TgZ(32,"button",19),e.NdJ("click",function(){return n.openDialog(n.movement,"add","salida")}),e._UZ(33,"mat-icon",16),e._uU(34," Registrar salida "),e.qZA()()()()(),e.TgZ(35,"div",20)(36,"div",21),e.YNc(37,zt,2,2,"ng-container",22),e.ALo(38,"async"),e.YNc(39,$t,2,0,"ng-template",null,23,e.W1O),e.qZA()()()),2&t){const i=e.MAs(28);e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(2),e.Q6J("matMenuTriggerFor",i),e.xp6(1),e.Q6J("svgIcon","mat_solid:expand_more"),e.xp6(6),e.Q6J("svgIcon","mat_solid:login"),e.xp6(3),e.Q6J("svgIcon","mat_solid:logout"),e.xp6(4),e.Q6J("ngIf",e.lcZ(38,11,n.movements$))}},dependencies:[f.yS,_.mk,_.sg,_.O5,c.Fj,c.JJ,c.oH,E.lW,B.Hw,k.KE,k.qo,K.Nt,oe.VK,oe.OP,oe.p6,D.NW,Y.wG,C.YE,_.Ov],encapsulation:2,changeDetection:0}),o})(),Kt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-receptions"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[f.lC],encapsulation:2}),o})();class Ne{constructor(r,t,n,i,a,s,d,m,I,q,F,G,le,Pe){this.concept=r,this.warehouse=t,this.nov=n,this.noCtrl=i,this.date=a,this.obs=s,this.entity=d,this.invoice=m,this.currency=I,this.tax=q,this.discount=F,this.services=G,this.rate=le,this.products=Pe}}const We=o=>o.receptions,xe=((0,y.P1)(We,o=>o.reception),(0,y.P1)(We,o=>o.receptions));var ce=l(62875);const Gt=Q.Ps`
   query FindAllReceptions($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllReceptions(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            receptions {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,Ht=Q.Ps`
    query FindReceptionById($findReceptionById: String!) {
        findReceptionById(id: $findReceptionById) {
            ok
            message

            reception {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,Vt=Q.Ps`
    mutation CreateReceptionFromVersatFile($createReceptionFromVersatFileInput: CreateReceptionFromVersatFileInput!) {
        createReceptionFromVersatFile(createReceptionFromVersatFileInput: $createReceptionFromVersatFileInput) {
            ok
            message

            reception {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,Xt=Q.Ps`
    mutation UpdateReception($updateReceptionInput: UpdateReceptionInput!) {
        updatedReception(updateReceptionInput: $updateReceptionInput) {
            ok
            message

            reception {
                id
                concept
                warehouse
                no
                nov
                noCtrl
                date
                obs
                entity
                invoice
                currency
                tax
                discount
                services
                rate
                products {
                    upc
                    name
                    price
                    quantity
                    uom
                }
            }
        }
    }
`,eo=Q.Ps`
    mutation RemoveReception($removeReceptionId: String!) {
        removeReception(id: $removeReceptionId) {
            ok
            message
        }
    }
`;let Ae=(()=>{class o{constructor(t,n,i){this.apolloProvider=t,this._snackBar=n,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}createReceptionFromVersatFile(t){return this.store.select(xe).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:Vt,variables:{createReceptionFromVersatFileInput:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i,data:a})=>{if(i){let d="";i.forEach(m=>d+=`\n ${m.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:d,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const s=(0,z.Z)(n);s.push(a.createReceptionFromVersatFile.reception),this.store.dispatch((0,ce.y$)({receptions:s}))}))))}getReceptions(t=1,n=10,i="no",a="desc",s=""){return this._apollo.query({query:Gt,errorPolicy:"all",variables:{offset:n*(t-1),limit:n,sort:i,order:a,search:s}}).pipe((0,P.b)(({errors:d,data:m})=>{if(d){let I="";d.forEach(q=>I+=`\n ${q.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:I,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,ce.y$)({receptions:m.findAllReceptions.receptions})),this.store.dispatch((0,me.Jr)({pagination:m.findAllReceptions.pagination}))}))}getReceptionById(t){return this._apollo.query({query:Ht,variables:{findReceptionByIdId:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:n,data:i})=>{if(n){let a="";n.forEach(s=>a+=`\n ${s.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:a,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,ce.su)({reception:i.createReceptionFromVersatFile.reception}))}))}updateReception(t){return this.store.select(xe).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:Xt,variables:{updateReceptionInput:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i,data:a})=>{if(i){let m="";i.forEach(I=>m+=`\n ${I.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:m,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const s=(0,z.Z)(n);s[n.findIndex(m=>m.id===t.id)]=a.updateReception.reception,this.store.dispatch((0,ce.y$)({receptions:s}))}))))}removeReception(t){return this.store.select(xe).pipe((0,$.q)(1),(0,v.w)(n=>this._apollo.mutate({mutation:eo,variables:{removeReceptionId:t},errorPolicy:"all"}).pipe((0,P.b)(({errors:i})=>{if(i){let d="";i.forEach(m=>d+=`\n ${m.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:d,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const a=(0,z.Z)(n),s=n.findIndex(d=>d.id===t);a.splice(s,1),this.store.dispatch((0,ce.y$)({receptions:a}))}))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Q._M),e.LFG(N.ux),e.LFG(y.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function to(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.saveReception())}),e._UZ(2,"mat-icon",15),e.TgZ(3,"span",16),e._uU(4,"Guardar Recepci\xf3n"),e.qZA()(),e.BQk()}2&o&&(e.xp6(2),e.Q6J("svgIcon","mat_solid:save"))}function oo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",17)(2,"div",18)(3,"label",19),e._UZ(4,"mat-icon",20),e._uU(5," Agregar recepci\xf3n "),e.qZA(),e.TgZ(6,"input",21),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.selectFile(i))}),e.qZA()()(),e.BQk()}2&o&&(e.xp6(4),e.Q6J("svgIcon","mat_solid:add"))}function no(o,r){1&o&&e.GkF(0)}function io(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",27)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",28),e._uU(5),e.qZA(),e.TgZ(6,"div",29),e._uU(7),e.qZA(),e.TgZ(8,"div",25),e._uU(9),e.qZA(),e._UZ(10,"div",25),e.TgZ(11,"div",29),e.YNc(12,no,1,0,"ng-container",11),e.qZA()(),e.BQk()),2&o){const t=r.$implicit,n=r.index;e.xp6(3),e.hij(" ",n+1," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.uom," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(3),e.Q6J("ngIf",t.expiration)}}function ro(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22)(2,"div",23),e._UZ(3,"div"),e.TgZ(4,"div",24),e._uU(5," Producto "),e.qZA(),e.TgZ(6,"div",25),e._uU(7," Unidad "),e.qZA(),e.TgZ(8,"div",25),e._uU(9," Cantidad "),e.qZA(),e.TgZ(10,"div",25),e._uU(11," \xbfVence? "),e.qZA(),e.TgZ(12,"div",25),e._uU(13," Fecha de Vencimiento "),e.qZA()(),e.YNc(14,io,13,5,"ng-container",26),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(14),e.Q6J("ngForOf",t.reception.movements)("ngForTrackBy",t.trackByFn)}}let ao=(()=>{class o{constructor(t,n,i,a,s,d){this._changeDetectorRef=t,this._fuseConfirmationService=n,this._snackBar=i,this._receptionsService=a,this._router=s,this.store=d,this.fileContent="",this.reception=null,this.showProducts=!1,this.minDate=new Date,this._unsubscribeAll=new b.x}ngOnInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectFile(t){0!==t.target.files.length&&(this.file=t.target.files[0],this.readFile(this.file))}readFile(t){const n=new FileReader;n.onload=i=>{const a=n.result.toString(),s=a.split("[Ubicacion]")[0].split("[Documento]")[1].split(/[\r\n]+/),d=a.split("[Ubicacion]")[1].split("[Movimientos]")[0].split(/[\r\n]+/),m=[];for(const F of d)if(""!==F){const G={upc:F.split("|")[0],name:F.split("|")[1].trim(),uom:F.split("|")[2]};m.push(G)}const I=a.split("[Movimientos]")[1].split(/[\r\n]+/),q=[];for(const F of I)if(""!==F){const G={upc:F.split("|")[0],uom:F.split("|")[1],quantity:Number(F.split("|")[2]),price:Number(Number(F.split("|")[4]).toFixed(2)),name:m.filter(le=>le.upc===F.split("|")[0])[0].name,discount:Number(Number(F.split("|")[8])),tax:Number(Number(F.split("|")[9]))};q.push(G)}this.reception=new Ne(s[1].split("=")[1],s[2].split("=")[1],s[3].split("=")[1],s[4].split("=")[1],h(s[5].split("=")[1]).toDate(),s[7].split("=")[1],s[8].split("=")[1],s[9].split("=")[1],s[10].split("=")[1],Number(s[11].split("=")[1]),Number(s[12].split("=")[1]),Number(s[13].split("=")[1]),Number(s[14].split("=")[1]),q),this.showProducts=!0,this._changeDetectorRef.markForCheck()},n.readAsText(this.file)}saveReception(){this._fuseConfirmationService.open({title:"Guardar Entrada",message:"\xbfEst\xe1 seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{"confirmed"===n&&this._receptionsService.createReceptionFromVersatFile(this.reception).pipe((0,p.R)(this._unsubscribeAll)).subscribe(({data:i})=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:i.createReceptionFromVersatFile.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/receptions/list"),this._changeDetectorRef.markForCheck()})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(j.R),e.Y36(N.ux),e.Y36(Ae),e.Y36(f.F0),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-reception"]],decls:25,vars:5,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[4,"ngIf"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],["mat-raised-button","",1,"bg-gradient-to-r","from-primary-500","to-primary-600",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[1,"flex","flex-col","items-center","justify-center","w-full","min-h-full"],[1,"flex","flex-col","items-center","justify-center","p-5","rounded-md","cursor-pointer","hover:bg-hover","hover:shadow-md"],["for","reception-file-input",1,"flex","flex-col","items-center","justify-center","text-xl","font-bold","cursor-pointer"],[1,"icon-size-20",3,"svgIcon"],["id","reception-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"change"],[1,"grid","w-full"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","reception-movement-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"hidden","sm:block"],[1,"hidden","text-center","sm:block"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","reception-movement-grid","md:px-8"],[1,"hidden","truncate","sm:block"],[1,"hidden","text-center","truncate","sm:block"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Almac\xe9n"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",7),e._uU(15,"Recepci\xf3n"),e.qZA()()()(),e.TgZ(16,"div",8)(17,"h2",9),e._uU(18," Recepci\xf3n "),e.qZA()()(),e.TgZ(19,"div",10),e.YNc(20,to,5,1,"ng-container",11),e.qZA()(),e.TgZ(21,"div",12)(22,"div",13),e.YNc(23,oo,7,1,"ng-container",11),e.YNc(24,ro,15,2,"ng-container",11),e.qZA()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(7),e.Q6J("ngIf",n.showProducts),e.xp6(3),e.Q6J("ngIf",!n.showProducts),e.xp6(1),e.Q6J("ngIf",n.showProducts))},dependencies:[f.yS,_.sg,_.O5,E.lW,B.Hw,C.YE],encapsulation:2,changeDetection:0}),o})();var ke=l(87238);function so(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",24)(2,"div",25),e._uU(3),e.qZA(),e.TgZ(4,"div",25),e._uU(5),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"div",21),e._uU(8),e.qZA(),e.TgZ(9,"div",25),e._uU(10),e.qZA(),e.TgZ(11,"div",21),e._uU(12),e.qZA(),e.TgZ(13,"div",21),e._uU(14),e.ALo(15,"number"),e.qZA(),e.TgZ(16,"div",26),e._uU(17),e.ALo(18,"number"),e.qZA(),e.TgZ(19,"div",27)(20,"button",28),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(4);return e.KtG(s.generatePDF("open",a))}),e._UZ(21,"mat-icon",29),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",e.xi3(6,8,t.date,"dd/MM/yyyy")," "),e.xp6(3),e.hij(" ",t.invoice," "),e.xp6(2),e.hij(" ",t.warehouse," "),e.xp6(2),e.hij(" ",t.currency," "),e.xp6(2),e.hij(" ",e.xi3(15,11,0,"1.2-2")," "),e.xp6(3),e.hij(" ",e.xi3(18,14,t.services,"1.2-2")," "),e.xp6(4),e.Q6J("svgIcon","mat_solid:assignment")}}function co(o,r){if(1&o&&(e.ynx(0),e.YNc(1,so,22,17,"ng-container",23),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const lo=function(o){return{"pointer-events-none":o}},po=function(){return[5,10,25,100]};function mo(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",19)(2,"div",20)(3,"div",21),e._uU(4," No. "),e.qZA(),e.TgZ(5,"div",21),e._uU(6," Fecha "),e.qZA(),e.TgZ(7,"div",21),e._uU(8," Factura "),e.qZA(),e.TgZ(9,"div",21),e._uU(10," Almac\xe9n "),e.qZA(),e.TgZ(11,"div",21),e._uU(12," Moneda "),e.qZA(),e.TgZ(13,"div",21),e._uU(14," Importe "),e.qZA(),e.TgZ(15,"div",21),e._uU(16," Servicios "),e.qZA(),e.TgZ(17,"div",21),e._uU(18," Acciones "),e.qZA()(),e.YNc(19,co,2,2,"ng-container",16),e.ALo(20,"async"),e.qZA(),e._UZ(21,"mat-paginator",22),e.BQk()),2&o){const t=e.oxw(2);e.xp6(19),e.Q6J("ngIf",e.lcZ(20,7,t.receptions$)),e.xp6(2),e.Q6J("ngClass",e.VKq(9,lo,t.isLoading))("length",t.pagination.length)("page",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(11,po))("showFirstLastButtons",!0)}}function uo(o,r){if(1&o&&(e.ynx(0),e.YNc(1,mo,22,12,"ng-container",18),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(27);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function go(o,r){1&o&&(e.TgZ(0,"div",30),e._uU(1," \xa1No se ha registrado ninguna recepci\xf3n hasta el momento! "),e.qZA())}w.vfs=L.I.vfs;let _o=(()=>{class o{constructor(t,n,i,a,s){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=i,this._receptionsService=a,this.store=s,this.isLoading=!1,this.reception=new Ne,this.receptions$=(0,U.of)([]),this.searchInputControl=new c.NI,this.user=null,this.merchant=null,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(pe.rk).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(ue.Qs).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(X.B).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.receptions$=this.store.select(xe),this.searchInputControl.valueChanges.pipe((0,p.R)(this._unsubscribeAll),(0,T.b)(300),(0,v.w)(t=>(this.isLoading=!0,this._receptionsService.getReceptions(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,t))),(0,x.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,g.T)(this._sort.sortChange,this._paginator.page).pipe((0,v.w)(()=>(this.isLoading=!0,this._receptionsService.getReceptions(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,x.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(t="open",n){const i={header:[{text:"INFORME DE RECEPCI\xd3N DE MERCANC\xcdAS",fontSize:18,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"],margin:[40,10,40,0]},{text:"Almac\xe9n "+n.warehouse,fontSize:18,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"],margin:[40,10,40,0]}],content:[{table:{widths:["*","*"],body:[[{table:{body:[[{text:"No: "+n.no,fontSize:18,bold:!0,fontFeatures:["c2sc","smcp"]}],[{text:"Factura: "+n.invoice,fontSize:18,bold:!0,fontFeatures:["c2sc","smcp"]}],[{text:`Fecha: ${h(n.date).format("DD/MM/yyyy")}`,fontSize:12,fontFeatures:["c2sc","smcp"]}],[{text:`Moneda: ${n.currency}`,fontSize:12,fontFeatures:["c2sc","smcp"]}]]},layout:"noBorders"}]]},layout:"noBorders"},{table:{headerRows:1,widths:[30,60,"*",60,60,60,60],body:[[{text:"Item",style:"table_header"},{text:"UPC",style:"table_header",alignment:"left"},{text:"Producto",style:"table_header",alignment:"left"},{text:"Unidad",style:"table_header"},{text:"Cantidad",style:"table_header"},{text:"Precio",style:"table_header"},{text:"Total",style:"table_header"}],...n.products.map(a=>[{text:n.products.indexOf(a)+1,alignment:"center",style:"table_body"},{text:a.upc,style:"table_body"},{text:a.name,style:"table_body"},{text:a.uom,alignment:"center",style:"table_body"},{text:a.quantity,alignment:"center",style:"table_body"},{text:a.price.toFixed(2),alignment:"center",style:"table_body"},{text:(a.quantity*a.price).toFixed(2),alignment:"center",style:"table_body"}])]},layout:{hLineWidth:(a,s)=>.7,vLineWidth:(a,s)=>.7},marginTop:20},{text:"Observaciones",fontSize:14,bold:!0,marginTop:10,fontFeatures:["c2sc","smcp"]},{text:n.obs,fontSize:12,fontFeatures:["c2sc","smcp"]}],footer:(a,s)=>({table:{widths:["*","*"],body:[[{text:`Informe de Recepci\xf3n: ${n.no} generado por el usuario ${this.user.name} ${this.user.lastname1} ${this.user.lastname2} `,bold:!0,fontSize:8},{text:`P\xe1gina ${a.toString()}/${s} - Fecha de impresi\xf3n ${h().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[40,10,40,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"],fillColor:"#eeeeee"},table_body:{fontSize:10},totals_name:{bold:!0,fillColor:"#eeeeee",alignment:"right",fontFeatures:["c2sc","smcp"]},totals_value:{alignment:"center",fontFeatures:["c2sc","smcp"]}},pageOrientation:"portrait",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:`Factura: ${n.no}`,author:`${this.user.name} ${this.user.lastname1} ${this.user.lastname2}`,creationDate:h().toDate(),modDate:h().toDate(),producer:this.merchant.name}};switch(t){case t="download":w.createPdf(i).download();break;case t="open":w.createPdf(i).open();break;case t="print":w.createPdf(i).print()}}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(M.uw),e.Y36(j.R),e.Y36(Ae),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-reception-list"]],viewQuery:function(t,n){if(1&t&&(e.Gf(D.NW,5),e.Gf(C.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:28,vars:9,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/dashboard",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noReceptions",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","receptions-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"hidden","text-center","sm:block"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","receptions-grid","md:px-8"],[1,"hidden","text-center","truncate","sm:block"],[1,"hidden","text-center","uppercase","sm:block"],[1,"flex","flex-row","flex-wrap","justify-center","gap-3"],["mat-stroked-button","","matTooltip","Informe de Recepci\xf3n",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Recepciones"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Registro de Recepciones "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA()()(),e.TgZ(22,"div",14)(23,"div",15),e.YNc(24,uo,2,2,"ng-container",16),e.ALo(25,"async"),e.YNc(26,go,2,0,"ng-template",null,17,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Escriba para filtrar..."),e.xp6(3),e.Q6J("ngIf",e.lcZ(25,7,n.receptions$)))},dependencies:[f.yS,_.mk,_.sg,_.O5,c.Fj,c.JJ,c.oH,E.lW,B.Hw,k.KE,k.qo,K.Nt,D.NW,C.YE,ke.gM,_.Ov,_.JJ,_.uU],encapsulation:2,changeDetection:0}),o})();const fo=(0,y.P1)(o=>o.periods,o=>o.period);class xo{}var ne=(()=>{return(o=ne||(ne={})).open="open",o.close="close",ne;var o})(),Le=l(25143);let Be=(()=>{class o{constructor(t,n,i){this.apolloProvider=t,this._snackBar=n,this.store=i,this._apollo=this.apolloProvider.use("BALANC")}changePeriodStatus(t){return this._apollo.mutate({mutation:_e.eI,variables:{updatePeriodStatusInput:{state:t}},errorPolicy:"all"}).pipe((0,P.b)(({errors:n,data:i})=>{if(n){let a="";n.forEach(s=>a+=`\n ${s.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:a,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,Le._y)({period:i.period}))}))}getCurrentPeriod(){return this._apollo.query({query:he.nK,errorPolicy:"all"}).pipe((0,P.b)(({errors:t,data:n})=>{if(t){let i="";t.forEach(a=>i+=`\n ${a.message}.`),this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:i,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,Le._y)({period:n.period}))}))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Q._M),e.LFG(N.ux),e.LFG(y.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ve=l(29071);function vo(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",8),e._uU(2),e.ALo(3,"date"),e.ALo(4,"date"),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.AsE(" Inventario vigente desde ",e.xi3(3,2,t.period.open,"dd/MM/yyyy")," hasta ",e.xi3(4,5,t.period.close,"dd/MM/yyyy")," ")}}function bo(o,r){1&o&&(e.ynx(0),e.TgZ(1,"div",8),e._uU(2," Inventario cerrado "),e.qZA(),e.BQk())}function yo(o,r){1&o&&(e.ynx(0),e.TgZ(1,"div",9),e._uU(2," Este inventario se cerrar\xe1 al final del per\xedodo "),e.qZA(),e.BQk())}function Co(o,r){1&o&&(e.ynx(0),e.TgZ(1,"div",9),e._uU(2," Debe abrir un nuevo inventario para el mes que corresponde "),e.qZA(),e.BQk())}function Zo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changePeriodStatus("open"))}),e._UZ(2,"mat-icon",11),e._uU(3," Abrir Inventario "),e.qZA(),e.BQk()}2&o&&(e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","mat_solid:key"))}function To(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.changePeriodStatus("close"))}),e._UZ(2,"mat-icon",11),e._uU(3," Cerrar Inventario "),e.qZA(),e.BQk()}2&o&&(e.xp6(1),e.Q6J("color","warn"),e.xp6(1),e.Q6J("svgIcon","mat_solid:lock"))}let Io=(()=>{class o{constructor(t,n,i,a,s){this._changeDetectorRef=t,this._fuseConfirmationService=n,this._periodsService=i,this._snackBar=a,this.store=s,this.period=new xo,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(fo).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.period=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}changePeriodStatus(t){this._fuseConfirmationService.open({title:(t===ne.close?"Cerrar":"Abrir")+" inventario.",message:`\xbfEst\xe1 seguro que desea ${t===ne.close?"cerrar":"abrir"} en inventario?`,icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,p.R)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._periodsService.changePeriodStatus(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:`Inventario ${t===ne.close?"cerrado":"abierto"} correctamente.`,icon:{show:!0,name:"mat_solid:done",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(j.R),e.Y36(Be),e.Y36(N.ux),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["warehouse-periods"]],decls:14,vars:7,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-auto","items-center","p-6","sm:p-10"],[1,"mt-4","md:mt-24","text-3xl","md:text-6xl","font-extrabold","tracking-tight","leading-7","sm:leading-10"],[1,"w-full","mt-8","md:mt-16"],[1,"flex","flex-col","items-center","p-6","rounded-lg","shadow","bg-card","hover:shadow-xl","transition-shadow","duration-150","ease-in-out","w-full"],[1,"flex","items-center","justify-center","p-4","rounded-full","bg-primary-50","text-primary-700","dark:bg-primary","dark:text-on-primary"],[1,"text-current",3,"svgIcon"],[4,"ngIf"],[1,"mt-5","text-lg","font-medium","leading-5"],[1,"mt-0.5","line-clamp-2","text-secondary"],["mat-flat-button","",1,"mt-5",3,"color","click"],[3,"svgIcon"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3," Manejar estado del inventario "),e.qZA(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5),e._UZ(7,"mat-icon",6),e.qZA(),e.YNc(8,vo,5,8,"ng-container",7),e.YNc(9,bo,3,0,"ng-container",7),e.YNc(10,yo,3,0,"ng-container",7),e.YNc(11,Co,3,0,"ng-container",7),e.YNc(12,Zo,4,2,"ng-container",7),e.YNc(13,To,4,2,"ng-container",7),e.qZA()()()()),2&t&&(e.xp6(7),e.Q6J("svgIcon","mat_solid:date_range"),e.xp6(1),e.Q6J("ngIf","open"===n.period.state),e.xp6(1),e.Q6J("ngIf","close"===n.period.state),e.xp6(1),e.Q6J("ngIf","open"===n.period.state),e.xp6(1),e.Q6J("ngIf","close"===n.period.state),e.xp6(1),e.Q6J("ngIf","close"===n.period.state),e.xp6(1),e.Q6J("ngIf","open"===n.period.state))},dependencies:[_.O5,ve.PQ,E.lW,B.Hw,_.uU],encapsulation:2}),o})();var Ye=l(91159),Ao=l(99987),ko=l(16911);class Oe{constructor(){this.tags=[]}}var we=l(54206),wo=l(23425),Do=l(50123),ze=l(65018),$e=l(97231),be=l(66929),Po=l(77446),ye=l(26688),Fo=l(94534);const De=function(o){return{"cursor-not-allowed":o}};function Uo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",48),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.createProduct())}),e._UZ(2,"mat-icon",49),e.TgZ(3,"span",50),e._uU(4,"Guardar"),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.productForm.invalid||"standard"!==t.productForm.get("type").value&&0===t.variants.length)("ngClass",e.VKq(3,De,t.productForm.invalid||"standard"!==t.productForm.get("type").value&&0===t.variants.length)),e.xp6(1),e.Q6J("svgIcon","mat_solid:save")}}function Mo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",48),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.updateProduct())}),e._UZ(2,"mat-icon",49),e.TgZ(3,"span",50),e._uU(4,"Actualizar"),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.productForm.invalid)("ngClass",e.VKq(3,De,t.productForm.invalid)),e.xp6(1),e.Q6J("svgIcon","mat_solid:refresh")}}function Qo(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",55),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","mat_solid:check_circle"))}const qo=function(o,r,t){return{"ring ring-inset ring-primary":o,"cursor-not-allowed bg-slate-300 bg-opacity-50":r,"cursor-pointer":t}};function Jo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",51),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.selectType(a.value))}),e.YNc(2,Qo,2,1,"ng-container",10),e.TgZ(3,"div",52),e._uU(4),e.qZA(),e.TgZ(5,"div",53),e._uU(6),e.qZA(),e._UZ(7,"div",54),e.qZA(),e.BQk()}if(2&o){const t=r.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngClass",e.kEZ(5,qo,n.productForm.get("type").value===t.value,"group"===t.value,"group"!==t.value))("matTooltip",t.tooltip),e.xp6(1),e.Q6J("ngIf",n.productForm.get("type").value===t.value),e.xp6(2),e.Oqu(t.label),e.xp6(2),e.Oqu(t.details)}}function Ro(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto es obligatorio. "),e.qZA())}function Eo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto debe contener entre 3 y 255 caracteres. "),e.qZA())}function So(o,r){if(1&o&&(e.TgZ(0,"mat-option",59),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function No(o,r){if(1&o&&(e.TgZ(0,"mat-optgroup",58),e.YNc(1,So,2,2,"mat-option",28),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("label",t.name)("disabled",!t.active),e.xp6(1),e.Q6J("ngForOf",t.children)}}function Wo(o,r){if(1&o&&(e.TgZ(0,"mat-option",59),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function Lo(o,r){if(1&o&&(e.TgZ(0,"container"),e.YNc(1,No,2,3,"mat-optgroup",56),e.YNc(2,Wo,2,2,"mat-option",57),e.qZA()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.children.length>0),e.xp6(1),e.Q6J("ngIf",0===t.children.length)}}function Bo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-icon",60),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.resetCategoryField())}),e.qZA(),e.BQk()}}function Yo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar una categor\xeda. "),e.qZA())}function Oo(o,r){1&o&&(e.ynx(0),e.TgZ(1,"mat-form-field",19)(2,"mat-label"),e._uU(3,"SKU"),e.qZA(),e._UZ(4,"input",61),e.qZA(),e.BQk()),2&o&&(e.xp6(4),e.Q6J("formControlName","sku"))}function zo(o,r){1&o&&(e.ynx(0),e.TgZ(1,"mat-form-field",62)(2,"mat-label"),e._uU(3,"UPC"),e.qZA(),e._UZ(4,"input",61),e.qZA(),e.BQk()),2&o&&(e.xp6(4),e.Q6J("formControlName","upc"))}function $o(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",59),e._uU(2),e.qZA(),e.BQk()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function jo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar la marca. "),e.qZA())}function Ko(o,r){if(1&o&&(e.TgZ(0,"mat-option",59),e._uU(1),e.qZA()),2&o){const t=r.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.iso," ")}}function Go(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar una Moneda. "),e.qZA())}function Ho(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",59),e._uU(2),e.qZA(),e.BQk()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.abbr," ")}}function Vo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function Xo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio "),e.qZA())}function en(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio "),e.qZA())}function tn(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function on(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-form-field",63)(2,"mat-label"),e._uU(3,"Cantidad"),e.qZA(),e._UZ(4,"input",64),e.YNc(5,Xo,2,0,"mat-error",10),e.qZA(),e.TgZ(6,"mat-form-field",63)(7,"mat-label"),e._uU(8,"Cantidad M\xedn"),e.qZA(),e._UZ(9,"input",64),e.YNc(10,en,2,0,"mat-error",10),e.qZA(),e.TgZ(11,"mat-form-field",63)(12,"mat-label"),e._uU(13,"Costo"),e.qZA(),e._UZ(14,"mat-icon",65)(15,"input",66),e.qZA(),e.TgZ(16,"mat-form-field",63)(17,"mat-label"),e._uU(18,"Descuento"),e.qZA(),e._UZ(19,"mat-icon",65)(20,"input",66),e.qZA(),e.TgZ(21,"mat-form-field",63)(22,"mat-label"),e._uU(23,"Impuesto"),e.qZA(),e._UZ(24,"mat-icon",65)(25,"input",66),e.qZA(),e.TgZ(26,"mat-form-field",63)(27,"mat-label"),e._uU(28,"Precio"),e.qZA(),e._UZ(29,"mat-icon",65)(30,"input",67),e.YNc(31,tn,2,0,"mat-error",10),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControlName","stock"),e.xp6(1),e.Q6J("ngIf",t.productForm.get("stock").hasError("required")),e.xp6(4),e.Q6J("formControlName","stockMin"),e.xp6(1),e.Q6J("ngIf",t.productForm.get("stock").hasError("required")),e.xp6(5),e.Q6J("formControlName","cost"),e.xp6(5),e.Q6J("formControlName","discount"),e.xp6(5),e.Q6J("formControlName","tax"),e.xp6(5),e.Q6J("formControlName","price"),e.xp6(1),e.Q6J("ngIf",t.productForm.get("price").hasError("required"))}}function nn(o,r){1&o&&(e.ynx(0),e.TgZ(1,"mat-form-field",63)(2,"mat-label"),e._uU(3,"Largo"),e.qZA(),e._UZ(4,"mat-icon",68)(5,"mat-icon",65)(6,"input",66),e.qZA(),e.TgZ(7,"mat-form-field",63)(8,"mat-label"),e._uU(9,"Ancho"),e.qZA(),e._UZ(10,"mat-icon",68)(11,"input",66),e.qZA(),e.TgZ(12,"mat-form-field",63)(13,"mat-label"),e._uU(14,"Altura"),e.qZA(),e._UZ(15,"mat-icon",68)(16,"input",66),e.qZA(),e.TgZ(17,"mat-form-field",63)(18,"mat-label"),e._uU(19,"Peso"),e.qZA(),e._UZ(20,"mat-icon",69)(21,"input",66),e.qZA(),e.BQk()),2&o&&(e.xp6(6),e.Q6J("formControlName","length"),e.xp6(5),e.Q6J("formControlName","width"),e.xp6(5),e.Q6J("formControlName","height"),e.xp6(5),e.Q6J("formControlName","weight"))}const je=function(){return{height:"270px"}};function rn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",70)(2,"mat-label"),e._uU(3,"Especificaciones"),e.qZA(),e._UZ(4,"quill-editor",71),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControlName","specifications")("styles",e.DdM(3,je))("modules",t.quillModules)}}function an(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",70)(2,"mat-label"),e._uU(3,"Garant\xeda"),e.qZA(),e._UZ(4,"quill-editor",71),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("formControlName","guaranty")("styles",e.DdM(3,je))("modules",t.quillModules)}}function sn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"input",77,78),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.selectFiles(i,"thumbnail"))}),e.qZA(),e.TgZ(3,"label",79),e._UZ(4,"mat-icon",80),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.xp6(3),e.Q6J("svgIcon","mat_solid:photo_camera"))}function cn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",81),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.removeFile())}),e._UZ(2,"mat-icon",80),e.qZA()()}2&o&&(e.xp6(2),e.Q6J("svgIcon","mat_solid:delete"))}function ln(o,r){if(1&o&&e._UZ(0,"img",82),2&o){const t=e.oxw(2);e.Q6J("src",t.productForm.get("thumbnail").value,e.LSH)}}function dn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",15),e._uU(2," Imagen "),e.qZA(),e.TgZ(3,"div",72)(4,"div",73),e._UZ(5,"div",74),e.TgZ(6,"div",75),e.YNc(7,sn,5,3,"div",10),e.YNc(8,cn,3,1,"div",10),e.qZA(),e.YNc(9,ln,1,1,"img",76),e.qZA()(),e.BQk()),2&o){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",!t.productForm.get("thumbnail").value),e.xp6(1),e.Q6J("ngIf",t.productForm.get("thumbnail").value),e.xp6(1),e.Q6J("ngIf",t.productForm.get("thumbnail").value)}}function pn(o,r){1&o&&e._UZ(0,"mat-icon",41),2&o&&e.Q6J("svgIcon","mat_solid:edit")}function mn(o,r){1&o&&e._UZ(0,"mat-icon",41),2&o&&e.Q6J("svgIcon","mat_solid:done")}function un(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-checkbox",83),e.NdJ("change",function(i){const s=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.toggleProductTag(s,i))}),e._uU(2),e.qZA(),e.BQk()}if(2&o){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("checked",n.selectedProduct.tags.includes(t.id)),e.xp6(1),e.hij(" ",t.name," ")}}function gn(o,r){if(1&o&&(e.ynx(0),e.YNc(1,un,3,3,"ng-container",17),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filteredTags)("ngForTrackBy",t.trackByFn)}}function _n(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",63)(2,"input",85),e.NdJ("input",function(i){const s=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.updateTagName(s,i))}),e.qZA(),e.TgZ(3,"button",86),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.deleteTag(a))}),e._UZ(4,"mat-icon",41),e.qZA()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(2),e.Q6J("value",t.name),e.xp6(2),e.Q6J("svgIcon","mat_solid:delete")}}function hn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",84),e.YNc(2,_n,5,2,"ng-container",17),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.filteredTags)("ngForTrackBy",t.trackByFn)}}function fn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",87),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=e.MAs(101);return i.createTag(a.value),e.KtG(a.value="")}),e._UZ(1,"mat-icon",88),e.TgZ(2,"div",89),e._uU(3,'Crear "'),e.TgZ(4,"b"),e._uU(5),e.qZA(),e._uU(6,'"'),e.qZA()()}if(2&o){e.oxw();const t=e.MAs(101);e.xp6(1),e.Q6J("svgIcon","mat_solid:add_circle"),e.xp6(4),e.Oqu(t.value)}}function xn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",99),e.NdJ("removed",function(){const a=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.removeSize(a))}),e._uU(1),e.TgZ(2,"button",100),e._UZ(3,"mat-icon",41),e.qZA()()}if(2&o){const t=r.$implicit;e.xp6(1),e.hij(" ",t," "),e.xp6(1),e.Q6J("aria-label","Eliminar "+t),e.xp6(1),e.Q6J("svgIcon","mat_solid:cancel")}}function vn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",93)(2,"mat-form-field",94)(3,"mat-label"),e._uU(4,"Variantes de tallas"),e.qZA(),e.TgZ(5,"input",95),e.NdJ("matChipInputTokenEnd",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.addSize(i))}),e.qZA(),e.TgZ(6,"mat-chip-list",96,97),e.YNc(8,xn,4,3,"mat-chip",98),e.qZA()()(),e.BQk()}if(2&o){const t=e.MAs(7),n=e.oxw(2);e.xp6(5),e.Q6J("matChipInputFor",t)("matChipInputSeparatorKeyCodes",n.separatorKeysCodes)("matChipInputAddOnBlur",n.addOnBlur),e.xp6(1),e.Q6J("formControl",n.sizesCtrl),e.xp6(2),e.Q6J("ngForOf",n.sizes)}}function bn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"mat-chip",99),e.NdJ("removed",function(){const a=e.CHM(t).$implicit,s=e.oxw(3);return e.KtG(s.removeColor(a))}),e._UZ(1,"div",105),e.TgZ(2,"button",100),e._UZ(3,"mat-icon",41),e.qZA()()}if(2&o){const t=r.$implicit;e.xp6(1),e.Udp("background",t),e.xp6(1),e.Q6J("aria-label","Eliminar "+t),e.xp6(1),e.Q6J("svgIcon","mat_solid:cancel")}}function yn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",101)(2,"span"),e._uU(3,"Variantes de colores"),e.qZA(),e.TgZ(4,"div",102)(5,"color-circle",103),e.NdJ("onChange",function(i){e.CHM(t);const a=e.oxw(2);return e.KtG(a.addColor(i))}),e.qZA(),e.TgZ(6,"mat-chip-list",104),e.YNc(7,bn,4,4,"mat-chip",98),e.qZA()()(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(5),e.Q6J("colors",t.defaultColors),e.xp6(2),e.Q6J("ngForOf",t.colors)}}function Cn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",59),e._uU(2),e.qZA(),e.BQk()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function Zn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-form-field",63)(2,"mat-label",108),e._uU(3,"Talla"),e.qZA(),e.TgZ(4,"mat-select",115)(5,"mat-option",29),e._uU(6,"Seleccione una talla"),e.qZA(),e.YNc(7,Cn,3,2,"ng-container",25),e.qZA()(),e.BQk()),2&o){const t=e.oxw(3);e.xp6(4),e.Q6J("formControlName","size")("required",t.showSize),e.xp6(3),e.Q6J("ngForOf",t.sizes)}}function Tn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",59)(2,"div",116),e._UZ(3,"div",117),e._uU(4),e.qZA()(),e.BQk()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(2),e.Udp("background",t),e.xp6(1),e.hij(" ",t," ")}}function In(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-form-field",63)(2,"mat-label",108),e._uU(3,"Color"),e.qZA(),e.TgZ(4,"mat-select",115)(5,"mat-option",29),e._uU(6,"Seleccione un color"),e.qZA(),e.YNc(7,Tn,5,4,"ng-container",25),e.qZA()(),e.BQk()),2&o){const t=e.oxw(3);e.xp6(4),e.Q6J("formControlName","color")("required",t.showColor),e.xp6(3),e.Q6J("ngForOf",t.colors)}}function An(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",120),e._uU(2),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.size," ")}}function kn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",122),e._UZ(2,"div",117),e.qZA(),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.Udp("background",t.color)}}function wn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",118)(2,"div",119),e._uU(3),e.qZA(),e.TgZ(4,"div",120),e._uU(5),e.qZA(),e.YNc(6,An,3,1,"ng-container",10),e.YNc(7,kn,3,2,"ng-container",10),e.TgZ(8,"div",120),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"div",120),e._uU(12),e.qZA(),e.TgZ(13,"button",121),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(4);return e.KtG(s.removeVariant(a))}),e._UZ(14,"mat-icon",49),e.qZA()(),e.BQk()}if(2&o){const t=r.$implicit,n=e.oxw(4);e.xp6(3),e.hij(" ",n.productForm.get("name").value," "),e.xp6(2),e.hij(" ",t.sku," "),e.xp6(1),e.Q6J("ngIf",n.showSize),e.xp6(1),e.Q6J("ngIf",n.showColor),e.xp6(2),e.hij(" ",e.xi3(10,7,t.price,"$ ")," "),e.xp6(3),e.hij(" ",t.stock," "),e.xp6(2),e.Q6J("svgIcon","mat_solid:remove")}}function Dn(o,r){if(1&o&&(e.ynx(0),e.YNc(1,wn,15,10,"ng-container",25),e.BQk()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.variants)}}function Pn(o,r){1&o&&(e.TgZ(0,"div",123),e._uU(1," \xa1No se ha creado ninguna variante!"),e.qZA())}function Fn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",106)(2,"span",15),e._uU(3,"Listado de variantes del producto"),e.qZA(),e.TgZ(4,"form",107)(5,"div"),e._uU(6),e.qZA(),e.TgZ(7,"mat-form-field",63)(8,"mat-label",108),e._uU(9,"SKU"),e.qZA(),e._UZ(10,"input",109),e.qZA(),e.YNc(11,Zn,8,3,"ng-container",10),e.YNc(12,In,8,3,"ng-container",10),e.TgZ(13,"mat-form-field",63)(14,"mat-label",110),e._uU(15,"Precio"),e.qZA(),e._UZ(16,"input",111),e.qZA(),e.TgZ(17,"mat-form-field",63)(18,"mat-label",110),e._uU(19,"Cantidad"),e.qZA(),e._UZ(20,"input",111),e.qZA(),e.TgZ(21,"button",112),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.addVariant())}),e._UZ(22,"mat-icon",49),e.qZA()(),e.YNc(23,Dn,2,1,"ng-container",113),e.YNc(24,Pn,2,0,"ng-template",null,114,e.W1O),e.qZA(),e.BQk()}if(2&o){const t=e.MAs(25),n=e.oxw(2);e.xp6(4),e.Q6J("formGroup",n.variantForm),e.xp6(2),e.hij(" ",n.productForm.get("name").value," "),e.xp6(4),e.Q6J("formControlName","sku"),e.xp6(1),e.Q6J("ngIf",n.sizes.length>0),e.xp6(1),e.Q6J("ngIf",n.colors.length>0),e.xp6(4),e.Q6J("formControlName","price"),e.xp6(4),e.Q6J("formControlName","stock"),e.xp6(1),e.Q6J("disabled",n.variantForm.invalid)("ngClass",e.VKq(12,De,n.variantForm.invalid)),e.xp6(1),e.Q6J("svgIcon","mat_solid:add"),e.xp6(1),e.Q6J("ngIf",n.variants.length>0)("ngIfElse",t)}}function Un(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",90)(2,"div",36)(3,"span",15),e._uU(4,"Tipo de Variante"),e.qZA(),e.TgZ(5,"span"),e._uU(6,"Selecciona el tipo de variante"),e.qZA(),e.TgZ(7,"div",91)(8,"mat-checkbox",92),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.selectShowSize(i))}),e._uU(9," Talla "),e.qZA(),e.TgZ(10,"mat-checkbox",92),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.selectShowColor(i))}),e._uU(11," Color "),e.qZA()(),e.YNc(12,vn,9,5,"ng-container",10),e.YNc(13,yn,8,2,"ng-container",10),e.YNc(14,Fn,26,14,"ng-container",10),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(8),e.Q6J("formControl",t.haveSizeCtrl),e.xp6(2),e.Q6J("formControl",t.haveColorCtrl),e.xp6(2),e.Q6J("ngIf",t.showSize),e.xp6(1),e.Q6J("ngIf",t.showColor),e.xp6(1),e.Q6J("ngIf",(t.colors.length>0||t.sizes.length>0)&&(t.showSize||t.showColor))}}let Mn=(()=>{class o{constructor(t,n,i,a,s,d,m,I,q,F){this._activatedRoute=t,this._changeDetectorRef=n,this._dialog=i,this._formBuilder=a,this._fuseConfirmationService=s,this._imagesService=d,this._productsService=m,this._snackBar=I,this._router=q,this.store=F,this.addOnBlur=!0,this.categories=[],this.categoriesFiltered$=(0,U.of)([]),this.currencies=[],this.descriptionLength=0,this.editMode=!1,this.flashMessage=null,this.images=[],this.isLoading=!1,this.haveSizeCtrl=new c.NI(!1),this.haveColorCtrl=new c.NI(!1),this.haveSpecificationsCtrl=new c.NI(!1),this.haveGuarantyCtrl=new c.NI(!1),this.productId=null,this.products$=(0,U.of)([]),this.searchInputControl=new c.NI,this.separatorKeysCodes=[Ye.K5,Ye.OC],this.selectedProduct=new Oe,this.tagsEditMode=!1,this.thumbnail="",this.uoms=[],this.uoms$=(0,U.of)(null),this.quillModules={toolbar:[[{font:[]}],[{color:[]}],[{align:[]}],["bold","italic","underline"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}]]},this.showSize=!1,this.sizes=["S","M","L","XL"],this.sizesCtrl=new c.NI(["M"]),this.showColor=!1,this.colors=[],this.defaultColors=["#e9182d","#f78da7","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#607d8b"],this.variants=[],this._unsubscribeAll=new b.x,this._filter=(G,le)=>{const Pe=le.toLowerCase();return G?G.filter(zi=>zi.name.toLowerCase().trim().includes(Pe)):[]},this.types=[{value:"standard",label:"Est\xe1ndar",details:"Producto que no tiene variantes.",active:!0,tooltip:"Seleccionar"},{value:"generic",label:"Gen\xe9rico",details:"Producto que re\xfane variantes.",active:!0,tooltip:"Seleccionar"},{value:"group",label:"Combo",details:"Agrupaci\xf3n de productos.",active:!1,tooltip:"Pr\xf3ximamente"}]}ngOnInit(){this.categoriesFiltered$=this.store.select(we.u),this.store.select(we.u).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.categories=t,this._changeDetectorRef.markForCheck()}),this.productForm=this._formBuilder.group({id:[""],type:["standard",[c.kI.required]],categoryId:["",[c.kI.required]],name:["",[c.kI.required,c.kI.minLength(3),c.kI.maxLength(255)]],description:["",[c.kI.maxLength(1e4)]],brandId:["",[c.kI.required]],currencyId:["",[c.kI.required]],uomId:["",[c.kI.required]],thumbnail:[""],sku:[""],upc:[""],tags:[[]],cost:[0,[c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],discount:[0,[c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],tax:[0,[c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],price:[0,[c.kI.required,c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],stock:[0,[c.kI.required,c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],stockMin:[0,[c.kI.required,c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],length:[0,[c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],width:[0,[c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],height:[0,[c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],weight:[0,[c.kI.min(0),c.kI.max(999999999),c.kI.maxLength(9)]],specifications:[""],guaranty:[""],active:[!0],expiration:[!1],isService:[!1],isDigital:[!1]}),this.variantForm=this._formBuilder.group({sku:new c.NI(""),size:new c.NI,color:new c.NI,price:new c.NI,stock:new c.NI}),this._activatedRoute.params.pipe((0,p.R)(this._unsubscribeAll)).subscribe(({productId:t})=>{this.productId=t,"new"!==this.productId&&(this.editMode=!0,this.store.select(te.Fn).pipe((0,p.R)(this._unsubscribeAll)).subscribe(n=>{this.selectedProduct=n,this.variants=n.variants,n.variants.length>0&&(null!==n.variants[0].color&&(this.showColor=!0,this.haveColorCtrl.setValue(!0)),null!==n.variants[0].size&&(this.showSize=!0,this.haveSizeCtrl.setValue(!0))),""!==n.specifications&&this.haveSpecificationsCtrl.setValue(!0),""!==n.guaranty&&this.haveGuarantyCtrl.setValue(!0),this.productForm.patchValue(n),this.variants=n.variants.map(i=>{const a=Object.assign({},i);return delete a.__typename,a}),this.images=this.selectedProduct.images})),this._changeDetectorRef.markForCheck()}),this.store.select(Ao.zd).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.currencies=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(ko.av),this.uoms$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.uoms=t,this._changeDetectorRef.markForCheck()}),this.store.select(wo.gg).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.brands=t,this._changeDetectorRef.markForCheck()}),this.store.select(te.a0).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.tags=(0,V.cloneDeep)(t),this.filteredTags=(0,V.cloneDeep)(t),this._changeDetectorRef.markForCheck()}),this.categoriesFiltered$=this.productForm.get("categoryId").valueChanges.pipe((0,Qe.O)(""),(0,x.U)(t=>this._filterCategories(t||"")))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectType(t){"group"!==t&&this.productForm.get("type").setValue(t)}resetCategoryField(){this.productForm.get("categoryId").reset(),this.categoriesFiltered$=this.store.select(we.u)}selectShowSize(t){this.showSize=t.checked,this._changeDetectorRef.markForCheck()}addSize(t){const n=(t.value||"").trim();this.sizes.indexOf(n.toUpperCase())>=0?t.chipInput.clear():(n&&this.sizes.push(n),t.chipInput.clear(),this._changeDetectorRef.markForCheck())}removeSize(t){const n=this.sizes.indexOf(t);n>=0&&this.sizes.splice(n,1)}selectShowColor(t){this.showColor=t.checked,this._changeDetectorRef.markForCheck()}addColor({color:t}){this.colors.indexOf(t.hex)>=0||(t.hex&&this.colors.push(t.hex),this._changeDetectorRef.markForCheck())}removeColor(t){const n=this.colors.indexOf(t);n>=0&&this.colors.splice(n,1)}addVariant(){const t=this.variantForm.getRawValue();this.variants.indexOf(t)>=0||(t&&this.variants.push(t),this.variantForm.reset(),this._changeDetectorRef.markForCheck())}removeVariant(t){const n=this.variants.indexOf(t);n>=0&&this.variants.splice(n,1),this._changeDetectorRef.markForCheck()}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(t){const n=t.target.value.toLowerCase();this.filteredTags=this.tags.filter(i=>i.name.toLowerCase().includes(n))}filterTagsInputKeyDown(t){if("Enter"!==t.key)return;if(0===this.filteredTags.length)return this.createTag(t.target.value),void(t.target.value="");const n=this.filteredTags[0];this.selectedProduct.tags.find(a=>a===n.id)?this.removeTagFromProduct(n):this.addTagToProduct(n)}createTag(t){this._productsService.createTag({active:!0,name:t}).subscribe(({data:i})=>{this.addTagToProduct(i.createTag.tag),this._changeDetectorRef.markForCheck()})}updateTagName(t,n){t.name=n.target.value,delete t.__typename,setTimeout(()=>{this._productsService.updateTag(t).pipe((0,T.b)(300)).subscribe(()=>{this._changeDetectorRef.markForCheck()})},1e3)}deleteTag(t){this._productsService.deleteTag(t.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(t){const n=(0,V.cloneDeep)(this.selectedProduct);n.tags.unshift(t.id),this.productForm.get("tags").patchValue(n.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(t){const n=this.productForm.getRawValue();n.tags.splice(n.tags.findIndex(i=>i===t.id),1),this.productForm.get("tags").patchValue(n.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(t,n){n.checked?this.addTagToProduct(t):this.removeTagFromProduct(t)}shouldShowCreateTagButton(t){return!(""===t||this.tags.findIndex(n=>n.name.toLowerCase()===t.toLowerCase())>-1)}createProduct(){const t=this.productForm.getRawValue();delete t.id,"generic"===t.type&&(delete t.stock,delete t.price),t.haveColor=this.showColor,t.haveSize=this.showSize,t.variants=this.variants,this._fuseConfirmationService.open({title:"Crear familia de productos",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productsService.createProduct(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:a.createProduct.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/products")}),this._changeDetectorRef.markForCheck()})}updateProduct(){const t=this.productForm.getRawValue();t.variants=this.variants,"generic"===t.type&&(delete t.stock,delete t.price),t.categoryId=this.selectedProduct.categoryId,this._fuseConfirmationService.open({title:"Actualizar Producto",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productsService.updateProduct(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:a.updateProduct.message,type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/warehouse/products")}),this._changeDetectorRef.markForCheck()})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,n){return n.id||t}displayFnCategory(t){if(""===t)return;let n="";const i=this.categories.find(a=>a.id===t&&0===a.children.length);if(i)return i.name;for(const a of this.categories){const s=a.children.find(d=>d.id===t);if(s){n=s.name;break}}return n}selectFiles(t,n){0!==t.target.files.length&&this._openCropperDialog(t,n)}_checkOnSaleQty(t,n){return i=>{const a=i.get(t),s=i.get(n);if(!a||!s||(s.hasError("invalid")&&(delete s.errors.invalid,s.updateValueAndValidity()),a.value>=s.value))return null;const d={invalid:"La cantidad en venta no debe ser mayor a la disponible"};return s.setErrors(d),d}}_filterCategories(t){return t?this.categories.map(n=>({id:n.id,active:n.active,name:n.name,children:this._filter(n.children,t)})).filter(n=>n.children.length>0||n.name.toLowerCase().trim().includes(t.toLocaleLowerCase())):this.categories}_findCategoryId(t){let n="";for(const i of this.categories){const a=i.children.find(s=>s.name.trim().toLowerCase()===t.trim().toLowerCase());if(a){n=a.id;break}}return n}_findCategoryName(t){let n="";for(const i of this.categories){const a=i.children.find(s=>s.id===t);if(a){n=a.name;break}}return n}_uploadFile(t,n){this._imagesService.uploadImage("products",t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(i=>{const a=(0,V.cloneDeep)(this.selectedProduct);if(delete a.brand,delete a.uom,delete a.currency,delete a.merchantId,delete a.__typename,"thumbnail"===n&&(a.thumbnail=i.secure_url,a.thumbnailCode=i.public_id),"images"===n){const s=[...a.images,i.secure_url];a.images=s;const d=[...a.imagesCode,i.public_id];a.imagesCode=d}this._productsService.updateProduct(a).subscribe(()=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:i.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}_openCropperDialog(t,n){this._dialog.open(Do.u,{data:{image:t},panelClass:"ath-dialog-panel",minWidth:"200px",maxWidth:"500px",maxHeight:"90vh",disableClose:!0}).afterClosed().subscribe(a=>{ze.W.IsNullOrEmpty(a)||this._uploadFile(a,n)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.gz),e.Y36(e.sBO),e.Y36(M.uw),e.Y36(c.qu),e.Y36(j.R),e.Y36($e.C),e.Y36(be.s),e.Y36(N.ux),e.Y36(f.F0),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-product-detail"]],decls:110,vars:62,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","gap-5","p-3","overflow-y-auto","bg-cover","sm:absolute","sm:inset-0","dark:bg-transparent"],[1,"z-20","flex","flex-col","bg-transparent","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-5"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/warehouse/products",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[4,"ngIf"],[1,"flex","flex-auto"],[1,"w-full",3,"formGroup","autocomplete"],[1,"grid","grid-cols-1","gap-3","sm:grid-cols-4"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","sm:col-span-3","bg-card"],[1,"text-xl","font-semibold"],[1,"grid","w-full","gap-6","sm:grid-cols-3"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","grid-cols-1","gap-3","mt-5","sm:grid-cols-2","md:grid-cols-4"],[1,"w-full","col-span-2","fuse-mat-dense","fuse-mat-no-subscript"],["matInput","","type","text","minlength","3","maxlength","255","required","",3,"formControlName"],["svgIcon","mat_solid:search","matPrefix",""],["type","text","matInput","","required","",3,"formControlName","matAutocomplete"],[3,"displayWith"],["categoriesGroup","matAutocomplete"],[4,"ngFor","ngForOf"],[3,"formControlName"],[3,"formControlName","required","placeholder"],[3,"value",4,"ngFor","ngForOf"],["value",""],[1,"w-full","col-span-2","sm:col-span-4"],["matInput","","matTextareaAutosize","","maxlength","10000",3,"formControlName","rows"],[1,"text-right"],[1,"flex","flex-col","gap-3","p-3","rounded-md","shadow-md","bg-card"],[3,"color","formControlName"],[3,"color","formControl"],[1,"flex","flex-col"],[1,"mb-px","text-xl","font-semibold","leading-tight"],[1,"mt-1.5","rounded-md","border","border-gray-300","dark:border-gray-500","shadow-sm","overflow-hidden"],[1,"flex","items-center","px-3","py-2","-my-px"],[1,"flex","items-center","flex-auto","min-w-0"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Buscar",1,"min-w-0","py-1","ml-2","border-0",3,"minLength","maxLength","input","keydown"],["newTagInput",""],["mat-icon-button","",1,"w-8","h-8","ml-3","min-h-8",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"h-32","overflow-y-auto","leading-none","border-t","border-gray-300","dark:border-gray-500"],["class","flex items-center h-10 min-h-8 -ml-0.5 pl-4 pr-3 leading-none cursor-pointer border-t hover:bg-gray-50 dark:hover:bg-hover","matRipple","",3,"click",4,"ngIf"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"disabled","ngClass","click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"relative","flex","flex-col","items-start","justify-start","p-3","border","rounded-md",3,"ngClass","matTooltip","click"],[1,"font-semibold"],[1,"mt-1","whitespace-normal","text-secondary"],[1,"flex-auto"],[1,"absolute","top-0","right-0","mt-3","mr-3","icon-size-7","text-primary",3,"svgIcon"],[3,"label","disabled",4,"ngIf"],[3,"value",4,"ngIf"],[3,"label","disabled"],[3,"value"],["svgIcon","mat_solid:cancel","matSuffix","",1,"cursor-pointer",3,"click"],["matInput","","type","text","minlength","3","maxlength","255",3,"formControlName"],["matTooltip","C\xf3digo de barras",1,"w-full","col-span-2","fuse-mat-dense","fuse-mat-no-subscript"],[1,"w-full","fuse-mat-dense","fuse-mat-no-subscript"],["matInput","","type","number","min","0","max","999999999","maxlength","50","required","",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:attach_money"],["matInput","","type","number","min","0","max","999999999","maxlength","9",3,"formControlName"],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName"],["matPrefix","","svgIcon","mat_solid:square_foot"],["matPrefix","","svgIcon","mat_solid:scale"],[1,"flex","flex-col","w-full","gap-5","sm:col-span-4"],[1,"h-full",3,"formControlName","styles","modules"],[1,"flex","items-center","justify-center","flex-auto","max-h-40"],[1,"relative","flex","items-center","justify-center","w-32","h-32","overflow-hidden","rounded-md","ring-4","ring-bg-card"],[1,"absolute","inset-0","z-10","bg-opacity-50","bg-slate-300"],[1,"absolute","inset-0","z-20","flex","items-center","justify-center"],["class","object-cover w-full h-full",3,"src",4,"ngIf"],["id","thumbnail-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["thumbnailFileInput",""],["for","thumbnail-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"text-white",3,"svgIcon"],["mat-icon-button","",3,"click"],[1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","h-10","px-4","min-h-8",3,"color","checked","change"],[1,"p-4","space-y-2"],["matInput","",3,"value","input"],["mat-icon-button","","matSuffix","",3,"click"],["matRipple","",1,"flex","items-center","h-10","min-h-8","-ml-0.5","pl-4","pr-3","leading-none","cursor-pointer","border-t","hover:bg-gray-50","dark:hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"flex","flex-col","w-full","gap-3","p-3","rounded-md","shadow-md","sm:col-span-4","bg-card"],[1,"flex","flex-row","flex-wrap","gap-2","mt-2"],[3,"formControl","change"],[1,"flex","flex-row","mt-5"],["appearance","fill",1,"flex","flex-col","w-full"],["placeholder","Agregar talla...",1,"w-full",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["aria-label","Agregar talla",3,"formControl"],["sizesChipGrid",""],[3,"removed",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove","",1,"w-5","h-5",3,"aria-label"],[1,"flex","flex-col","gap-5","mt-5"],[1,"flex","flex-row","gap-5"],[3,"colors","onChange"],["aria-label","Colores"],[1,"w-5","h-5","rounded-full"],[1,"flex","flex-col","pt-5","mt-5","border-t"],["autocomplete","off",1,"grid","items-center","gap-4","px-6","py-3","border-b","variant-form-grid","md:px-8",3,"formGroup"],[1,"w-full","text-center"],["matInput","","type","text","maxlength","255",3,"formControlName"],[1,"w-full","text-right"],["matInput","","type","number","min","0","max","999999999","required","",3,"formControlName"],["mat-icon-button","","color","primary","matTooltip","Agregar Variante",3,"disabled","ngClass","click"],[4,"ngIf","ngIfElse"],["noVariants",""],[3,"formControlName","required"],[1,"inline-flex","items-center","gap-5"],[1,"rounded-full","h-7","w-7"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","variants-grid","md:px-8"],[1,"truncate"],[1,"text-center","truncate"],["mat-icon-button","","color","warn","matTooltip","Quitar Variante",3,"click"],[1,"flex","justify-center","w-full"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Productos"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15),e.qZA()()()()(),e.TgZ(16,"div",9),e.YNc(17,Uo,5,5,"ng-container",10),e.YNc(18,Mo,5,5,"ng-container",10),e.qZA()(),e.TgZ(19,"div",11)(20,"form",12)(21,"div",13)(22,"div",14)(23,"div",15),e._uU(24," Informaci\xf3n General "),e.qZA(),e.TgZ(25,"div",16),e.YNc(26,Jo,8,9,"ng-container",17),e.qZA(),e.TgZ(27,"div",18)(28,"mat-form-field",19)(29,"mat-label"),e._uU(30,"Nombre"),e.qZA(),e._UZ(31,"input",20),e.YNc(32,Ro,2,0,"mat-error",10),e.YNc(33,Eo,2,0,"mat-error",10),e.qZA(),e.TgZ(34,"mat-form-field",19)(35,"mat-label"),e._uU(36,"Categor\xeda"),e.qZA(),e._UZ(37,"mat-icon",21)(38,"input",22),e.TgZ(39,"mat-autocomplete",23,24),e.YNc(41,Lo,3,2,"container",25),e.ALo(42,"async"),e.qZA(),e.YNc(43,Bo,2,0,"ng-container",10),e.YNc(44,Yo,2,0,"mat-error",10),e.qZA(),e.YNc(45,Oo,5,1,"ng-container",10),e.YNc(46,zo,5,1,"ng-container",10),e.TgZ(47,"mat-form-field",19)(48,"mat-label"),e._uU(49,"Marca"),e.qZA(),e.TgZ(50,"mat-select",26),e.YNc(51,$o,3,2,"ng-container",25),e.qZA(),e.YNc(52,jo,2,0,"mat-error",10),e.qZA(),e.TgZ(53,"mat-form-field",19)(54,"mat-label"),e._uU(55,"Moneda"),e.qZA(),e.TgZ(56,"mat-select",27),e.YNc(57,Ko,2,2,"mat-option",28),e.qZA(),e.YNc(58,Go,2,0,"mat-error",10),e.qZA(),e.TgZ(59,"mat-form-field",19)(60,"mat-label"),e._uU(61,"Unidad de Medida"),e.qZA(),e.TgZ(62,"mat-select",26)(63,"mat-option",29),e._uU(64,"Seleccione la unidad de medida"),e.qZA(),e.YNc(65,Ho,3,2,"ng-container",25),e.qZA(),e.YNc(66,Vo,2,0,"mat-error",10),e.qZA(),e.YNc(67,on,32,9,"ng-container",10),e.YNc(68,nn,22,4,"ng-container",10),e.TgZ(69,"mat-form-field",30)(70,"mat-label"),e._uU(71,"Descripci\xf3n"),e.qZA(),e._UZ(72,"textarea",31),e.TgZ(73,"mat-hint",32),e._uU(74),e.qZA()(),e.YNc(75,rn,5,4,"ng-container",10),e.YNc(76,an,5,4,"ng-container",10),e.qZA()(),e.TgZ(77,"div",33),e.YNc(78,dn,10,3,"ng-container",10),e.TgZ(79,"div",15),e._uU(80," Opciones "),e.qZA(),e.TgZ(81,"mat-slide-toggle",34),e._uU(82,"\xbfEst\xe1 activo?"),e.qZA(),e.TgZ(83,"mat-slide-toggle",34),e._uU(84,"\xbfEs perecedero? "),e.qZA(),e.TgZ(85,"mat-slide-toggle",34),e._uU(86,"\xbfEs un servicio? "),e.qZA(),e.TgZ(87,"mat-slide-toggle",34),e._uU(88,"\xbfEs digital? "),e.qZA(),e.TgZ(89,"mat-slide-toggle",35),e._uU(90,"\xbfTiene garant\xeda? "),e.qZA(),e.TgZ(91,"mat-slide-toggle",35),e._uU(92,"\xbfTiene especificaciones? "),e.qZA(),e.TgZ(93,"div",36)(94,"span",37),e._uU(95,"Etiquetas"),e.qZA(),e.TgZ(96,"div",38)(97,"div",39)(98,"div",40),e._UZ(99,"mat-icon",41),e.TgZ(100,"input",42,43),e.NdJ("input",function(a){return n.filterTags(a)})("keydown",function(a){return n.filterTagsInputKeyDown(a)}),e.qZA()(),e.TgZ(102,"button",44),e.NdJ("click",function(){return n.toggleTagsEditMode()}),e.YNc(103,pn,1,1,"mat-icon",45),e.YNc(104,mn,1,1,"mat-icon",45),e.qZA()(),e.TgZ(105,"div",46),e.YNc(106,gn,2,2,"ng-container",10),e.YNc(107,hn,3,2,"ng-container",10),e.YNc(108,fn,7,2,"div",47),e.qZA()()()(),e.YNc(109,Un,15,5,"ng-container",10),e.qZA()()()()),2&t){const i=e.MAs(40),a=e.MAs(101);e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(2),e.Oqu("new"===n.productId?"Crear Producto":n.selectedProduct.name),e.xp6(2),e.Q6J("ngIf",!n.editMode),e.xp6(1),e.Q6J("ngIf",n.editMode),e.xp6(2),e.Q6J("formGroup",n.productForm)("autocomplete","off"),e.xp6(6),e.Q6J("ngForOf",n.types)("ngForTrackBy",n.trackByFn),e.xp6(5),e.Q6J("formControlName","name"),e.xp6(1),e.Q6J("ngIf",n.productForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productForm.get("name").hasError("minlength")||n.productForm.get("name").hasError("maxlength")),e.xp6(5),e.Q6J("formControlName","categoryId")("matAutocomplete",i),e.xp6(1),e.Q6J("displayWith",n.displayFnCategory.bind(n)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(42,60,n.categoriesFiltered$)),e.xp6(2),e.Q6J("ngIf",n.productForm.get("categoryId").value),e.xp6(1),e.Q6J("ngIf",n.productForm.get("categoryId").hasError("required")),e.xp6(1),e.Q6J("ngIf","standard"===n.productForm.get("type").value),e.xp6(1),e.Q6J("ngIf","standard"===n.productForm.get("type").value),e.xp6(4),e.Q6J("formControlName","brandId"),e.xp6(1),e.Q6J("ngForOf",n.brands),e.xp6(1),e.Q6J("ngIf",n.productForm.get("brandId").hasError("required")),e.xp6(4),e.Q6J("formControlName","currencyId")("required",!0)("placeholder","Moneda"),e.xp6(1),e.Q6J("ngForOf",n.currencies),e.xp6(1),e.Q6J("ngIf",n.productForm.get("currencyId").hasError("required")),e.xp6(4),e.Q6J("formControlName","uomId"),e.xp6(3),e.Q6J("ngForOf",n.uoms),e.xp6(1),e.Q6J("ngIf",n.productForm.get("uomId").hasError("required")),e.xp6(1),e.Q6J("ngIf","generic"!==n.productForm.get("type").value),e.xp6(1),e.Q6J("ngIf","generic"!==n.productForm.get("type").value),e.xp6(4),e.Q6J("formControlName","description")("rows",1),e.xp6(2),e.hij("Total de caracteres ",n.descriptionLength," / 10000 "),e.xp6(1),e.Q6J("ngIf",n.haveSpecificationsCtrl.value),e.xp6(1),e.Q6J("ngIf",n.haveGuarantyCtrl.value),e.xp6(2),e.Q6J("ngIf",n.editMode),e.xp6(3),e.Q6J("color","primary")("formControlName","active"),e.xp6(2),e.Q6J("color","primary")("formControlName","expiration"),e.xp6(2),e.Q6J("color","primary")("formControlName","isService"),e.xp6(2),e.Q6J("color","primary")("formControlName","isDigital"),e.xp6(2),e.Q6J("color","primary")("formControl",n.haveGuarantyCtrl),e.xp6(2),e.Q6J("color","primary")("formControl",n.haveSpecificationsCtrl),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("minLength",3)("maxLength",50),e.xp6(3),e.Q6J("ngIf",!n.tagsEditMode),e.xp6(1),e.Q6J("ngIf",n.tagsEditMode),e.xp6(2),e.Q6J("ngIf",!n.tagsEditMode),e.xp6(1),e.Q6J("ngIf",n.tagsEditMode),e.xp6(1),e.Q6J("ngIf",n.shouldShowCreateTagButton(a.value)),e.xp6(1),e.Q6J("ngIf","generic"===n.productForm.get("type").value)}},dependencies:[f.yS,_.mk,_.sg,_.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.Q7,c.wO,c.nD,c.qQ,c.Fd,c.oH,c.sg,c.u,ve.PQ,fe.XC,fe.ZL,Y.ey,Y.Nv,E.lW,Po.oG,ye.qn,ye.HS,ye.oH,ye.qH,B.Hw,k.TO,k.KE,k.bx,k.hX,k.qo,k.R9,K.Nt,Y.wG,Je.gD,Ze.Rr,ke.gM,Fo.HF,W.g6,_.Ov,_.H9],encapsulation:2,changeDetection:0}),o})();var Qn=l(81042);let qn=(()=>{class o{constructor(t,n,i){this.data=t,this._dialogRef=n,this._snackBar=i,this.imageChangedEvent="",this.croppedImage="",this.imageChangedEvent=t.image}ngOnInit(){}imageCropped(t){this.croppedImage=t.base64}imageLoaded(t){}cropperReady(){}loadImageFailed(){this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"No se pudo cargar la imagen, int\xe9ntelo nuevamente.",type:"warning",svgIcon:"mat_solid:warning"}}),this._dialogRef.close()}saveImage(){const t=this._croppedImageToFile(this.croppedImage,(0,Qn.Z)());this._dialogRef.close(t)}_croppedImageToFile(t,n){const i=t.split(","),a=i[0].match(/:(.*?);/)[1],s=atob(i[1]);let d=s.length;const m=new Uint8Array(d);for(;d--;)m[d]=s.charCodeAt(d);return new File([m],n+"."+a.split("/")[1],{type:a})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(M.WI),e.Y36(M.so),e.Y36(N.ux))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-cropper-image-dialog"]],decls:16,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left","border-b"],["mat-dialog-title",""],[1,"flex","flex-row","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-1/2"],[3,"imageChangedEvent","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"flex-","flex-col","w-1/2"],[1,"text-xl","font-semibold","w-full","text-center","mb-2"],[3,"src"],[1,"flex","items-center","justify-between","w-full","px-8","py-4","bg-gray-50"],["mat-button","","mat-dialog-close","",1,"-ml-4","rounded-full",3,"color"],["mat-flat-button","",1,"rounded-full",3,"color","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),e._uU(3,"Ajustar Imagen"),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"image-cropper",5),e.NdJ("imageCropped",function(a){return n.imageCropped(a)})("imageLoaded",function(a){return n.imageLoaded(a)})("cropperReady",function(){return n.cropperReady()})("loadImageFailed",function(){return n.loadImageFailed()}),e.qZA()(),e.TgZ(7,"div",6)(8,"div",7),e._uU(9," Resultado "),e.qZA(),e._UZ(10,"img",8),e.qZA()(),e.TgZ(11,"div",9)(12,"button",10),e._uU(13,"Cancelar"),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){return n.saveImage()}),e._uU(15,"Guardar"),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("imageChangedEvent",n.imageChangedEvent)("maintainAspectRatio",!0),e.xp6(4),e.Q6J("src",n.croppedImage,e.LSH),e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("color","primary"))},dependencies:[J.ap,E.lW,M.ZT,M.uh],encapsulation:2}),o})();function Jn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",29)(2,"input",30,31),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.selectFiles(i,"thumbnail"))}),e.qZA(),e.TgZ(4,"label",32)(5,"div",27),e._UZ(6,"mat-icon",28),e.qZA()()(),e.BQk()}2&o&&(e.xp6(2),e.Q6J("multiple",!1)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(4),e.Q6J("svgIcon","mat_solid:add"))}function Rn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",33),e._UZ(2,"img",34),e.TgZ(3,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.removeFile(i.selectedProduct.thumbnailCode,"thumbnail"))}),e._UZ(4,"mat-icon",36),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("src",t.selectedProduct.thumbnail,e.LSH)}}function En(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",38),e._UZ(2,"img",34),e.TgZ(3,"button",35),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.removeFile(s.selectedProduct.imagesCode[a],"images"))}),e._UZ(4,"mat-icon",36),e.qZA()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(2),e.Q6J("src",t,e.LSH)}}function Sn(o,r){if(1&o&&(e.ynx(0),e.YNc(1,En,5,1,"ng-container",37),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.selectedProduct.images)}}let Nn=(()=>{class o{constructor(t,n,i,a,s,d){this._changeDetectorRef=t,this._dialog=n,this._imagesService=i,this._productsService=a,this._snackBar=s,this.store=d,this.selectedProduct=new Oe,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(te.Fn).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.selectedProduct=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectFiles(t,n){0!==t.target.files.length&&this._openCropperDialog(t,n)}removeFile(t,n){void 0!==t&&this._imagesService.removeImage(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(i=>{const a=(0,V.cloneDeep)(this.selectedProduct);if(delete a.brand,delete a.uom,delete a.currency,delete a.merchantId,"thumbnail"===n&&(a.thumbnail=null,a.thumbnailCode=null),"images"===n){const s=[...a.images],d=[...a.imagesCode],m=s.findIndex(I=>I===t);s.splice(m,1),d.splice(m,1),a.images=s,a.imagesCode=d}this._productsService.updateProduct(a).subscribe(({data:s})=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:s.updateProduct.message,type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}_uploadFile(t,n){this._imagesService.uploadImage("products",t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(i=>{const a=(0,V.cloneDeep)(this.selectedProduct);if(delete a.brand,delete a.uom,delete a.currency,delete a.merchantId,"thumbnail"===n&&(a.thumbnail=i.secure_url,a.thumbnailCode=i.public_id),"images"===n){const s=[...a.images,i.secure_url];a.images=s;const d=[...a.imagesCode,i.public_id];a.imagesCode=d}this._productsService.updateProduct(a).subscribe(()=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:i.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}_openCropperDialog(t,n){this._dialog.open(qn,{data:{image:t},panelClass:"ath-dialog-panel",minWidth:"200px",maxWidth:"500px",maxHeight:"90vh",disableClose:!0}).afterClosed().subscribe(a=>{ze.W.IsNullOrEmpty(a)||this._uploadFile(a,n)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(M.uw),e.Y36($e.C),e.Y36(be.s),e.Y36(N.ux),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-product-images"]],decls:43,vars:10,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent"],[1,"z-20","flex","flex-col","p-6","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:py-8","sm:px-10","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/warehouse/products",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],["mat-raised-button","","routerLink","/warehouse/products",1,"text-white","bg-gradient-to-r","from-primary-500","to-primary-600"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-y-auto"],[1,"flex","flex-col","w-full","p-6","md:p-8","sm:flex-row"],[1,"flex","flex-col","w-full","px-5","border-r","sm:w-1/3"],[1,"font-medium"],[1,"flex","flex-col","items-center","justify-center","h-full"],[4,"ngIf"],[1,"flex","flex-col","w-full","px-5","mt-5","sm:w-2/3","sm:mt-0"],[1,"flex","flex-row","flex-wrap","items-center","justify-center","h-full","mt-5"],[1,"flex","items-center","justify-center"],["id","images-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["imagesFileInput",""],["for","images-file-input","matRipple",""],[1,"flex","flex-col","items-center","justify-center","transition-colors","duration-150","ease-in-out","border-2","border-gray-300","border-dashed","cursor-pointer","w-30","sm:w-40","h-30","sm:h-40","rounded-2xl","hover:bg-hover"],[1,"icon-size-12","text-hint",3,"svgIcon"],[1,"flex","flex-col","items-center","justify-center","mt-5"],["id","thumbnail-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["thumbnailFileInput",""],["for","thumbnail-file-input","matRipple",""],[1,"relative","flex","items-center","justify-center","p-4","m-2","overflow-hidden","shadow","w-30","sm:w-40","h-30","sm:h-40","rounded-2xl","bg-card"],[3,"src"],["mat-mini-fab","",1,"absolute","p-5","transition-opacity","ease-linear","delay-200","rounded-full","opacity-70","bg-primary-700","hover:opacity-100",3,"click"],["svgIcon","mat_solid:delete",1,"text-white","icon-size-5"],[4,"ngFor","ngForOf"],[1,"relative","flex","items-center","justify-center","m-2","overflow-hidden","shadow","w-30","sm:w-40","h-30","sm:h-40","sm:p-4","rounded-2xl","bg-card"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Productos"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15," Im\xe1genes "),e.qZA()()()(),e.TgZ(16,"div",9)(17,"h2",10),e._uU(18),e.qZA()()(),e.TgZ(19,"div",11)(20,"button",12),e._UZ(21,"mat-icon",13),e.TgZ(22,"span",14),e._uU(23,"Regresar"),e.qZA()()()(),e.TgZ(24,"div",15)(25,"div",16)(26,"div",17)(27,"div",18),e._uU(28,"Imagen principal"),e.qZA(),e.TgZ(29,"div",19),e.YNc(30,Jn,7,3,"ng-container",20),e.YNc(31,Rn,5,1,"ng-container",20),e.qZA()(),e.TgZ(32,"div",21)(33,"div",18),e._uU(34,"Im\xe1genes de apoyo"),e.qZA(),e.TgZ(35,"div",22)(36,"div",23)(37,"input",24,25),e.NdJ("change",function(a){return n.selectFiles(a,"images")}),e.qZA(),e.TgZ(39,"label",26)(40,"div",27),e._UZ(41,"mat-icon",28),e.qZA()()(),e.YNc(42,Sn,2,1,"ng-container",20),e.qZA()()()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(5),e.hij(" Im\xe1genes de ",n.selectedProduct.name," "),e.xp6(3),e.Q6J("svgIcon","mat_solid:west"),e.xp6(9),e.Q6J("ngIf",!n.selectedProduct.thumbnailCode),e.xp6(1),e.Q6J("ngIf",n.selectedProduct.thumbnailCode),e.xp6(6),e.Q6J("multiple",!1)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(4),e.Q6J("svgIcon","mat_solid:add"),e.xp6(1),e.Q6J("ngIf",n.selectedProduct.images.length>0))},dependencies:[f.rH,f.yS,_.sg,_.O5,ve.PQ,E.lW,B.Hw,Y.wG],encapsulation:2,changeDetection:0}),o})(),Wn=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-products"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[f.lC],encapsulation:2}),o})();var Ke=l(63844);function Ln(o,r){if(1&o&&e._UZ(0,"img",43),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Product thumbnail image")("src",t.thumbnail,e.LSH)}}function Bn(o,r){1&o&&(e.TgZ(0,"div",44),e._uU(1," SIN IMAGEN "),e.qZA())}function Yn(o,r){if(1&o&&(e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.sku," ")}}function On(o,r){1&o&&(e.ynx(0),e._UZ(1,"div"),e.BQk())}function zn(o,r){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"currency"),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.gM2(2,1,t.price,"$ ","symbol","1.2-2")," ")}}function $n(o,r){1&o&&(e.ynx(0),e._UZ(1,"div"),e.BQk())}function jn(o,r){1&o&&(e.TgZ(0,"div",49),e._UZ(1,"div",50),e.qZA())}function Kn(o,r){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"div",52),e.qZA())}function Gn(o,r){1&o&&(e.TgZ(0,"div",53),e._UZ(1,"div",54),e.qZA())}function Hn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",45),e._uU(2),e.qZA(),e.YNc(3,jn,2,0,"div",46),e.YNc(4,Kn,2,0,"div",47),e.YNc(5,Gn,2,0,"div",48),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.stock," "),e.xp6(1),e.Q6J("ngIf",t.stock<20),e.xp6(1),e.Q6J("ngIf",t.stock>=20&&t.stock<30),e.xp6(1),e.Q6J("ngIf",t.stock>=30)}}function Vn(o,r){1&o&&(e.ynx(0),e._UZ(1,"div"),e.BQk())}function Xn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-slide-toggle",55),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,d=a.index,m=e.oxw(4);return e.KtG(m.updateProductStatus(i,s,d))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("checked",t.active)("color","primary")}}function ei(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-spinner",56),e.BQk()),2&o&&(e.xp6(1),e.Q6J("diameter",20)("color","primary"))}function ti(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",57),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw(4);return e.KtG(a.deleteProduct(i.id))}),e._UZ(2,"mat-icon",42),e.qZA(),e.BQk()}2&o&&(e.xp6(2),e.Q6J("svgIcon","mat_solid:delete"))}function oi(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",57),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw(4);return e.KtG(a.toggleVariants(i))}),e._UZ(2,"mat-icon",42),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit,n=e.oxw(4);e.xp6(2),e.Q6J("svgIcon",(null==n.selectedProduct?null:n.selectedProduct.id)===t.id?"mat_solid:expand_more":"mat_solid:expand_less")}}function ni(o,r){1&o&&e.GkF(0)}const ii=function(o){return{$implicit:o}};function ri(o,r){if(1&o&&(e.ynx(0),e.YNc(1,ni,1,0,"ng-container",58),e.BQk()),2&o){const t=e.oxw().$implicit;e.oxw(4);const n=e.MAs(27);e.xp6(1),e.Q6J("ngTemplateOutlet",n)("ngTemplateOutletContext",e.VKq(2,ii,t))}}function ai(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",30)(2,"div",31)(3,"div",32),e.YNc(4,Ln,1,2,"img",33),e.YNc(5,Bn,2,0,"div",34),e.qZA()(),e.TgZ(6,"div",35),e.YNc(7,Yn,2,1,"ng-container",19),e.YNc(8,On,2,0,"ng-container",19),e.qZA(),e.TgZ(9,"div",35),e._uU(10),e.qZA(),e.TgZ(11,"div",36),e.YNc(12,zn,3,6,"ng-container",19),e.YNc(13,$n,2,0,"ng-container",19),e.qZA(),e.TgZ(14,"div",37),e.YNc(15,Hn,6,4,"ng-container",19),e.YNc(16,Vn,2,0,"ng-container",19),e.qZA(),e.TgZ(17,"div",38),e._uU(18),e.qZA(),e.TgZ(19,"div",39),e.YNc(20,Xn,2,2,"ng-container",19),e.YNc(21,ei,2,2,"ng-container",19),e.qZA(),e.TgZ(22,"div",40)(23,"button",41),e._UZ(24,"mat-icon",42),e.qZA(),e.YNc(25,ti,3,1,"ng-container",19),e.YNc(26,oi,3,1,"ng-container",19),e.qZA()(),e.TgZ(27,"div",24),e.YNc(28,ri,2,4,"ng-container",19),e.qZA(),e.BQk()),2&o){const t=r.$implicit,n=r.index,i=e.oxw(4);e.xp6(3),e.Q6J("routerLink","/warehouse/product-images/"+t.id),e.xp6(1),e.Q6J("ngIf",t.thumbnail),e.xp6(1),e.Q6J("ngIf",!t.thumbnail),e.xp6(2),e.Q6J("ngIf","standard"===t.type),e.xp6(1),e.Q6J("ngIf","generic"===t.type),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf","standard"===t.type),e.xp6(1),e.Q6J("ngIf","generic"===t.type),e.xp6(2),e.Q6J("ngIf","standard"===t.type),e.xp6(1),e.Q6J("ngIf","generic"===t.type),e.xp6(2),e.hij(" ",t.salesQty," "),e.xp6(2),e.Q6J("ngIf",!(i.isSlideLoading&&i.selectedSlide===n)),e.xp6(1),e.Q6J("ngIf",i.isSlideLoading&&i.selectedSlide===n),e.xp6(2),e.Q6J("routerLink","/warehouse/products/"+t.id),e.xp6(1),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(1),e.Q6J("ngIf",0===t.variants.length),e.xp6(1),e.Q6J("ngIf","generic"===t.type),e.xp6(2),e.Q6J("ngIf",(null==i.selectedProduct?null:i.selectedProduct.id)===t.id)}}function si(o,r){if(1&o&&(e.ynx(0),e.YNc(1,ai,29,18,"ng-container",29),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}function ci(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",24)(2,"div",25),e._UZ(3,"div"),e.TgZ(4,"div",26),e._uU(5," SKU "),e.qZA(),e.TgZ(6,"div",27),e._uU(7," Nombre "),e.qZA(),e.TgZ(8,"div",27),e._uU(9," Precio "),e.qZA(),e.TgZ(10,"div",27),e._uU(11," Stock "),e.qZA(),e.TgZ(12,"div",28),e._uU(13," U.Vendidas "),e.qZA(),e.TgZ(14,"div",26),e._uU(15," Activo "),e.qZA(),e.TgZ(16,"div",26),e._uU(17,"Detalles"),e.qZA()(),e.YNc(18,si,2,2,"ng-container",19),e.ALo(19,"async"),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(6),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","price"),e.xp6(2),e.Q6J("mat-sort-header","stock"),e.xp6(2),e.Q6J("mat-sort-header","salesQty"),e.xp6(6),e.Q6J("ngIf",e.lcZ(19,5,t.products$))}}function li(o,r){if(1&o&&(e.ynx(0),e.YNc(1,ci,20,7,"ng-container",23),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function di(o,r){1&o&&(e.TgZ(0,"div",49),e._UZ(1,"div",50),e.qZA())}function pi(o,r){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"div",52),e.qZA())}function mi(o,r){1&o&&(e.TgZ(0,"div",53),e._UZ(1,"div",54),e.qZA())}function ui(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",62)(2,"div",26),e._uU(3),e.qZA(),e.TgZ(4,"div",26),e._uU(5),e.qZA(),e.TgZ(6,"div",26),e._uU(7),e.qZA(),e.TgZ(8,"div",26),e._uU(9),e.qZA(),e.TgZ(10,"div",26),e._uU(11),e.ALo(12,"number"),e.qZA(),e.TgZ(13,"div",37),e._uU(14),e.YNc(15,di,2,0,"div",46),e.YNc(16,pi,2,0,"div",47),e.YNc(17,mi,2,0,"div",48),e.qZA()(),e.BQk()),2&o){const t=r.$implicit,n=r.index;e.xp6(3),e.hij(" ",n+1," "),e.xp6(2),e.hij(" ",t.sku||"Sin SKU"," "),e.xp6(2),e.hij(" ",t.size||"Sin Talla"," "),e.xp6(2),e.hij(" ",t.color||"Sin Color"," "),e.xp6(2),e.hij(" ",e.xi3(12,9,t.price,"1.2-2")," "),e.xp6(3),e.hij(" ",t.stock," "),e.xp6(1),e.Q6J("ngIf",t.stock<20),e.xp6(1),e.Q6J("ngIf",t.stock>=20&&t.stock<30),e.xp6(1),e.Q6J("ngIf",t.stock>=30)}}function gi(o,r){if(1&o&&(e.TgZ(0,"div",59)(1,"div",60)(2,"div",26),e._uU(3," Variante "),e.qZA(),e.TgZ(4,"div",26),e._uU(5," SKU "),e.qZA(),e.TgZ(6,"div",26),e._uU(7," Talla "),e.qZA(),e.TgZ(8,"div",26),e._uU(9," Color "),e.qZA(),e.TgZ(10,"div",26),e._uU(11," Precio "),e.qZA(),e.TgZ(12,"div",26),e._uU(13," Stock "),e.qZA()(),e.YNc(14,ui,18,12,"ng-container",61),e.qZA()),2&o){const t=r.$implicit;e.xp6(14),e.Q6J("ngForOf",t.variants)}}const _i=function(o){return{"pointer-events-none":o}},hi=function(){return[5,10,25,100]};function fi(o,r){if(1&o&&e._UZ(0,"mat-paginator",63),2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(6,_i,t.isLoading))("length",t.pagination.length)("page",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(8,hi))("showFirstLastButtons",!0)}}function xi(o,r){1&o&&(e.TgZ(0,"div",64),e._uU(1,"\xa1No se ha creado ning\xfan producto!"),e.qZA())}let vi=(()=>{class o{constructor(t,n,i,a,s,d){this._changeDetectorRef=t,this._fuseConfirmationService=n,this._formBuilder=i,this._productsService=a,this._snackBar=s,this.store=d,this.isLoading=!1,this.products$=(0,U.of)([]),this.searchInputControl=new c.p4,this.selectedProduct=null,this.isSlideLoading=!1,this.selectedSlide=null,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(X.B).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.products$=this.store.select(te.nR),this.searchInputControl.valueChanges.pipe((0,p.R)(this._unsubscribeAll),(0,T.b)(300),(0,v.w)(t=>(this.isLoading=!0,this._productsService.getProductsByMerchant(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,t))),(0,x.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,g.T)(this._sort.sortChange,this._paginator.page).pipe((0,v.w)(()=>(this.isLoading=!0,this._productsService.getProductsByMerchant(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,x.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}toggleVariants(t){this.selectedProduct&&this.selectedProduct.id===t.id?this.closeDetails():this.selectedProduct=t}closeDetails(){this.selectedProduct=null}deleteProduct(t){this._fuseConfirmationService.open({title:"Eliminar Producto",message:"\xbfEsta seguro que desea eliminar el producto?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productsService.removeProduct(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(({data:a})=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:a.removeProduct.message,type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck()})}updateProductStatus(t,n,i){this.isSlideLoading=!0,this.selectedSlide=i,this._productsService.updateProductStatus({id:n.id,active:t.checked}).subscribe(({data:a})=>{this._snackBar.openFromComponent(Z.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:a.updateProductStatus.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.isSlideLoading=!1,this.selectedSlide=null,this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(j.R),e.Y36(c.QS),e.Y36(be.s),e.Y36(N.ux),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-products-list"]],viewQuery:function(t,n){if(1&t&&(e.Gf(D.NW,5),e.Gf(C.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:32,vars:10,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","flex-auto","min-w-0","overflow-x-auto","overflow-y-auto","bg-card","dark:bg-transparent","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-2xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","","routerLink","/warehouse/products/new",1,"mt-4","text-white","sm:mt-0","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","justify-between","flex-auto"],[4,"ngIf"],["rowVariantsTemplate",""],["class","z-10 border-b sm:inset-x-0 sm:bottom-0 sm:border-t sm:border-b-0 bg-gray-50 dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons",4,"ngIf"],["noProducts",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","inventory-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"text-center"],[1,"text-center",3,"mat-sort-header"],["matTooltip","Unidades Vendidas",1,"text-center",3,"mat-sort-header"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","overflow-x-auto","border-b","inventory-grid","md:px-8"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","overflow-hidden","border","rounded","cursor-pointer","flex-0",3,"routerLink"],["class","w-8",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase",4,"ngIf"],[1,"truncate"],[1,"font-mono"],[1,"flex","items-center","justify-center"],[1,"font-mono","text-center"],[1,"flex","justify-center"],[1,"flex","flex-row","flex-wrap","justify-center","gap-1"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],[1,"w-8",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"font-mono","min-w-4"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-red-200 rounded",4,"ngIf"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-orange-200 rounded",4,"ngIf"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-green-100 rounded",4,"ngIf"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-red-200","rounded"],[1,"flex","w-full","bg-red-600","h-1/3"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-orange-200","rounded"],[1,"flex","w-full","bg-orange-400","h-2/4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[3,"checked","color","change"],[3,"diameter","color"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","flex-col","w-full","overflow-hidden","border-b"],[1,"z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","variant-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[4,"ngFor","ngForOf"],[1,"grid","items-center","w-full","gap-4","px-6","py-3","border-b","variant-grid","md:px-8"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Productos"),e.qZA()()(),e.TgZ(11,"div",8)(12,"h2",9),e._uU(13," Productos "),e.qZA()()(),e.TgZ(14,"div",10)(15,"mat-form-field",11),e._UZ(16,"mat-icon",12)(17,"input",13),e.qZA(),e.TgZ(18,"button",14),e._UZ(19,"mat-icon",15),e.TgZ(20,"span",16),e._uU(21,"Agregar"),e.qZA()()()(),e.TgZ(22,"div",17)(23,"div",18),e.YNc(24,li,2,2,"ng-container",19),e.ALo(25,"async"),e.YNc(26,gi,15,1,"ng-template",null,20,e.W1O),e.ynx(28),e.YNc(29,fi,1,9,"mat-paginator",21),e.BQk(),e.YNc(30,xi,2,0,"ng-template",null,22,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar productos"),e.xp6(2),e.Q6J("svgIcon","mat_solid:add"),e.xp6(5),e.Q6J("ngIf",e.lcZ(25,8,n.products$)),e.xp6(5),e.Q6J("ngIf",n.pagination.length>0))},dependencies:[f.rH,f.yS,_.mk,_.sg,_.O5,_.tP,c.Fj,c.JJ,c.oH,ve.PQ,E.lW,B.Hw,k.KE,k.qo,K.Nt,D.NW,Ue.Ou,Ze.Rr,C.YE,C.nU,ke.gM,_.Ov,_.JJ,_.H9],styles:[".inventory-grid{grid-template-columns:48px 112px auto 112px 112px 112px 72px 150px}\n"],encapsulation:2,data:{animation:Ke.L},changeDetection:0}),o})();function bi(o,r){if(1&o&&e._UZ(0,"img",49),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Product thumbnail image")("src",t.thumbnail,e.LSH)}}function yi(o,r){1&o&&(e.TgZ(0,"div",50),e._uU(1," SIN IMAGEN "),e.qZA())}function Ci(o,r){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"div",52),e.qZA())}function Zi(o,r){1&o&&(e.TgZ(0,"div",53),e._UZ(1,"div",54),e.qZA())}function Ti(o,r){1&o&&(e.TgZ(0,"div",55),e._UZ(1,"div",56),e.qZA())}function Ii(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",57),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","mat_solid:done"))}function Ai(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",58),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","mat_solid:close"))}function ki(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",31)(2,"div",32)(3,"div",33),e.YNc(4,bi,1,2,"img",34),e.YNc(5,yi,2,0,"div",35),e.qZA()(),e.TgZ(6,"div",36),e._uU(7),e.qZA(),e.TgZ(8,"div",37),e._uU(9),e.qZA(),e.TgZ(10,"div",38),e._uU(11),e.ALo(12,"currency"),e.qZA(),e.TgZ(13,"div",39)(14,"div",40),e._uU(15),e.qZA(),e.YNc(16,Ci,2,0,"div",41),e.YNc(17,Zi,2,0,"div",42),e.YNc(18,Ti,2,0,"div",43),e.qZA(),e.TgZ(19,"div",44),e._uU(20),e.qZA(),e.TgZ(21,"div",44),e.YNc(22,Ii,2,1,"ng-container",19),e.YNc(23,Ai,2,1,"ng-container",19),e.qZA(),e.TgZ(24,"div",45)(25,"button",46),e._UZ(26,"mat-icon",47),e.qZA(),e.TgZ(27,"button",48),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw(4);return e.KtG(s.deleteProduct(a.id))}),e._UZ(28,"mat-icon",47),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(4),e.Q6J("ngIf",t.thumbnail),e.xp6(1),e.Q6J("ngIf",!t.thumbnail),e.xp6(2),e.hij(" ",t.sku," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",e.gM2(12,15,t.price,"$ ","symbol","1.2-2")," "),e.xp6(4),e.Oqu(t.stock),e.xp6(1),e.Q6J("ngIf",t.stock<20),e.xp6(1),e.Q6J("ngIf",t.stock>=20&&t.stock<30),e.xp6(1),e.Q6J("ngIf",t.stock>=30),e.xp6(2),e.hij(" ",t.salesQty," "),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(2),e.Q6J("routerLink","/warehouse/products/"+t.id),e.xp6(1),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(2),e.Q6J("svgIcon","mat_solid:delete")}}function wi(o,r){if(1&o&&(e.ynx(0),e.YNc(1,ki,29,20,"ng-container",30),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Di=function(o){return{"pointer-events-none":o}},Pi=function(){return[5,10,25,100]};function Fi(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22)(2,"div",23),e._UZ(3,"div"),e.TgZ(4,"div",24),e._uU(5," SKU "),e.qZA(),e.TgZ(6,"div",25),e._uU(7," Nombre "),e.qZA(),e.TgZ(8,"div",26),e._uU(9," Precio "),e.qZA(),e.TgZ(10,"div",27),e._uU(11," Stock "),e.qZA(),e.TgZ(12,"div",27),e._uU(13," Unidades Vendidas "),e.qZA(),e.TgZ(14,"div",27),e._uU(15," Activo "),e.qZA(),e.TgZ(16,"div",28),e._uU(17,"Detalles"),e.qZA()(),e.YNc(18,wi,2,2,"ng-container",19),e.ALo(19,"async"),e.qZA(),e._UZ(20,"mat-paginator",29),e.BQk()),2&o){const t=e.oxw(2);e.xp6(6),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","price"),e.xp6(2),e.Q6J("mat-sort-header","stock"),e.xp6(2),e.Q6J("mat-sort-header","salesQty"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,12,t.products$)),e.xp6(2),e.Q6J("ngClass",e.VKq(14,Di,t.isLoading))("length",t.pagination.length)("page",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(16,Pi))("showFirstLastButtons",!0)}}function Ui(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Fi,21,17,"ng-container",21),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Mi(o,r){1&o&&(e.TgZ(0,"div",59),e._uU(1," \xa1No se ha creado ning\xfan producto Perecedero! "),e.qZA())}w.vfs=L.I.vfs;let Qi=(()=>{class o{constructor(t,n,i,a,s){this._changeDetectorRef=t,this._fuseConfirmationService=n,this._formBuilder=i,this._productsService=a,this.store=s,this.isLoading=!1,this.products$=(0,U.of)([]),this.products=[],this.searchInputControl=new c.NI,this.selectedProduct=null,this.uoms$=(0,U.of)(null),this.user=null,this.merchant=null,this._unsubscribeAll=new b.x}ngOnInit(){this.store.select(pe.rk).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(ue.Qs).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.merchant=t,this._changeDetectorRef.markForCheck()}),this.store.select(X.B).pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.products$=this.store.select(te.nR),this.products$.pipe((0,p.R)(this._unsubscribeAll)).subscribe(t=>{this.products=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,p.R)(this._unsubscribeAll),(0,T.b)(300),(0,v.w)(t=>(this.isLoading=!0,this._productsService.getProducts(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,t))),(0,x.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,p.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,g.T)(this._sort.sortChange,this._paginator.page).pipe((0,v.w)(()=>(this.isLoading=!0,this._productsService.getProducts(this._paginator.pageIndex+1,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,x.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(t="open"){const n={header:{text:"Reporte de productos perecederos - almacenados",style:"header",marginTop:5},content:[{lineHeight:1.3,table:{headerRows:1,widths:[60,60,"*",60,60,70,60,60],body:[[{text:"C\xf3d.",style:"table_header"},{text:"UPC",style:"table_header"},{text:"Producto",style:"table_header",alignment:"left"},{text:"Marca",style:"table_header"},{text:"Unidad",style:"table_header"},{text:"Vencimiento",style:"table_header"},{text:"Stock",style:"table_header"},{text:"Estado",style:"table_header"}],...this.products.map(i=>[{style:"table_body",text:i.code,alignment:"center"},{style:"table_body",text:i.upc,alignment:"center"},{style:"table_body",text:i.name},{style:"table_body",text:"string"==typeof i.brand?i.brand:i.brand.name,alignment:"center"},{style:"table_body",text:"string"==typeof i.uom?i.uom:i.uom.abbr,alignment:"center"},{style:"table_body",text:h(i.expirationDate).format("DD/MM/YYYY"),alignment:"center"},{style:"table_body",text:(i.stock*i.price).toFixed(2),alignment:"center"},{style:"table_body",text:h(i.expirationDate)<h()?"VENCIDO":"VIGENTE",alignment:"center",color:h(i.expirationDate)<h()?"red":"black"}])]},layout:"lightHorizontalLines"}],footer:(i,a)=>({table:{widths:["*","*"],body:[[{text:`Reporte generador por: ${this.user.name} ${this.user.lastname1} ${this.user.lastname2} | Esta informaci\xf3n es exclusiva de ${this.merchant.name}`,bold:!0,fontSize:8},{text:`P\xe1gina ${i.toString()}/${a} - Fecha de impresi\xf3n ${h().format("DD/MM/yyyy HH:mm:ss")}`,bold:!0,fontSize:8,alignment:"right"}]]},margin:[30,0,30,0],layout:"noBorders",italics:!0}),defaultStyle:{fontSize:12},styles:{header:{fontSize:18,bold:!0,marginBottom:5,alignment:"center",fontFeatures:["c2sc","smcp"]},table_header:{fontSize:11,bold:!0,alignment:"center",fontFeatures:["c2sc","smcp"]},table_body:{fontSize:10}},pageOrientation:"landscape",pageSize:"LETTER",watermark:{text:this.merchant.name,color:"#fff",opacity:.07,angle:-35,bold:!0,italics:!1},info:{title:"Reporte de productos perecederos - almacenados",author:`${this.user.name} ${this.user.lastname1} ${this.user.lastname2}`,creationDate:h().toDate(),modDate:h().toDate(),producer:this.merchant.name}};switch(t){case t="download":w.createPdf(n).download();break;case t="open":w.createPdf(n).open();break;case t="print":w.createPdf(n).print()}}deleteProduct(t){this._fuseConfirmationService.open({title:"Eliminar Producto",message:"\xbfEsta seguro que desea eliminar el producto?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productsService.removeProduct(t).pipe((0,p.R)(this._unsubscribeAll)).subscribe(a=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",icon:{show:!0,name:"mat_solid:done",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(j.R),e.Y36(c.qu),e.Y36(be.s),e.Y36(y.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["perishables"]],viewQuery:function(t,n){if(1&t&&(e.Gf(D.NW,5),e.Gf(C.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:32,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","gap-2","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"text-white","bg-gradient-to-r","from-yellow-500","to-yellow-600",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf"],["noProducts",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","inventory-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-slate-900"],[1,"items-center","justify-center","hidden","md:flex"],[1,"flex","items-center","justify-start",3,"mat-sort-header"],[1,"items-center","justify-center","hidden","sm:flex",3,"mat-sort-header"],[1,"items-center","justify-center","hidden","lg:flex",3,"mat-sort-header"],[1,"items-center","justify-center","hidden","sm:flex"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","inventory-grid","md:px-8"],[1,"flex","items-center"],[1,"relative","flex","items-center","justify-center","w-12","h-12","mr-6","overflow-hidden","border","rounded","flex-0"],["class","w-8",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase",4,"ngIf"],[1,"hidden","truncate","md:block"],[1,"truncate"],[1,"hidden","text-right","sm:block"],[1,"items-center","justify-center","hidden","lg:flex"],[1,"min-w-4"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-red-200 rounded",4,"ngIf"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-orange-200 rounded",4,"ngIf"],["class","flex items-end w-1 h-4 ml-2 overflow-hidden bg-green-100 rounded",4,"ngIf"],[1,"hidden","text-center","lg:block"],[1,"flex","flex-row","flex-wrap","justify-center","gap-3"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"w-8",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-red-200","rounded"],[1,"flex","w-full","bg-red-600","h-1/3"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-orange-200","rounded"],[1,"flex","w-full","bg-orange-400","h-2/4"],[1,"flex","items-end","w-1","h-4","ml-2","overflow-hidden","bg-green-100","rounded"],[1,"flex","w-full","h-full","bg-green-400"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Almac\xe9n"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",7),e._uU(14,"Productos Perecederos"),e.qZA()()(),e.TgZ(15,"div",8)(16,"h2",9),e._uU(17," Productos Perecederos "),e.qZA()()(),e.TgZ(18,"div",10)(19,"mat-form-field",11),e._UZ(20,"mat-icon",12)(21,"input",13),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return n.generatePDF()}),e._UZ(23,"mat-icon",15),e.TgZ(24,"span",16),e._uU(25,"Imprimir Reporte"),e.qZA()()()(),e.TgZ(26,"div",17)(27,"div",18),e.YNc(28,Ui,2,2,"ng-container",19),e.ALo(29,"async"),e.YNc(30,Mi,2,0,"ng-template",null,20,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar productos"),e.xp6(2),e.Q6J("svgIcon","mat_solid:print"),e.xp6(5),e.Q6J("ngIf",e.lcZ(29,8,n.products$)))},dependencies:[f.rH,f.yS,_.mk,_.sg,_.O5,c.Fj,c.JJ,c.oH,E.lW,B.Hw,k.KE,k.qo,K.Nt,D.NW,C.YE,C.nU,_.Ov,_.H9],encapsulation:2,data:{animation:Ke.L},changeDetection:0}),o})(),qi=(()=>{class o{constructor(t){this._depotsService=t}resolve(t,n){return this._depotsService.getDepots()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Ce))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Ji=(()=>{class o{constructor(t){this._kardexService=t}resolve(t,n){return this._kardexService.getKardex()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Se))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Ri=(()=>{class o{constructor(t){this._movementsService=t}resolve(t,n){return this._movementsService.getMovements()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Te))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Ei=(()=>{class o{constructor(t){this._periodsService=t}resolve(t,n){return this._periodsService.getCurrentPeriod()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Be))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Si=(()=>{class o{constructor(t){this._receptionsService=t}resolve(t,n){return this._receptionsService.getReceptions()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Ae))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var ie=l(95259),Ni=l(4024),Wi=l(90810),Li=l(67235),Bi=l(98118);const Yi=[{path:"",component:A},{path:"depots",component:bt,resolve:{depots:qi}},{path:"inventory-admin",component:Io,resolve:{period:Ei}},{path:"kardex",component:Nt,resolve:{kardex:Ji}},{path:"movements",component:jt,resolve:{movements:Ri,products:ie.SE}},{path:"products",component:Wn,children:[{path:"",component:vi,resolve:{products:ie.SE}},{path:":productId",component:Mn,resolve:{brands:Ni.J,currencies:Wi.Y,categories:Li.g,product:ie.M6,tags:ie.Nj,uoms:Bi.d}}]},{path:"product-images/:productId",component:Nn,resolve:{product:ie.M6}},{path:"receptions",component:Kt,children:[{path:"new",component:ao},{path:"list",component:_o,resolve:{receptions:Si}}]},{path:"perishables",component:Qi,resolve:{products:ie.hz}}];let Oi=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[J.QG,f.Bz.forChild(Yi),u.m,W.fi]}),o})()},81042:(re,S,l)=>{l.d(S,{Z:()=>b});var f,J=new Uint8Array(16);function W(){if(!f&&!(f="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(J)}const u=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,R=function e(g){return"string"==typeof g&&u.test(g)};for(var A=[],c=0;c<256;++c)A.push((c+256).toString(16).substr(1));const b=function U(g,p,T){var v=(g=g||{}).random||(g.rng||W)();if(v[6]=15&v[6]|64,v[8]=63&v[8]|128,p){T=T||0;for(var x=0;x<16;++x)p[T+x]=v[x];return p}return function D(g){var p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,T=(A[g[p+0]]+A[g[p+1]]+A[g[p+2]]+A[g[p+3]]+"-"+A[g[p+4]]+A[g[p+5]]+"-"+A[g[p+6]]+A[g[p+7]]+"-"+A[g[p+8]]+A[g[p+9]]+"-"+A[g[p+10]]+A[g[p+11]]+A[g[p+12]]+A[g[p+13]]+A[g[p+14]]+A[g[p+15]]).toLowerCase();if(!R(T))throw TypeError("Stringified UUID is invalid");return T}(v)}}}]);