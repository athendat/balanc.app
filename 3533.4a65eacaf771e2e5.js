"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[3533],{50123:(T,v,n)=>{n.d(v,{u:()=>I});var s=n(48966),u=n(81042),D=n(59784),t=n(5e3),E=n(57261),f=n(22313),l=n(47423),e=n(83877);let I=(()=>{class h{constructor(m,o,r,_){this.data=m,this._dialogRef=o,this._snackBar=r,this.sanitizer=_,this.imageChangedEvent="",this.croppedImage="",this.imageChangedEvent=m.image}ngOnInit(){}imageCropped(m){this.croppedImage=this.sanitizer.bypassSecurityTrustUrl(m.objectUrl),this.blob=m.blob}imageLoaded(m){}cropperReady(){}loadImageFailed(){this._snackBar.openFromComponent(D.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Alerta",message:"No se pudo cargar la imagen, int\xe9ntelo nuevamente.",type:"warning",svgIcon:"mat_solid:warning"}}),this._dialogRef.close()}saveImage(){const m=new File([this.blob],`${(0,u.Z)()}.${this.blob.type.split("/")[1]}`,{type:this.blob.type});this._dialogRef.close(m)}}return h.\u0275fac=function(m){return new(m||h)(t.Y36(s.WI),t.Y36(s.so),t.Y36(E.ux),t.Y36(f.H7))},h.\u0275cmp=t.Xpm({type:h,selectors:[["cropper-image-dialog"]],decls:16,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left","border-b"],["mat-dialog-title",""],[1,"flex","flex-row","items-center","flex-auto","w-full","px-8","pb-6"],[1,"w-1/2"],[3,"imageChangedEvent","maintainAspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"flex-","flex-col","w-1/2"],[1,"text-xl","font-semibold","w-full","text-center","mb-2"],[3,"src"],[1,"flex","items-center","justify-between","w-full","px-8","py-4","bg-gray-50"],["mat-button","","mat-dialog-close","",1,"-ml-4","rounded-full",3,"color"],["mat-flat-button","",1,"rounded-full",3,"color","click"]],template:function(m,o){1&m&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3,"Ajustar Imagen"),t.qZA()(),t.TgZ(4,"div",3)(5,"div",4)(6,"image-cropper",5),t.NdJ("imageCropped",function(_){return o.imageCropped(_)})("imageLoaded",function(_){return o.imageLoaded(_)})("cropperReady",function(){return o.cropperReady()})("loadImageFailed",function(){return o.loadImageFailed()}),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7),t._uU(9," Resultado "),t.qZA(),t._UZ(10,"img",8),t.qZA()(),t.TgZ(11,"div",9)(12,"button",10),t._uU(13,"Cancelar"),t.qZA(),t.TgZ(14,"button",11),t.NdJ("click",function(){return o.saveImage()}),t._uU(15,"Guardar"),t.qZA()()()),2&m&&(t.xp6(6),t.Q6J("imageChangedEvent",o.imageChangedEvent)("maintainAspectRatio",!0),t.xp6(4),t.Q6J("src",o.croppedImage,t.LSH),t.xp6(2),t.Q6J("color","warn"),t.xp6(2),t.Q6J("color","primary"))},dependencies:[l.lW,s.ZT,s.uh,e.ap],encapsulation:2}),h})()},68922:(T,v,n)=>{n.d(v,{C:()=>J});var s=n(93075),u=n(48966),D=n(77579),t=n(82722),E=n(50123),f=n(59784),l=n(65018),e=n(5e3),I=n(40462),h=n(71683),x=n(97231),m=n(57261),o=n(69808),r=n(47423),_=n(25245),b=n(67322),C=n(98833),M=n(90508),y=n(32368);function B(i,p){1&i&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Marca "),e.qZA())}function R(i,p){1&i&&(e.TgZ(0,"h2",7),e._uU(1," Editar Marca "),e.qZA())}function P(i,p){if(1&i&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&i){const a=e.oxw();e.xp6(8),e.Oqu(a.data.brand.name||"Sin nombre")}}function O(i,p){if(1&i){const a=e.EpF();e.TgZ(0,"div")(1,"input",28,29),e.NdJ("change",function(c){e.CHM(a);const g=e.oxw(2);return e.KtG(g.openCropperDialog(c))}),e.qZA(),e.TgZ(3,"label",30),e._UZ(4,"mat-icon",31),e.qZA()()}2&i&&(e.xp6(1),e.Q6J("multiple",!1)("accept","image/png, image/webp, image/jpeg, image/png"),e.xp6(3),e.Q6J("svgIcon","mat_solid:photo_camera"))}function Z(i,p){if(1&i){const a=e.EpF();e.TgZ(0,"div")(1,"button",32),e.NdJ("click",function(){e.CHM(a);const c=e.oxw(2);return e.KtG(c.removeImage())}),e._UZ(2,"mat-icon",33),e.qZA()()}2&i&&(e.xp6(2),e.Q6J("svgIcon","mat_solid:delete"))}function L(i,p){if(1&i&&e._UZ(0,"img",34),2&i){const a=e.oxw(2);e.Q6J("src",a.brandForm.get("logo").value,e.LSH)}}function U(i,p){if(1&i&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Descripci\xf3n"),e.qZA(),e.TgZ(12,"textarea",21),e._uU(13,"                                "),e.qZA()()(),e.TgZ(14,"div",22)(15,"span",23),e._uU(16,"Estado"),e.qZA(),e.TgZ(17,"mat-slide-toggle",24),e._uU(18),e.qZA()(),e.TgZ(19,"div",25)(20,"div",26),e.YNc(21,O,5,3,"div",6),e.YNc(22,Z,3,1,"div",6),e.qZA(),e.YNc(23,L,1,1,"img",27),e.qZA()()()()),2&i){const a=e.oxw();e.xp6(2),e.Q6J("formGroup",a.brandForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name")("placeholder","Nombre del Marca"),e.xp6(5),e.Q6J("matAutosizeMinRows",1)("formControlName","description"),e.xp6(5),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===a.brandForm.get("active").value?"Activo":"Inactivo"," "),e.xp6(3),e.Q6J("ngIf",!a.brandForm.get("logo").value),e.xp6(1),e.Q6J("ngIf",a.brandForm.get("logo").value),e.xp6(1),e.Q6J("ngIf",a.brandForm.get("logo").value)}}function w(i,p){if(1&i){const a=e.EpF();e.ynx(0),e.TgZ(1,"button",37),e.NdJ("click",function(){e.CHM(a);const c=e.oxw(2);return e.KtG(c.updateBrand())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&i){const a=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",a.brandForm.invalid)("matDialogClose","confirmed")}}function k(i,p){if(1&i){const a=e.EpF();e.ynx(0),e.TgZ(1,"button",38),e.NdJ("click",function(){e.CHM(a);const c=e.oxw(2);return e.KtG(c.createBrand())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&i){const a=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",a.brandForm.invalid)}}function F(i,p){if(1&i&&(e.ynx(0),e.TgZ(1,"div",35),e.ynx(2),e.TgZ(3,"button",36),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,w,3,3,"ng-container",6),e.YNc(6,k,3,2,"ng-container",6),e.qZA(),e.BQk()),2&i){const a=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===a.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===a.data.dialogMode)}}let J=(()=>{class i{constructor(a,d,c,g,A,W,Q,K,N){this.data=a,this._brandsService=d,this._changeDetectorRef=c,this._formBuilder=g,this._fuseConfirmationService=A,this._dialogRef=W,this._dialog=Q,this._imagesService=K,this._snackBar=N,this.dialogMode="view",this._unsubscribeAll=new D.x,this.dialogMode=a.dialogMode,this.brand=Object.assign({},a.brand)}ngOnInit(){this.brandForm=this._formBuilder.group({id:[null],name:[null,[s.kI.required,s.kI.minLength(3),s.kI.maxLength(255)]],description:[null,[s.kI.minLength(3),s.kI.maxLength(255)]],active:[],logo:[null]}),"edit"===this.dialogMode&&this.brandForm.patchValue(this.brand)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createBrand(){const a=this.brandForm.getRawValue();delete a.id,this._fuseConfirmationService.open({title:"Crear Marca",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,t.R)(this._unsubscribeAll)).subscribe(c=>{"confirmed"===c&&(this._brandsService.createBrand(a).pipe((0,t.R)(this._unsubscribeAll)).subscribe(g=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:g.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck(),this._dialogRef.close())})}updateBrand(){const a=this.brandForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar Marca",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:question_mark",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(c=>{"confirmed"===c&&this._brandsService.updateBrand(a).pipe((0,t.R)(this._unsubscribeAll)).subscribe(g=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:g.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}openCropperDialog(a){this._dialog.open(E.u,{data:{image:a},panelClass:"ath-dialog-panel",minWidth:"200px",maxWidth:"500px",maxHeight:"90vh",disableClose:!0}).afterClosed().subscribe(c=>{if(!l.W.IsNullOrEmpty(c)){if(c.size/1024/1024>1)return void this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Tama\xf1o demasiado grande. La imagen no debe superar a 1MB",title:"Confirmaci\xf3n",type:"error",svgIcon:"heroicons_solid:check"}});this._imagesService.uploadImage("List",c).pipe((0,t.R)(this._unsubscribeAll)).subscribe(g=>{this.brandForm.get("logo").setValue(g.imageUrl),this.brand.logo=g.imageUrl,"edit"===this.dialogMode?this._brandsService.updateBrand(this.brand).pipe((0,t.R)(this._unsubscribeAll)).subscribe(A=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:A.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()}):this._changeDetectorRef.markForCheck()},g=>{console.warn(g)})}})}removeImage(){const a=this.brandForm.get("logo").value;this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar la imagen?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,t.R)(this._unsubscribeAll)).subscribe(c=>{"confirmed"===c&&this._imagesService.removeImage(a).pipe((0,t.R)(this._unsubscribeAll)).subscribe(g=>{this.brandForm.get("logo").setValue(null),this.brand.logo=null,"edit"===this.dialogMode&&this._brandsService.updateBrand(this.brand).pipe((0,t.R)(this._unsubscribeAll)).subscribe(A=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:g.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})})}}return i.\u0275fac=function(a){return new(a||i)(e.Y36(u.WI),e.Y36(I.G),e.Y36(e.sBO),e.Y36(s.qu),e.Y36(h.R),e.Y36(u.so),e.Y36(u.uw),e.Y36(x.C),e.Y36(m.ux))},i.\u0275cmp=e.Xpm({type:i,selectors:[["lists-brand-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["matInput","","matTextareaAutosize","","maxlength","250",3,"matAutosizeMinRows","formControlName"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"relative","flex","items-center","justify-center","w-32","h-32","mt-8","overflow-hidden","bg-gray-200","rounded-md","dark:bg-gray-600","ring-4","ring-bg-card"],[1,"absolute","inset-0","z-20","flex","items-center","justify-center"],["class","object-contain w-full h-full",3,"src",4,"ngIf"],["id","thumbnail-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["thumbnailFileInput",""],["for","thumbnail-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"text-white",3,"svgIcon"],["mat-icon-button","",3,"click"],[1,"text-red-700",3,"svgIcon"],[1,"object-contain","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"],["mat-flat-button","",3,"color","disabled","click"]],template:function(a,d){1&a&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,B,2,0,"h2",2),e.YNc(4,R,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,P,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,U,24,12,"div",5),e.BQk(),e.qZA(),e.YNc(10,F,7,3,"ng-container",6),e.qZA()),2&a&&(e.xp6(3),e.Q6J("ngIf","add"===d.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===d.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===d.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===d.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==d.data.dialogMode))},dependencies:[o.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.nD,s.sg,s.u,r.lW,u.ZT,_.Hw,b.KE,b.hX,C.Nt,M.wG,y.Rr],encapsulation:2}),i})()},36538:(T,v,n)=>{n.d(v,{H:()=>s});class s{}},81042:(T,v,n)=>{n.d(v,{Z:()=>m});var s,u=new Uint8Array(16);function D(){if(!s&&!(s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(u)}const t=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,f=function E(o){return"string"==typeof o&&t.test(o)};for(var l=[],e=0;e<256;++e)l.push((e+256).toString(16).substr(1));const m=function x(o,r,_){var b=(o=o||{}).random||(o.rng||D)();if(b[6]=15&b[6]|64,b[8]=63&b[8]|128,r){_=_||0;for(var C=0;C<16;++C)r[_+C]=b[C];return r}return function I(o){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,_=(l[o[r+0]]+l[o[r+1]]+l[o[r+2]]+l[o[r+3]]+"-"+l[o[r+4]]+l[o[r+5]]+"-"+l[o[r+6]]+l[o[r+7]]+"-"+l[o[r+8]]+l[o[r+9]]+"-"+l[o[r+10]]+l[o[r+11]]+l[o[r+12]]+l[o[r+13]]+l[o[r+14]]+l[o[r+15]]).toLowerCase();if(!f(_))throw TypeError("Stringified UUID is invalid");return _}(b)}}}]);