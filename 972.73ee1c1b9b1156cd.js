"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[972],{91972:(ma,ae,l)=>{l.r(ae),l.d(ae,{CommercialModule:()=>la});var g=l(35357),se=l(17460),ce=l(8314),a=l(93075),Z=l(39646),I=l(77579),u=l(82722),E=l(17489),B=l(54787),X=l(22594),f=l(59784),U=l(2491),R=l(74062),le=l(33005),me=l(16911),e=l(5e3),F=l(71683),W=l(42834),q=l(57261),Ue=l(97231),x=l(85094),m=l(69808),w=l(29071),ee=l(90508),y=l(47423),de=l(77446),j=l(80288),C=l(25245),p=l(67322),Q=l(98833),ue=l(74107),pe=l(32368),O=l(87238);function Fe(o,i){1&o&&(e.TgZ(0,"div",4),e._UZ(1,"mat-icon",6),e.TgZ(2,"a",82),e._uU(3,"Nuevo"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_right"))}function Je(o,i){1&o&&(e.TgZ(0,"span"),e._uU(1,"Nuevo Producto o Servicio"),e.qZA())}function Pe(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("Informaci\xf3n de ",t.selectedProductService.name,"")}}const K=function(o){return{"cursor-not-allowed":o}};function De(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",83),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.createProductService())}),e._UZ(1,"mat-icon",84),e.TgZ(2,"span",85),e._uU(3,"Guardar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,K,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function Ne(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",83),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.updateProductService())}),e._UZ(1,"mat-icon",84),e.TgZ(2,"span",85),e._uU(3,"Actualizar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,K,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}function Ee(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar el tipo. "),e.qZA())}function Re(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio es obligatorio. "),e.qZA())}function Oe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio debe contener entre 3 y 255 caracteres. "),e.qZA())}function Ye(o,i){1&o&&(e.TgZ(0,"div",86)(1,"mat-label"),e._uU(2,"Estado"),e.qZA(),e.TgZ(3,"mat-slide-toggle",87),e._uU(4," Activo "),e.qZA()()),2&o&&(e.xp6(3),e.Q6J("color","primary")("formControlName","active"))}function Me(o,i){1&o&&(e.TgZ(0,"mat-panel-description"),e._uU(1," Ingrese una descripci\xf3n e informaci\xf3n detallada que le permita conocer al cliente las bondades el producto o sus m\xe9todos de empleo "),e.qZA())}function Le(o,i){1&o&&(e.TgZ(0,"mat-panel-description"),e._uU(1," Ingrese o conforme sus precios y disponibilidades "),e.qZA())}function Be(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",30),e._uU(2),e.qZA(),e.BQk()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.name," ")}}function We(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function je(o,i){if(1&o&&(e.TgZ(0,"mat-form-field",27)(1,"mat-label"),e._uU(2,"Unidad de Medida"),e.qZA(),e.TgZ(3,"mat-select",88),e.YNc(4,Be,3,2,"ng-container",67),e.qZA(),e.YNc(5,We,2,0,"mat-error",15),e.qZA()),2&o){const t=i.ngIf,n=e.oxw();e.xp6(3),e.Q6J("formControlName","uomId"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("uomId").hasError("required"))}}function ze(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe escoger la moneda. "),e.qZA())}function Ge(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio "),e.qZA())}function $e(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.productServiceForm.get("onSale").getError("invalid")," ")}}function Ve(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.productServiceForm.get("onSale").getError("onlyNumber")," ")}}function He(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo del producto es obligatorio. "),e.qZA())}function Ke(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe de ser mayor que 0. "),e.qZA())}function Xe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe contener solo n\xfameros. "),e.qZA())}function et(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El margen Gesti\xf3n Comercial del producto es obligatorio "),e.qZA())}function tt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 1000 "),e.qZA())}function ot(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo debe estar entre 0 y 1000"),e.qZA())}function nt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El impuesto del producto es obligatorio "),e.qZA())}function it(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function rt(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor debe este campo de estar entre 0 y 100"),e.qZA())}function at(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El descuento del producto es obligatorio "),e.qZA())}function st(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function ct(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo de estar entre 0 y 100"),e.qZA())}function lt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function mt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto debe ser mayor que 10 "),e.qZA())}function dt(o,i){if(1&o&&(e.TgZ(0,"div",89)(1,"mat-form-field",27)(2,"mat-label"),e._uU(3,"Costo"),e.qZA(),e.TgZ(4,"span",90),e._uU(5,"$"),e.qZA(),e._UZ(6,"input",91,92),e.YNc(8,He,2,0,"mat-error",15),e.YNc(9,Ke,2,0,"mat-error",15),e.YNc(10,Xe,2,0,"mat-error",15),e.qZA(),e.TgZ(11,"mat-form-field",27)(12,"mat-label"),e._uU(13,"Margen Gesti\xf3n Comercial"),e.qZA(),e.TgZ(14,"span",90),e._uU(15,"%"),e.qZA(),e._UZ(16,"input",93,94),e.YNc(18,et,2,0,"mat-error",15),e.YNc(19,tt,2,0,"mat-error",15),e.YNc(20,ot,2,0,"mat-hint",15),e.qZA(),e.TgZ(21,"mat-form-field",27)(22,"mat-label"),e._uU(23,"Impuesto"),e.qZA(),e.TgZ(24,"span",90),e._uU(25,"%"),e.qZA(),e._UZ(26,"input",95,96),e.YNc(28,nt,2,0,"mat-error",15),e.YNc(29,it,2,0,"mat-error",15),e.YNc(30,rt,2,0,"mat-hint",15),e.qZA(),e.TgZ(31,"mat-form-field",27)(32,"mat-label"),e._uU(33,"Descuento"),e.qZA(),e.TgZ(34,"span",90),e._uU(35,"%"),e.qZA(),e._UZ(36,"input",95,97),e.YNc(38,at,2,0,"mat-error",15),e.YNc(39,st,2,0,"mat-error",15),e.YNc(40,ct,2,0,"mat-hint",15),e.qZA(),e.TgZ(41,"mat-form-field",27)(42,"mat-label"),e._uU(43,"Precio"),e.qZA(),e.TgZ(44,"span",90),e._uU(45,"$"),e.qZA(),e._UZ(46,"input",98),e.YNc(47,lt,2,0,"mat-error",15),e.YNc(48,mt,2,0,"mat-error",15),e.qZA()()),2&o){const t=e.MAs(7),n=e.MAs(17),r=e.MAs(27),s=e.MAs(37),c=e.oxw();e.xp6(6),e.Q6J("formControlName","cost")("min",1)("placeholder","Costo del producto o servicio"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("min")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("pattern")),e.xp6(6),e.Q6J("formControlName","margin"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("min")||c.productServiceForm.get("margin").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").valid),e.xp6(6),e.Q6J("formControlName","taxPercent")("min",0)("max",100),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("min")||c.productServiceForm.get("taxPercent").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").valid),e.xp6(6),e.Q6J("formControlName","discount")("min",0)("max",100),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("min")||c.productServiceForm.get("discount").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").valid),e.xp6(6),e.Q6J("formControlName","price")("value",r.value/100*t.value-s.value/100*t.value+n.value/100*t.value+ +t.value),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("price").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("price").hasError("min"))}}function ut(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function pt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto debe ser mayor que 10 "),e.qZA())}function gt(o,i){if(1&o&&(e.TgZ(0,"mat-form-field",27)(1,"mat-label"),e._uU(2,"Precio"),e.qZA(),e.TgZ(3,"span",90),e._uU(4,"$"),e.qZA(),e._UZ(5,"input",99),e.YNc(6,ut,2,0,"mat-error",15),e.YNc(7,pt,2,0,"mat-error",15),e.qZA()),2&o){const t=e.oxw();e.xp6(5),e.Q6J("formControlName","price"),e.xp6(1),e.Q6J("ngIf",t.productServiceForm.get("price").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.productServiceForm.get("price").hasError("min"))}}function _t(o,i){1&o&&(e.TgZ(0,"mat-panel-description"),e._uU(1," Inserte im\xe1genes y videos desde YouTube al producto "),e.qZA())}function ft(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",100)(2,"div",101),e._UZ(3,"img",102),e.TgZ(4,"button",103),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.removeImage(s))}),e._UZ(5,"mat-icon",104),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(3),e.Q6J("alt","Product images")("src",t,e.LSH)}}function ht(o,i){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Identificador"),e.qZA())}function xt(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"Eje: TyZG7zkSHjc => https://youtube.com/watch?v=TyZG7zkSHjc"),e.qZA())}function vt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El identificador del video de YouTube no debe superar los 20 caracteres. "),e.qZA())}function bt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El identificador del video de YouTube es obligatorio. "),e.qZA())}function Zt(o,i){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Segundos iniciales"),e.qZA())}function yt(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"Segundos en los que empezar\xe1 la reproducci\xf3n"),e.qZA())}function Ct(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Solo se admiten n\xfameros. "),e.qZA())}function Tt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los segundos iniciales no deben superar los 10000 segundos. "),e.qZA())}function It(o,i){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Segundos finales"),e.qZA())}function qt(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"Segundos en los que terminar\xe1 la reproducci\xf3n"),e.qZA())}function At(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los segundos finales no deben superar los 10000 segundos. "),e.qZA())}function kt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los segundos finales no deben ser mayores que 0. "),e.qZA())}function wt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Solo se admiten n\xfameros. "),e.qZA())}const Qt=function(o){return{"mt:0 sm:mt-6":o}};function St(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",105)(2,"mat-form-field",106),e.YNc(3,ht,2,0,"mat-label",15),e._UZ(4,"input",107),e.YNc(5,xt,2,0,"mat-hint",15),e.YNc(6,vt,2,0,"mat-error",15),e.YNc(7,bt,2,0,"mat-error",15),e.qZA(),e.TgZ(8,"mat-form-field",108),e.YNc(9,Zt,2,0,"mat-label",15),e._UZ(10,"mat-icon",40),e.TgZ(11,"span",109),e._uU(12,"s"),e.qZA(),e._UZ(13,"input",110),e.YNc(14,yt,2,0,"mat-hint",15),e.YNc(15,Ct,2,0,"mat-error",15),e.YNc(16,Tt,2,0,"mat-error",15),e.qZA(),e.TgZ(17,"mat-form-field",108),e.YNc(18,It,2,0,"mat-label",15),e._UZ(19,"mat-icon",40),e.TgZ(20,"span",109),e._uU(21,"s"),e.qZA(),e._UZ(22,"input",110),e.YNc(23,qt,2,0,"mat-hint",15),e.YNc(24,At,2,0,"mat-error",15),e.YNc(25,kt,2,0,"mat-error",15),e.YNc(26,wt,2,0,"mat-error",15),e.qZA(),e.ynx(27),e.TgZ(28,"div",111)(29,"button",112),e.NdJ("click",function(){const s=e.CHM(t).index,c=e.oxw();return e.KtG(c.removeYouTubeVideosField(s))}),e._UZ(30,"mat-icon",78),e.qZA()(),e.BQk(),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit,n=i.first;e.xp6(3),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("formControl",t.get("videoId"))("placeholder","Identificador del video")("maxLength",20),e.xp6(1),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("ngIf",t.get("videoId").hasError("maxLength")),e.xp6(1),e.Q6J("ngIf",t.get("videoId").hasError("required")),e.xp6(2),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(3),e.Q6J("formControl",t.get("startSeconds"))("placeholder","Segundos en que empieza")("min",0)("max",1e4),e.xp6(1),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("ngIf",t.get("startSeconds").hasError("pattern")),e.xp6(1),e.Q6J("ngIf",t.get("startSeconds").hasError("max")),e.xp6(2),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(3),e.Q6J("formControl",t.get("endSeconds"))("placeholder","Segundos en el que termina")("min",1)("max",1e4),e.xp6(1),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("ngIf",t.get("endSeconds").hasError("max")),e.xp6(1),e.Q6J("ngIf",t.get("endSeconds").hasError("min")),e.xp6(1),e.Q6J("ngIf",t.get("endSeconds").hasError("pattern")),e.xp6(2),e.Q6J("ngClass",e.VKq(28,Qt,n)),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function Ut(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",83),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.createProductService())}),e._UZ(1,"mat-icon",84),e.TgZ(2,"span",85),e._uU(3,"Guardar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,K,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function Ft(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",83),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.updateProductService())}),e._UZ(1,"mat-icon",84),e.TgZ(2,"span",85),e._uU(3,"Actualizar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,K,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}const Jt=function(){return{height:"420px"}},ge=function(o){return{"h-auto":o}},Pt=function(o){return{hidden:o}};let Dt=(()=>{class o{constructor(t,n,r,s,c,d,_,h,H){this._activatedRoute=t,this._changeDetectorRef=n,this._router=r,this._formBuilder=s,this._fuseConfirmationService=c,this._productServicesService=d,this._snackBar=_,this._imagesService=h,this.store=H,this.user$=(0,Z.of)(null),this.uoms$=null,this.images=[],this.uploadingImage=!1,this.quillModules={toolbar:[[{font:[]}],[{color:[]}],[{align:[]}],["bold","italic","underline"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}]]},this._unsubscribeAll=new I.x}ngOnInit(){this.user$=this.store.select(B.rk),this.user$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(me.av),this.uoms$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.unidad=t.find(n=>"U"===n.abbr)}),this.store.select(X.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.store.select(le.YP).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.selectedProductService=t}),this.productServiceForm=this._formBuilder.group({_id:[""],active:[!0],uomId:[this.unidad?this.unidad._id:"",[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],type:["",[a.kI.required]],currency:[{value:"CUP",disabled:!1},[a.kI.required]],stock:[0,[a.kI.required,a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],onSale:[0,[a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],sku:["",[a.kI.maxLength(50)]],upc:["",[a.kI.maxLength(12)]],buildPrice:[!1],cost:[0,[]],margin:[0,[a.kI.min(0),a.kI.max(1e3),U.L.numbersAndDecimalsPattern()]],taxPercent:[0,[a.kI.min(0),a.kI.max(100),U.L.numbersAndDecimalsPattern()]],discount:[0,[a.kI.min(0),a.kI.max(100),U.L.numbersAndDecimalsPattern()]],price:[0,[a.kI.min(10),a.kI.required,a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],slug:[""],imageUrl:[""],locations:[[{state:this.currentMerchant.state,city:this.currentMerchant.city}]],images:[[]],youTubeVideos:this._formBuilder.array([]),description:["",[a.kI.maxLength(1e3)]],specifications:["",[a.kI.maxLength(1e4)]]},{validators:[U.L.checkOnSaleQty("stock","onSale"),U.L.onlyNumber("onSale")]}),this._activatedRoute.params.pipe((0,u.R)(this._unsubscribeAll)).subscribe(({goodsId:t})=>{this.windowsMode="new"===t?"new":"edit",this._fillProductServiceData(),this._changeDetectorRef.markForCheck()}),this.productServiceForm.get("images").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.images=t,this._changeDetectorRef.markForCheck()}),this.productServiceForm.get("buildPrice").valueChanges.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{if(!1===this.productServiceForm.get("buildPrice").value)this.productServiceForm.get("price").enable(),this.productServiceForm.get("cost").clearValidators(),this.productServiceForm.get("cost").setValue(this.selectedProductService?this.selectedProductService.cost:0);else{const n=this.productServiceForm.getRawValue();this.productServiceForm.get("price").setValue(n.cost+(n.taxPercent/100*n.cost-n.discount/100*n.cost+n.margin/100*n.cost)),this.productServiceForm.get("price").disable(),this.productServiceForm.get("cost").addValidators([a.kI.required,a.kI.min(1),U.L.numbersAndDecimalsPattern()])}this._changeDetectorRef.detectChanges(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addYouTubeVideos(){const t=this._formBuilder.group({videoId:["",[a.kI.required,a.kI.maxLength(20)]],startSeconds:[0,[a.kI.min(0),a.kI.max(1e4)]],endSeconds:[1,[a.kI.min(1),a.kI.max(1e4)]]});this.productServiceForm.get("youTubeVideos").push(t),this._changeDetectorRef.markForCheck()}removeYouTubeVideosField(t){this.productServiceForm.get("youTubeVideos").removeAt(t),this._changeDetectorRef.markForCheck()}createProductService(){let t=this.productServiceForm.getRawValue();!0===this.productServiceForm.get("buildPrice").value&&(t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost)),t=(0,E.omit)(t,"_id"),t.slug=new R.i(t.name).slug,this._fuseConfirmationService.open({title:`Crear ${t.type}`,message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.createProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._router.navigateByUrl("/modules/commercial/goods"),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updateProductService(){const t=this.productServiceForm.getRawValue();!0===this.productServiceForm.get("buildPrice").value&&(t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost)),t.slug=new R.i(t.name).slug,this._fuseConfirmationService.open({title:`Actualizar ${t.type}`,message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.updateProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._router.navigateByUrl("/modules/commercial/goods"),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}uploadImage(t){if(!t.length)return;const r=t[0];r.size/1024/1024>1?this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Tama\xf1o demasiado grande. La imagen no debe superar a 1MB",title:"Confirmaci\xf3n",type:"error",svgIcon:"heroicons_solid:check"}}):!["image/jpeg","image/jpg","image/webp","image/png"].includes(r.type)||(this.uploadingImage=!0,this._imagesService.uploadImage("Comercial",r).subscribe(s=>{this.uploadingImage=!1,this._changeDetectorRef.markForCheck();const c=[...this.productServiceForm.get("images").value,s.imageUrl];if(this.productServiceForm.get("images").setValue(c),this.selectedProductService){const d=Object.assign(Object.assign({},E.omit(Object.assign({},this.selectedProductService),["merchantId","uomId","createdAt","updatedAt","images"])),{merchantId:this.selectedProductService.merchantId._id,uomId:this.selectedProductService.uomId._id,images:c});"edit"===this.windowsMode&&this._productServicesService.updateProductService(d).subscribe(()=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}})})}},s=>{this.uploadingImage=!1,this._changeDetectorRef.markForCheck(),console.warn(s)}))}removeImage(t){void 0!==t&&this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta imagen?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(r=>{"confirmed"===r&&this._imagesService.removeImage(t).subscribe(c=>{const d=[...this.productServiceForm.get("images").value],_=d.findIndex(h=>h===t);if(d.splice(_,1),this.productServiceForm.get("images").setValue(d),"edit"===this.windowsMode&&this.selectedProductService){const h=Object.assign(Object.assign({},E.omit(Object.assign({},this.selectedProductService),["merchantId","uomId","createdAt","updatedAt","images"])),{merchantId:this.selectedProductService.merchantId._id,uomId:this.selectedProductService.uomId._id,images:d});this._productServicesService.updateProductService(h).subscribe(()=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}})})}})})}trackByFn(t,n){return n.id||t}_fillProductServiceData(){if("edit"===this.windowsMode){this.productServiceForm.patchValue(this.selectedProductService),this.images=this.selectedProductService.images,this.productServiceForm.get("locations").setValue([{state:this.currentMerchant.state,city:this.currentMerchant.city}]),this.productServiceForm.get("merchantId").setValue(this.selectedProductService.merchantId._id),void 0!==this.selectedProductService&&this.productServiceForm.get("uomId").setValue(this.selectedProductService.uomId._id),this.selectedProductService.buildPrice&&this.productServiceForm.get("price").enable(),this.productServiceForm.get("youTubeVideos").clear();const t=[];this.selectedProductService.youTubeVideos.length>0&&this.selectedProductService.youTubeVideos.forEach(n=>{t.push(this._formBuilder.group({videoId:[n.videoId,[a.kI.required,a.kI.maxLength(20)]],startSeconds:[n.startSeconds,[a.kI.min(0),a.kI.max(1e4),U.L.onlyNumbersPattern()]],endSeconds:[n.endSeconds,[a.kI.min(1),a.kI.max(1e4),U.L.onlyNumbersPattern()]]}))}),t.forEach(n=>{this.productServiceForm.get("youTubeVideos").push(n)})}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz),e.Y36(e.sBO),e.Y36(g.F0),e.Y36(a.qu),e.Y36(F.R),e.Y36(W.z),e.Y36(q.ux),e.Y36(Ue.C),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["goods-detail"]],decls:170,vars:75,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],["routerLink","/modules/commercial/goods",1,"ml-1","text-primary-500","hover:underline"],["class","flex items-center ml-1 whitespace-nowrap",4,"ngIf"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[4,"ngIf"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["class","ml-4 text-white bg-primary-500 hover:bg-primary-700 hover:shadow-lg","mat-raised-button","",3,"disabled","ngClass","click",4,"ngIf"],[1,"flex-auto","p-4","sm:p-6"],[1,"flex","flex-col","flex-auto","min-w-0"],[3,"formGroup","autocomplete"],["multi","",1,"w-full","bg-transparent"],[3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"grid","w-full","pt-8","pb-8","pl-4","pr-4","border-t-2","sm:grid-cols-2","gap-y-3","gap-x-6"],[1,"sm:col-span-1"],[1,"w-full"],["required","",3,"formControlName"],[3,"value"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],["matInput","","type","text","maxlength","12",3,"formControlName"],["matInput","","type","text","maxlength","50",3,"formControlName"],["class","flex flex-col sm:col-span-1 ",4,"ngIf"],["dsPanel",""],["expandedHeight","56px !important",1,"h-32","min-h-14","sm:h-28","md:h-24","lg:h-14"],[1,"flex","flex-wrap","py-4"],[1,"sm:col-span-2"],[1,"flex-auto","w-full","fuse-mat-textarea"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],["desc",""],[1,"text-right"],[1,"mb-1",2,"font-weight","500","color","rgba(var(--fuse-text-default-rgb), var(--tw-text-opacity)) !important"],[1,"w-full",3,"styles","formControlName","modules"],[1,"w-full","text-sm","text-right"],["mValues",""],[1,"h-20","min-h-14","sm:h-auto",3,"ngClass"],[1,"flex","flex-wrap"],[1,"grid","w-full","pt-8","pb-8","pl-4","pr-4","border-t-2","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-y-3","gap-x-6"],["class","sm:col-span-1",4,"ngIf"],["value","CUP"],["value","MLC"],["value","USD"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","","type","number","min","0","max","999999999","maxlength","50","required","",3,"formControlName"],["matInput","","type","number","min","0","max","999999999","maxlength","50",3,"formControlName"],[1,"sm:col-span-2","md:col-span-3","lg:col-span-4",3,"color","formControlName"],["class","grid w-full mt-1 sm:col-span-2 md:col-span-3 lg:col-span-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-y-3 gap-x-6",4,"ngIf"],["mContent",""],[1,"w-full","px-2","pt-8","pb-8","space-y-4","border-t-2","sm:px-4"],[1,"flex","flex-col"],[1,"text-gray-400"],[1,"px-2","pt-4","pb-1","border-t-2","sm:pb-2","sm:pt-6","sm:px-4"],[1,"flex","flex-row","flex-wrap","w-full"],[1,"flex","flex-row","flex-wrap"],[4,"ngFor","ngForOf"],[1,"mt-3","w-26","h-26"],["id","image-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"disabled","multiple","accept","change"],["imageFileInput",""],["for","image-file-input","matRipple",""],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","transition-all","duration-100","ease-linear","border","border-gray-300","rounded-lg","cursor-pointer","w-26","h-26","hover:bg-hover"],[1,"flex","flex-col","items-center","justify-center","h-full"],[1,"font-thin","icon-size-10",3,"svgIcon"],[1,"px-2","pt-4","border-t-2","sm:pt-6","sm:px-4"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inline-flex","items-center","px-4","pt-2","mt-2","-ml-4","rounded","cursor-pointer","group",3,"ngClass","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"flex","flex-col","flex-wrap","justify-end","px-6","pb-10","sm:flex-row","flex-0","sm:items-center","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex","items-center","flex-shrink-0","mt-6","text-right","sm:mt-0","sm:ml-4"],[1,"ml-1","text-primary-500"],["mat-raised-button","",1,"ml-4","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"disabled","ngClass","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-col","sm:col-span-1"],["value","true",1,"pt-4","mb-2",3,"color","formControlName"],[3,"formControlName"],[1,"grid","w-full","mt-1","sm:col-span-2","md:col-span-3","lg:col-span-4","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-y-3","gap-x-6"],["matPrefix",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","min","placeholder"],["costoField",""],["matInput","","type","number","step","1","min","0","max","1000","maxlength","9","required","",3,"formControlName"],["margenField",""],["type","number","matInput","","step","1","required","",3,"formControlName","min","max"],["impuestoField",""],["descuentoField",""],["matInput","","type","number","min","10","max","999999999","maxlength","9","required","",3,"formControlName","value"],["matInput","","type","number","min","10","max","999999999","maxlength","9","required","",3,"formControlName"],[1,"flex","items-center","mt-3"],[1,"relative","flex","items-center","justify-center","mr-6","overflow-hidden","border","rounded","w-26","h-26","flex-0"],[3,"alt","src"],["mat-mini-fab","",1,"absolute","p-5","transition-opacity","ease-linear","delay-200","rounded-full","opacity-50","bg-primary-500","hover:opacity-100",3,"click"],["svgIcon","heroicons_solid:trash",1,"text-white","icon-size-5"],[1,"relative","flex","flex-col","sm:flex-wrap","sm:flex-row"],[1,"flex-auto","w-full","mt-1","sm:mt-0","sm:max-w-60","sm:ml-4"],["matInput","","required","",3,"formControl","placeholder","maxLength"],[1,"flex-auto","w-full","mt-1","sm:mt-0","sm:max-w-50","sm:ml-4"],["matSuffix","",1,"ml-1"],["type","number","matInput","",3,"formControl","placeholder","min","max"],[1,"flex","items-center","w-10","pl-2",3,"ngClass"],["mat-icon-button","","matTooltip","Eliminar video",1,"w-8","h-8","min-h-8",3,"click"]],template:function(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Productos y Servicios"),e.qZA()(),e.YNc(16,Fe,4,1,"div",9),e.qZA(),e.TgZ(17,"div",10)(18,"a",11),e._UZ(19,"mat-icon",6),e.TgZ(20,"span",12),e._uU(21,"Regresar"),e.qZA()()()(),e.TgZ(22,"div",13)(23,"div",14),e.YNc(24,Je,2,0,"span",15),e.YNc(25,Pe,2,1,"span",15),e.qZA()()(),e.TgZ(26,"div",16),e.YNc(27,De,4,5,"button",17),e.YNc(28,Ne,4,5,"button",17),e.qZA()(),e.TgZ(29,"div",18)(30,"div",19)(31,"form",20)(32,"mat-accordion",21)(33,"mat-expansion-panel",22)(34,"mat-expansion-panel-header",23)(35,"mat-panel-title",24)(36,"div",25),e._uU(37," Informaci\xf3n General "),e.qZA()()(),e.TgZ(38,"div",26)(39,"div",27)(40,"mat-form-field",28)(41,"mat-label"),e._uU(42,"Tipo"),e.qZA(),e.TgZ(43,"mat-select",29)(44,"mat-option",30),e._uU(45," Producto "),e.qZA(),e.TgZ(46,"mat-option",30),e._uU(47," Servicio "),e.qZA()(),e.YNc(48,Ee,2,0,"mat-error",15),e.TgZ(49,"mat-hint"),e._uU(50,"Especifique si es un producto o servicio"),e.qZA()()(),e.TgZ(51,"div",27)(52,"mat-form-field",28)(53,"mat-label"),e._uU(54,"Nombre"),e.qZA(),e._UZ(55,"input",31),e.YNc(56,Re,2,0,"mat-error",15),e.YNc(57,Oe,2,0,"mat-error",15),e.qZA()(),e.TgZ(58,"div",27)(59,"mat-form-field",28)(60,"mat-label"),e._uU(61,"UPC"),e.qZA(),e._UZ(62,"input",32),e.qZA()(),e.TgZ(63,"div",27)(64,"mat-form-field",28)(65,"mat-label"),e._uU(66,"SKU"),e.qZA(),e._UZ(67,"input",33),e.qZA()(),e.YNc(68,Ye,5,2,"div",34),e.qZA()(),e.TgZ(69,"mat-expansion-panel",null,35)(71,"mat-expansion-panel-header",36)(72,"div",37)(73,"mat-panel-title",24)(74,"div",25),e._uU(75," Especificaciones "),e.qZA()(),e.YNc(76,Me,2,0,"mat-panel-description",15),e.qZA()(),e.TgZ(77,"div",26)(78,"div",38)(79,"mat-form-field",39)(80,"mat-label"),e._uU(81,"Descripci\xf3n"),e.qZA(),e._UZ(82,"mat-icon",40)(83,"textarea",41,42),e.TgZ(85,"mat-hint",43),e._uU(86),e.qZA()()(),e.TgZ(87,"div",38)(88,"div",44),e._uU(89,"Especificaciones"),e.qZA(),e._UZ(90,"quill-editor",45),e.TgZ(91,"div",46),e._uU(92),e.qZA()()()(),e.TgZ(93,"mat-expansion-panel",null,47)(95,"mat-expansion-panel-header",48)(96,"div",49)(97,"mat-panel-title",24)(98,"div",25),e._uU(99," Valores "),e.qZA()(),e.YNc(100,Le,2,0,"mat-panel-description",15),e.qZA()(),e.TgZ(101,"div",50),e.YNc(102,je,6,3,"mat-form-field",51),e.ALo(103,"async"),e.TgZ(104,"div",27)(105,"mat-form-field",28)(106,"mat-label"),e._uU(107,"Moneda"),e.qZA(),e.TgZ(108,"mat-select",29)(109,"mat-option",52),e._uU(110,"CUP"),e.qZA(),e.TgZ(111,"mat-option",53),e._uU(112,"MLC"),e.qZA(),e.TgZ(113,"mat-option",54),e._uU(114,"USD"),e.qZA()(),e._UZ(115,"mat-icon",55),e.YNc(116,ze,2,0,"mat-error",15),e.qZA()(),e.TgZ(117,"div",27)(118,"mat-form-field",28)(119,"mat-label"),e._uU(120,"Cantidad"),e.qZA(),e._UZ(121,"input",56),e.YNc(122,Ge,2,0,"mat-error",15),e.qZA()(),e.TgZ(123,"div",27)(124,"mat-form-field",28)(125,"mat-label"),e._uU(126,"En Venta"),e.qZA(),e._UZ(127,"input",57),e.YNc(128,$e,2,1,"mat-error",15),e.YNc(129,Ve,2,1,"mat-error",15),e.qZA()(),e.TgZ(130,"mat-checkbox",58),e._uU(131," Conformar precio "),e.qZA(),e.YNc(132,dt,49,26,"div",59),e.YNc(133,gt,8,3,"mat-form-field",51),e.qZA()(),e.TgZ(134,"mat-expansion-panel",null,60)(136,"mat-expansion-panel-header",48)(137,"div",49)(138,"mat-panel-title",24)(139,"div",25),e._uU(140," Contenido Multimedia "),e.qZA()(),e.YNc(141,_t,2,0,"mat-panel-description",15),e.qZA()(),e.TgZ(142,"div",61)(143,"div",62)(144,"span",63),e._uU(145,"Im\xe1genes"),e.qZA(),e.TgZ(146,"div",64)(147,"div",65)(148,"div",66),e.YNc(149,ft,6,2,"ng-container",67),e.TgZ(150,"div",68)(151,"input",69,70),e.NdJ("change",function(){e.CHM(r);const c=e.MAs(152);return e.KtG(n.uploadImage(c.files))}),e.qZA(),e.TgZ(153,"label",71)(154,"div",72)(155,"div",73),e._UZ(156,"mat-icon",74),e.qZA()()()()()()()(),e.TgZ(157,"div",62)(158,"span",63),e._uU(159,"Videos desde YouTube"),e.qZA(),e.TgZ(160,"div",75),e.YNc(161,St,31,30,"ng-container",76),e.TgZ(162,"div",77),e.NdJ("click",function(){return n.addYouTubeVideos()}),e._UZ(163,"mat-icon",78),e.TgZ(164,"span",79),e._uU(165,"Agregar video"),e.qZA()()()()()()()()()(),e.TgZ(166,"div",80)(167,"div",81),e.YNc(168,Ut,4,5,"button",17),e.YNc(169,Ft,4,5,"button",17),e.qZA()()()}if(2&t){const r=e.MAs(70),s=e.MAs(84),c=e.MAs(94),d=e.MAs(135);e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(3),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(5),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","edit"===n.windowsMode&&n.selectedProductService),e.xp6(2),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","new"!==n.windowsMode),e.xp6(3),e.Q6J("formGroup",n.productServiceForm)("autocomplete","off"),e.xp6(2),e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(9),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","Producto"),e.xp6(2),e.Q6J("value","Servicio"),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("type").hasError("required")),e.xp6(7),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del producto o servicio"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("name").hasError("maxlength")||n.productServiceForm.get("name").hasError("minlength")),e.xp6(5),e.Q6J("formControlName","upc"),e.xp6(5),e.Q6J("formControlName","sku"),e.xp6(1),e.Q6J("ngIf",!1===n.productServiceForm.get("buildPrice").value),e.xp6(8),e.Q6J("ngIf",!r.expanded),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.xp6(3),e.hij("Total de caracteres ",s.value.length," / 1000"),e.xp6(4),e.Q6J("styles",e.DdM(68,Jt))("formControlName","specifications")("modules",n.quillModules),e.xp6(2),e.hij(" Total de caracteres ",""===n.productServiceForm.get("specifications").value?0:n.productServiceForm.get("specifications").value.length-8," / 10000"),e.xp6(3),e.Q6J("ngClass",e.VKq(69,ge,c.expanded)),e.xp6(5),e.Q6J("ngIf",!c.expanded),e.xp6(2),e.Q6J("ngIf",e.lcZ(103,66,n.uoms$)),e.xp6(6),e.Q6J("formControlName","currency"),e.xp6(7),e.Q6J("svgIcon","heroicons_solid:cash"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("currency").hasError("required")),e.xp6(5),e.Q6J("formControlName","stock"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("stock").hasError("required")),e.xp6(5),e.Q6J("formControlName","onSale"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("onSale").hasError("invalid")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("onSale").hasError("invalid")),e.xp6(1),e.Q6J("color","primary")("formControlName","buildPrice"),e.xp6(2),e.Q6J("ngIf",!0===n.productServiceForm.get("buildPrice").value),e.xp6(1),e.Q6J("ngIf",!1===n.productServiceForm.get("buildPrice").value),e.xp6(3),e.Q6J("ngClass",e.VKq(71,ge,d.expanded)),e.xp6(5),e.Q6J("ngIf",!d.expanded),e.xp6(8),e.Q6J("ngForOf",n.images),e.xp6(2),e.Q6J("disabled",n.uploadingImage)("multiple",!1)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngForOf",n.productServiceForm.get("youTubeVideos").controls)("ngForTrackBy",n.trackByFn),e.xp6(1),e.Q6J("ngClass",e.VKq(73,Pt,n.productServiceForm.get("youTubeVideos").getRawValue().length>=3)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:plus-circle"),e.xp6(5),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","new"!==n.windowsMode)}},dependencies:[g.yS,m.mk,m.sg,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.qQ,a.Fd,a.oH,a.sg,a.u,w.PQ,ee.ey,y.lW,de.oG,j.pp,j.ib,j.yz,j.yK,j.u4,C.Hw,p.TO,p.KE,p.bx,p.hX,p.qo,p.R9,Q.Nt,ee.wG,ue.gD,pe.Rr,O.gM,ce.g6,m.Ov],encapsulation:2,changeDetection:0}),o})();var A=l(86087),v=l(84847),Y=l(56451),J=l(78372),z=l(68675),b=l(63900),S=l(54004),P=l(63844);class Nt{}var D=l(86428),k=l(48966),_e=l(89116);function Et(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Agregar producto o servicio"),e.qZA())}function Rt(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Editar producto o servicio"),e.qZA())}function Ot(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Detalles del producto o servicio"),e.qZA())}function Yt(o,i){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11),e.ynx(4),e.TgZ(5,"div",12)(6,"mat-label",13),e._uU(7,"Nombre"),e.qZA(),e.TgZ(8,"div",14),e._uU(9),e.qZA()(),e.BQk(),e.ynx(10),e.TgZ(11,"div",12)(12,"mat-label",13),e._uU(13,"Descripci\xf3n"),e.qZA(),e.TgZ(14,"div",14),e._uU(15),e.qZA()(),e.BQk(),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(9),e.Oqu(t.data.productService.name),e.xp6(6),e.Oqu(t.data.productService.description)}}function Mt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar el tipo. "),e.qZA())}function Lt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio es obligatorio. "),e.qZA())}function Bt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio debe contener entre 3 y 255 caracteres. "),e.qZA())}function Wt(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",21),e._uU(2),e.qZA(),e.BQk()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.abbr," ")}}function jt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function zt(o,i){if(1&o&&(e.TgZ(0,"mat-form-field",18)(1,"mat-label"),e._uU(2,"Unidad de Medida"),e.qZA(),e.TgZ(3,"mat-select",44),e.YNc(4,Wt,3,2,"ng-container",45),e.qZA(),e.YNc(5,jt,2,0,"mat-error",6),e.qZA()),2&o){const t=i.ngIf,n=e.oxw(2);e.xp6(3),e.Q6J("formControlName","uomId"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("uomId").hasError("required"))}}function Gt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe escoger la moneda. "),e.qZA())}function $t(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo del producto es obligatorio. "),e.qZA())}function Vt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe de ser mayor que 0. "),e.qZA())}function Ht(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe contener solo n\xfameros. "),e.qZA())}function Kt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El margen Gesti\xf3n Comercial del producto es obligatorio "),e.qZA())}function Xt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 1000 "),e.qZA())}function eo(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo debe estar entre 0 y 1000"),e.qZA())}function to(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El impuesto del producto es obligatorio "),e.qZA())}function oo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 15 "),e.qZA())}function no(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor debe este campo de estar entre 0 y 15"),e.qZA())}function io(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El descuento del producto es obligatorio "),e.qZA())}function ro(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 50 "),e.qZA())}function ao(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo de estar entre 0 y 50"),e.qZA())}function so(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function co(o,i){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Tipo"),e.qZA(),e.TgZ(7,"mat-select",20)(8,"mat-option",21),e._uU(9," Producto "),e.qZA(),e.TgZ(10,"mat-option",21),e._uU(11," Servicio "),e.qZA()(),e.YNc(12,Mt,2,0,"mat-error",6),e.TgZ(13,"mat-hint"),e._uU(14,"Especifique si es producto o servicio"),e.qZA()()(),e.TgZ(15,"div",18)(16,"mat-form-field",19)(17,"mat-label"),e._uU(18,"Nombre"),e.qZA(),e._UZ(19,"input",22),e.YNc(20,Lt,2,0,"mat-error",6),e.YNc(21,Bt,2,0,"mat-error",6),e.qZA()(),e.YNc(22,zt,6,3,"mat-form-field",23),e.ALo(23,"async"),e.TgZ(24,"div",18)(25,"mat-form-field",19)(26,"mat-label"),e._uU(27,"Moneda por defecto"),e.qZA(),e.TgZ(28,"mat-select",20)(29,"mat-option",24),e._uU(30,"CUP"),e.qZA(),e.TgZ(31,"mat-option",25),e._uU(32,"MLC"),e.qZA(),e.TgZ(33,"mat-option",26),e._uU(34,"USD"),e.qZA()(),e._UZ(35,"mat-icon",27),e.YNc(36,Gt,2,0,"mat-error",6),e.qZA()(),e.TgZ(37,"mat-form-field",18)(38,"mat-label"),e._uU(39,"Costo"),e.qZA(),e.TgZ(40,"span",28),e._uU(41,"$"),e.qZA(),e._UZ(42,"input",29,30),e.YNc(44,$t,2,0,"mat-error",6),e.YNc(45,Vt,2,0,"mat-error",6),e.YNc(46,Ht,2,0,"mat-error",6),e.qZA(),e.TgZ(47,"mat-form-field",18)(48,"mat-label"),e._uU(49,"Margen Gesti\xf3n Comercial"),e.qZA(),e.TgZ(50,"span",28),e._uU(51,"%"),e.qZA(),e._UZ(52,"input",31,32),e.YNc(54,Kt,2,0,"mat-error",6),e.YNc(55,Xt,2,0,"mat-error",6),e.YNc(56,eo,2,0,"mat-hint",6),e.qZA(),e.TgZ(57,"mat-form-field",18)(58,"mat-label"),e._uU(59,"Impuesto"),e.qZA(),e.TgZ(60,"span",28),e._uU(61,"%"),e.qZA(),e._UZ(62,"input",33,34),e.YNc(64,to,2,0,"mat-error",6),e.YNc(65,oo,2,0,"mat-error",6),e.YNc(66,no,2,0,"mat-hint",6),e.qZA(),e.TgZ(67,"mat-form-field",18)(68,"mat-label"),e._uU(69,"Descuento"),e.qZA(),e.TgZ(70,"span",28),e._uU(71,"%"),e.qZA(),e._UZ(72,"input",35,36),e.YNc(74,io,2,0,"mat-error",6),e.YNc(75,ro,2,0,"mat-error",6),e.YNc(76,ao,2,0,"mat-hint",6),e.qZA(),e.TgZ(77,"mat-form-field",18)(78,"mat-label"),e._uU(79,"Precio"),e.qZA(),e.TgZ(80,"span",28),e._uU(81,"$"),e.qZA(),e._UZ(82,"input",37),e.YNc(83,so,2,0,"mat-error",6),e.qZA(),e.TgZ(84,"div",38)(85,"mat-label"),e._uU(86,"Estado"),e.qZA(),e.TgZ(87,"mat-slide-toggle",39),e._uU(88," Activo "),e.qZA()(),e.TgZ(89,"div",40)(90,"mat-form-field",41)(91,"mat-label"),e._uU(92,"Descripci\xf3n"),e.qZA(),e._UZ(93,"mat-icon",42)(94,"textarea",43),e.qZA()()()()()),2&o){const t=e.MAs(43),n=e.MAs(53),r=e.MAs(63),s=e.MAs(73),c=e.oxw();e.xp6(2),e.Q6J("formGroup",c.productServiceForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","Producto"),e.xp6(2),e.Q6J("value","Servicio"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("type").hasError("required")),e.xp6(7),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del producto o servicio"),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("name").hasError("maxlength")||c.productServiceForm.get("name").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",e.lcZ(23,46,c.uoms$)),e.xp6(6),e.Q6J("formControlName","currency"),e.xp6(7),e.Q6J("svgIcon","heroicons_solid:cash"),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("currency").hasError("required")),e.xp6(6),e.Q6J("formControlName","cost")("min",1)("placeholder","Costo del producto o servicio"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("min")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("pattern")),e.xp6(6),e.Q6J("formControlName","margin"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("min")||c.productServiceForm.get("margin").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").valid),e.xp6(6),e.Q6J("formControlName","taxPercent"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("min")||c.productServiceForm.get("taxPercent").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").valid),e.xp6(6),e.Q6J("formControlName","discount"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("min")||c.productServiceForm.get("discount").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").valid),e.xp6(6),e.Q6J("formControlName","price")("value",r.value/100*t.value-s.value/100*t.value+n.value/100*t.value+ +t.value),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("price").hasError("required")),e.xp6(4),e.Q6J("value",!0)("color","primary")("formControlName","active"),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3)}}const fe=function(o){return{"cursor-not-allowed":o}};function lo(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.updateProductService())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(4,fe,t.productServiceForm.invalid))}}function mo(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.createProductService())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(4,fe,t.productServiceForm.invalid))}}function uo(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",46),e.ynx(2),e.TgZ(3,"button",47),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,lo,3,6,"ng-container",6),e.YNc(6,mo,3,6,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let po=(()=>{class o{constructor(t,n,r,s,c,d,_,h){this.data=t,this._activatedRoute=n,this._changeDetectorRef=r,this._formBuilder=s,this._fuseConfirmationService=c,this._productServicesService=d,this._snackBar=_,this.store=h,this.dialogMode="view",this.user$=(0,Z.of)(null),this.uoms$=null,this._unsubscribeAll=new I.x}ngOnInit(){this.user$=this.store.select(B.rk),this.user$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(me.av),this.uoms$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.unidad=t.find(n=>"U"===n.abbr)}),this.store.select(X.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.productServiceForm=this._formBuilder.group({_id:[""],active:[!0],uomId:[this.unidad?this.unidad.id:"",[a.kI.required]],merchantId:[this.currentMerchant.id,[a.kI.required]],userId:[this.user.id,[a.kI.required]],type:["",[a.kI.required]],currency:[{value:"CUP",disabled:!1},[a.kI.required]],cost:[0,[a.kI.required,a.kI.min(1),U.L.onlyNumbersPattern()]],margin:[0,[a.kI.min(0),a.kI.max(1e3)]],taxPercent:[0,[a.kI.min(0),a.kI.max(15)]],discount:[0,[a.kI.min(0),a.kI.max(50)]],price:[{disabled:!0,value:0},[a.kI.required,a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],slug:[""],description:["",[a.kI.maxLength(1e3)]]}),"edit"===this.data.dialogMode&&(this.productServiceForm.patchValue(this.data.productService),this.productServiceForm.get("merchantId").setValue(this.data.productService.merchantId._id),void 0!==this.data.productService.uomId&&this.productServiceForm.get("uomId").setValue(this.data.productService.uomId._id))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){let t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t=(0,_e.Z)(t,"_id"),t.slug=new R.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.createProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updateProductService(){const t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t.slug=new R.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.updateProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(k.WI),e.Y36(g.gz),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(F.R),e.Y36(W.z),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["goods-dialog"]],decls:12,vars:6,consts:[[1,"relative","flex","flex-col","w-full","h-full","overflow-y-auto"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"flex","sm:items-center"],[1,"min-w-56","font-semibold"],[1,"leading-6"],[1,"w-full","overflow-hidden"],[1,"pt-5"],[1,"grid","grid-cols-2","gap-y-3","gap-x-4","w-full","mt-1",3,"formGroup","autocomplete"],[1,"col-span-2","sm:col-span-1"],[1,"w-full"],["required","",3,"formControlName"],[3,"value"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],["class","col-span-2 sm:col-span-1",4,"ngIf"],["value","CUP"],["value","MLC"],["value","USD"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matPrefix",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","min","placeholder"],["costoField",""],["matInput","","type","number","step","1","min","0","max","1000","maxlength","9","required","",3,"formControlName"],["margenField",""],["type","number","matInput","","step","1","min","0","max","15","maxlength","9","required","",3,"formControlName"],["impuestoField",""],["type","number","matInput","","step","1","min","0","max","50","maxlength","9","required","",3,"formControlName"],["descuentoField",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","value"],[1,"col-span-2","sm:col-span-1","flex","flex-col"],[1,"pt-4","mb-2",3,"value","color","formControlName"],[1,"col-span-2","pt-4","sm:col-span-2"],[1,"w-full","fuse-mat-textarea","flex-auto"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","matDialogClose","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Et,2,0,"h2",2),e.YNc(4,Rt,2,0,"h2",2),e.YNc(5,Ot,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(6,"div",3),e.ynx(7),e.YNc(8,Yt,16,2,"div",4),e.BQk(),e.ynx(9),e.YNc(10,co,95,48,"div",5),e.BQk(),e.qZA(),e.YNc(11,uo,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",null===n.data.productService._id&&"add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.productService._id&&"edit"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.productService._id&&"view"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},encapsulation:2,changeDetection:0}),o})();var G=l(1235);const go=function(){return["new"]};function _o(o,i){if(1&o&&(e.TgZ(0,"div",19)(1,"mat-form-field",20),e._UZ(2,"mat-icon",21)(3,"input",22),e.qZA(),e.TgZ(4,"button",23),e._UZ(5,"mat-icon",24),e.TgZ(6,"span",25),e._uU(7,"Nuevo"),e.qZA()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Buscar productos o servicios"),e.xp6(1),e.Q6J("routerLink",e.DdM(6,go)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:plus")}}function fo(o,i){if(1&o&&e._UZ(0,"img",49),2&o){const t=e.oxw().$implicit;e.Q6J("alt","Product thumbnail image")("src",t.images[0],e.LSH)}}function ho(o,i){1&o&&(e.TgZ(0,"div",50),e._uU(1," Sin imagen "),e.qZA())}function xo(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",51),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function vo(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",52),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}const bo=function(){return[" "]},Zo=function(o){return[o]};function yo(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"div",37)(3,"div",38),e.YNc(4,fo,1,2,"img",39),e.YNc(5,ho,2,0,"div",40),e.qZA()(),e.TgZ(6,"div",41),e._uU(7),e.qZA(),e.TgZ(8,"div",41),e._uU(9),e.qZA(),e.TgZ(10,"div",42),e._uU(11),e.qZA(),e.TgZ(12,"div",43),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.TgZ(15,"div",44),e.YNc(16,xo,2,1,"ng-container",17),e.YNc(17,vo,2,1,"ng-container",17),e.qZA(),e.TgZ(18,"div",45)(19,"button",46),e._UZ(20,"mat-icon",47),e.qZA(),e.TgZ(21,"button",48),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteProductService(s))}),e._UZ(22,"mat-icon",47),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(4),e.Q6J("ngIf",t.images&&t.images.length>0&&t.images[0]),e.xp6(1),e.Q6J("ngIf",!(t.images&&t.images.length>0&&t.images[0])),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.type," "),e.xp6(2),e.hij(" ",t.uomId.name," "),e.xp6(2),e.AsE(" ",e.xi3(14,12,t.price,e.DdM(15,bo))," ",t.currency," "),e.xp6(3),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(2),e.Q6J("routerLink",e.VKq(16,Zo,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function Co(o,i){if(1&o&&(e.ynx(0),e.YNc(1,yo,23,18,"ng-container",35),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const To=function(o){return{"pointer-events-none":o}},Io=function(){return[10,25,50,100]};function qo(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",27)(2,"div",28),e._UZ(3,"div"),e.TgZ(4,"div",29),e._uU(5," Nombre "),e.qZA(),e.TgZ(6,"div",29),e._uU(7," Tipo "),e.qZA(),e.TgZ(8,"div",30),e._uU(9," U.Medida "),e.qZA(),e.TgZ(10,"div",31),e._uU(11," Precio "),e.qZA(),e.TgZ(12,"div",32),e._uU(13," Activo "),e.qZA(),e.TgZ(14,"div",33),e._uU(15," Acciones "),e.qZA()(),e.YNc(16,Co,2,2,"ng-container",17),e.ALo(17,"async"),e._UZ(18,"mat-paginator",34),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(4),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","type"),e.xp6(4),e.Q6J("mat-sort-header","price"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(17,11,t.productServices$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,To,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(15,Io))("showFirstLastButtons",!0)}}function Ao(o,i){if(1&o&&(e.ynx(0),e.YNc(1,qo,19,16,"ng-container",26),e.BQk()),2&o){const t=i.ngIf;e.oxw();const n=e.MAs(30);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function ko(o,i){if(1&o&&(e.TgZ(0,"div",53),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.searchInputControl.value?"\xa1No se han encontrado productos o servicios!":"\xa1No se ha creado ning\xfan producto o servicio a\xfan!","")}}const wo=function(){return["Super Administrador"]};let Qo=(()=>{class o{constructor(t,n,r,s,c,d){this._changeDetectorRef=t,this._fuseConfirmationService=n,this._productServiceService=r,this._snackBar=s,this.dialog=c,this.store=d,this.merchantId="",this.productService=new Nt,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new a.NI(null),this._unsubscribeAll=new I.x}ngOnInit(){this.productServices$=this.store.select(le.ZQ),this.store.select(D.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,z.O)(null),(0,b.w)(t=>null!==t?(this.isLoading=!0,this._productServiceService.getProductServices(0,20,"active","desc",t)):(0,Z.of)()),(0,S.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,Y.T)(this._sort.sortChange,this._paginator.page).pipe((0,b.w)(()=>(this.isLoading=!0,this._productServiceService.getProductServices(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,S.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){this._openDialog(this.productService,"add")}editProductService(t){this._openDialog(t,"edit")}deleteProductService(t){this._fuseConfirmationService.open({title:`Eliminar ${t.type}`,message:`\xbfEst\xe1 seguro que desea eliminar el ${"Producto"===t.type?"producto":"servicio"} ${t.name}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServiceService.deleteProductService(t._id,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,n){return n.id||t}_openDialog(t,n){this.dialog.open(po,{width:"600px",height:"98%",data:{productService:t,dialogMode:n},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(F.R),e.Y36(W.z),e.Y36(q.ux),e.Y36(k.uw),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-productServices"]],viewQuery:function(t,n){if(1&t&&(e.Gf(A.NW,5),e.Gf(v.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:31,vars:9,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex flex-wrap items-center mt-2 shrink-0 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","overflow-x-auto","sm:overflow-x-clip"],[4,"ngIf"],["noProductServices",""],[1,"flex","flex-wrap","items-center","mt-2","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","sm:mt-0","text-white","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","productServices-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-center"],[1,"flex","justify-end",3,"mat-sort-header"],[1,"flex","justify-center","lg:ml-6",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","productServices-table","md:px-8"],[1,"flex","items-center"],[1,"relative","flex","flex-0","items-center","justify-center","w-12","h-12","mr-6","rounded","overflow-hidden","border"],["class","w-8",3,"alt","src",4,"ngIf"],["class","flex items-center justify-center w-full h-full text-xs font-semibold leading-none text-center uppercase",4,"ngIf"],[1,"truncate"],[1,"truncate","text-center"],[1,"truncate","text-right"],[1,"text-center","lg:ml-6"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"w-8",3,"alt","src"],[1,"flex","items-center","justify-center","w-full","h-full","text-xs","font-semibold","leading-none","text-center","uppercase"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Productos y Servicios"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13),e._uU(23," Productos y Servicios "),e.qZA()()(),e.YNc(24,_o,8,7,"div",14),e.qZA(),e.TgZ(25,"div",15)(26,"div",16),e.YNc(27,Ao,2,2,"ng-container",17),e.ALo(28,"async"),e.YNc(29,ko,2,1,"ng-template",null,18,e.W1O),e.qZA()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(6),e.Q6J("ngxPermissionsExcept",e.DdM(8,wo)),e.xp6(3),e.Q6J("ngIf",e.lcZ(28,6,n.productServices$)))},dependencies:[g.rH,g.yS,m.mk,m.sg,m.O5,a.Fj,a.JJ,a.oH,w.PQ,y.lW,C.Hw,p.KE,p.qo,Q.Nt,A.NW,v.YE,v.nU,G.gE,m.Ov,m.H9],encapsulation:2,data:{animation:P.L},changeDetection:0}),o})();var So=l(4128),Uo=l(99813);const Fo=[{path:"goods",component:Qo,resolve:{prodS:(()=>{class o{constructor(t){this._productServicesService=t}resolve(t,n){return this._productServicesService.getProductServices()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(W.z))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}},{path:"goods/:goodsId",component:Dt,resolve:{prod:(()=>{class o{constructor(t,n){this._uomService=t,this._productServicesService=n}resolve(t,n){const r=t.params.goodsId;return"new"===r?this._uomService.getUoms():(0,So.D)([this._productServicesService.getProductServiceById(r),this._uomService.getUoms()])}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(Uo.c),e.LFG(W.z))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}}];let Jo=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(Fo),se.m,ce.fi.forRoot()]}),o})();var Po=l(35265);let Do=(()=>{class o{constructor(t,n,r){this._activatedRoute=t,this._changeDetectorRef=n,this._router=r,this.merchantId="",this._unsubscribeAll=new I.x}ngOnInit(){this._activatedRoute.params.pipe((0,u.R)(this._unsubscribeAll)).subscribe(({merchantId:t})=>{void 0!==t&&(this.merchantId=t,this._changeDetectorRef.markForCheck())})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz),e.Y36(e.sBO),e.Y36(g.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ath-commercial"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"ath-content-menu")},dependencies:[Po.p],encapsulation:2,changeDetection:0}),o})();var No=l(31915);const Eo=["invoiceDetail"],Ro=function(){return["../"]};let Oo=(()=>{class o{constructor(){}ngOnInit(){}generatePDF(t){this.invoiceDetailsComponent.generatePDF(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["invoice-details-header"]],viewQuery:function(t,n){if(1&t&&e.Gf(Eo,5),2&t){let r;e.iGM(r=e.CRH())&&(n.invoiceDetailsComponent=r.first)}},decls:35,vars:9,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"],["invoiceDetail",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Facturas"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la factura"),e.qZA()()()(),e.TgZ(25,"div",14)(26,"button",15),e.NdJ("click",function(){return n.generatePDF("open")}),e._UZ(27,"mat-icon",16),e.qZA(),e.TgZ(28,"button",15),e.NdJ("click",function(){return n.generatePDF("download")}),e._UZ(29,"mat-icon",16),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return n.generatePDF("print")}),e._UZ(31,"mat-icon",16),e.qZA()()(),e.TgZ(32,"div",17),e._UZ(33,"invoice-details",null,18),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink",e.DdM(8,Ro)),e.xp6(3),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(9),e.Q6J("svgIcon","heroicons_outline:eye"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:download"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:printer"))},dependencies:[g.yS,w.PQ,y.lW,C.Hw,No._],encapsulation:2,changeDetection:0}),o})();var $=(()=>{return(o=$||($={})).PendientePago="Pendiente de Pago",o.PagadaParcialmente="Pagada Parcialmente",o.PagadaTotalmente="Pagada Totalmente",o.Cancelada="Cancelada",o.Vencida="Vencida",$;var o})(),Yo=l(27939),te=l(71121),he=l(29997),M=l(92181);function Mo(o,i){if(1&o&&(e.TgZ(0,"div",19)(1,"mat-form-field",20),e._UZ(2,"mat-icon",21)(3,"input",22),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Buscar facturas")}}function Lo(o,i){1&o&&e.GkF(0)}const Bo=function(){return[""]};function Wo(o,i){if(1&o&&(e.TgZ(0,"div",53)(1,"span"),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.AsE("",e.xi3(3,2,t.total,e.DdM(5,Bo))," ",t.currency,"")}}function jo(o,i){1&o&&e._UZ(0,"mat-icon",44),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function zo(o,i){1&o&&e._UZ(0,"mat-icon",44),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function Go(o,i){1&o&&e._UZ(0,"mat-icon",44),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function $o(o,i){1&o&&e._UZ(0,"mat-icon",44),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}const Vo=function(o,i,t,n,r){return{"bg-amber-50 text-amber-700":o,"bg-blue-50 text-blue-700":i,"bg-green-50 text-green-700":t,"bg-red-50 text-red-700":n,"bg-pink-50 text-pink-700":r}},Ho=function(o){return[o]};function Ko(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",37),e._uU(5),e.qZA(),e.TgZ(6,"div",29),e.YNc(7,Wo,4,6,"div",38),e.qZA(),e.TgZ(8,"div",39),e._uU(9),e.qZA(),e.TgZ(10,"div",40)(11,"span",41),e._uU(12),e.qZA()(),e.TgZ(13,"div",42)(14,"button",43),e._UZ(15,"mat-icon",44),e.qZA(),e.TgZ(16,"div")(17,"button",45),e._UZ(18,"mat-icon",44),e.qZA(),e.TgZ(19,"mat-menu",null,46)(21,"button",47)(22,"div",48),e.YNc(23,jo,1,1,"mat-icon",49),e.qZA(),e.TgZ(24,"span",50),e._uU(25,"Pendiente de Pago"),e.qZA()(),e.TgZ(26,"button",51),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateStatus(s,"Pagada Parcialmente"))}),e.TgZ(27,"div",48),e.YNc(28,zo,1,1,"mat-icon",49),e.qZA(),e.TgZ(29,"span",50),e._uU(30,"Pagada Parcialmente"),e.qZA()(),e.TgZ(31,"button",51),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateStatus(s,"Pagada Totalmente"))}),e.TgZ(32,"div",48),e.YNc(33,Go,1,1,"mat-icon",49),e.qZA(),e.TgZ(34,"span",50),e._uU(35,"Pagada Totalmente"),e.qZA()(),e.TgZ(36,"button",51),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.cancelInvoice(s))}),e.TgZ(37,"div",48),e.YNc(38,$o,1,1,"mat-icon",49),e.qZA(),e.TgZ(39,"span",50),e._uU(40,"Cancelada"),e.qZA()()()(),e.TgZ(41,"button",52),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteInvoice(s))}),e._UZ(42,"mat-icon",44),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit,n=e.MAs(20),r=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.quotationNo," "),e.xp6(2),e.Q6J("ngForOf",r.getTotalAmount(t)),e.xp6(2),e.hij(" ",t.quotationId.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Cancelada"===t.status?"Motivo: "+t.canceledReason:"")("ngClass",e.qbA(23,Vo,"Pendiente de Pago"===t.status,"Pagada Parcialmente"===t.status,"Pagada Totalmente"===t.status,"Cancelada"===t.status,"Vencida"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("routerLink",e.VKq(29,Ho,t._id)),e.xp6(1),e.Q6J("svgIcon","mat_solid:visibility"),e.xp6(2),e.Q6J("matMenuTriggerFor",n)("disabled",t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-list"),e.xp6(3),e.Q6J("disabled",!0),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pendiente de Pago")),e.xp6(3),e.Q6J("disabled",t.status.includes("Pagada Parcialmente")||t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pagada Parcialmente")),e.xp6(3),e.Q6J("disabled",t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pagada Totalmente")),e.xp6(3),e.Q6J("disabled",!t.status.includes("Pendiente de Pago")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Cancelada")),e.xp6(3),e.Q6J("matTooltip","Eliminar")("disabled",!t.status.includes("Pendiente de Pago")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function Xo(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Ko,43,31,"ng-container",35),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const en=function(o){return{"pointer-events-none":o}},tn=function(){return[10,25,50,100]};function on(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23),e.YNc(2,Lo,1,0,"ng-container",24),e.TgZ(3,"div",25)(4,"div",26)(5,"div",27)(6,"div",28),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",28),e._uU(9," N.Factura "),e.qZA(),e.TgZ(10,"div",29),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",30),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",31),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",32),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,Xo,2,2,"ng-container",33),e.ALo(19,"async"),e._UZ(20,"mat-paginator",34),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(27),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","quotationNo"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.invoices$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,en,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,tn))("showFirstLastButtons",!0)}}const nn=function(o){return{"bg-amber-500 text-amber-50":o}},rn=function(o){return{"bg-blue-500 text-blue-50":o}},an=function(o){return{"bg-green-500 text-green-50":o}},sn=function(o){return{"bg-red-500 text-red-50":o}},cn=function(o){return{"bg-pink-500 text-pink-50":o}};function ln(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",54)(1,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Pendiente de Pago"!==r.filterInputControl.value?"Pendiente de Pago":""))}),e.TgZ(2,"span",56),e._uU(3,"Pendiente de Pago"),e.qZA(),e._UZ(4,"div",57),e.qZA(),e.TgZ(5,"button",58),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Pagada Parcialmente"!==r.filterInputControl.value?"Pagada Parcialmente":""))}),e.TgZ(6,"span",56),e._uU(7,"Pagada Parcialmente"),e.qZA(),e._UZ(8,"div",59),e.qZA(),e.TgZ(9,"button",60),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Pagada Totalmente"!==r.filterInputControl.value?"Pagada Totalmente":""))}),e.TgZ(10,"span",56),e._uU(11,"Pagada Totalmente"),e.qZA(),e._UZ(12,"div",61),e.qZA(),e.TgZ(13,"button",62),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Cancelada"!==r.filterInputControl.value?"Cancelada":""))}),e.TgZ(14,"span",56),e._uU(15,"Canceladas"),e.qZA(),e._UZ(16,"div",63),e.qZA(),e.TgZ(17,"button",64),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Vencida"!==r.filterInputControl.value?"Vencida":""))}),e.TgZ(18,"span",56),e._uU(19,"Vencidas"),e.qZA(),e._UZ(20,"div",65),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(5,nn,"Pendiente de Pago"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(7,rn,"Pagada Parcialmente"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(9,an,"Pagada Totalmente"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(11,sn,"Cancelada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(13,cn,"Vencida"===t.filterInputControl.value))}}function mn(o,i){if(1&o&&(e.TgZ(0,"div",66),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.searchInputControl.value?"\xa1No se han encontrado facturas!":"\xa1No se ha creado ninguna factura a\xfan!"," ")}}const dn=function(){return["Super Administrador"]};function un(o,i){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Facturas"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Facturas "),e.qZA()()(),e.YNc(24,Mo,4,4,"div",15),e.qZA(),e.YNc(25,on,21,16,"ng-container",16),e.YNc(26,ln,21,15,"ng-template",null,17,e.W1O),e.YNc(28,mn,2,1,"ng-template",null,18,e.W1O),e.qZA()),2&o){const t=i.ngIf,n=e.MAs(27),r=e.MAs(29),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(6),e.Q6J("ngxPermissionsExcept",e.DdM(7,dn)),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:r)}}let pn=(()=>{class o{constructor(t,n,r,s,c,d){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=r,this._invoiceService=s,this._snackBar=c,this.store=d,this.isLoading=!1,this.searchInputControl=new a.NI(null),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new I.x}ngOnInit(){this.invoices$=this.store.select(Yo.vm),this.store.select(D.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,z.O)(null),(0,b.w)(t=>null!==t?(this.isLoading=!0,this._invoiceService.getInvoices(0,20,"createdAt","desc",t,this.filterInputControl.value)):(0,Z.of)()),(0,S.U)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,b.w)(t=>this._invoiceService.getInvoices(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,Y.T)(this._sort.sortChange,this._paginator.page).pipe((0,b.w)(()=>(this.isLoading=!0,this._invoiceService.getInvoices(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,S.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteInvoice(t){this._fuseConfirmationService.open({title:"Eliminar Factura",message:`\xbfEst\xe1 seguro que desea eliminar la factura # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._invoiceService.deleteInvoice(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}updateStatus(t,n){this._fuseConfirmationService.open({title:"Actualizar estado",message:`\xbfEst\xe1 seguro desea actualizar el estado de la factura # ${t.no} a ${n} `,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._invoiceService.updateStatus(t._id,n).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}cancelInvoice(t){this._dialog.open(te.g,{data:{title:"Cancelar Factura",message:`\xbfEst\xe1 seguro desea cancelar la factura # ${t.no}`,rejectedReason:t.canceledReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(r=>{void 0!==r&&this._invoiceService.updateStatus(t._id,$.Cancelada,r.reason).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}getTotalAmount(t){return t.quotationId.goodsData.reduce((n,{currency:r})=>{if(!n.some(s=>s.currency===r)){const s=t.quotationId.goodsData.filter(c=>c.currency===r).map(c=>c.quantity).reduce((c,d)=>c+d,0);n.push({currency:r,total:s})}return n},[])}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(k.uw),e.Y36(F.R),e.Y36(he.x),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-invoices"]],viewQuery:function(t,n){if(1&t&&(e.Gf(A.NW,5),e.Gf(v.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex items-center flex-shrink-0 mt-6 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[4,"ngIf","ngIfElse"],["filter",""],["noInvoices",""],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","invoices-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","invoices-table","md:px-8"],[1,"whitespace-nowrap"],["class","flex flex-col items-end",4,"ngFor","ngForOf"],[1,"truncate","text-center"],[1,"flex","h-7","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Cambiar estado",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor","disabled"],["listStatusMenu","matMenu"],["mat-menu-item","",1,"grid","grid-cols-4",3,"disabled"],[1,"col-span-1"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"col-span-3"],["mat-menu-item","",1,"grid","grid-cols-4",3,"disabled","click"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","disabled","click"],[1,"flex","flex-col","items-end"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-2","pl-2","sm:pr-6","w-full","sm:w-11/12","md:w-full","lg:w-11/12","xl:w-9/12","flex","justify-around"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-amber-500","hover:text-amber-50",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-blue-500","hover:text-blue-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-green-700","transition-all","ease-in-out","delay-100","bg-green-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-green-500","hover:text-green-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","md:w-auto","hover:bg-red-500","hover:text-red-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"flex","justify-center","items-center","ml-1","sm:ml-0","pl-6","pr-6","md:pr-4","md:pl-4","h-full","text-pink-700","transition-all","ease-in-out","delay-50","bg-pink-100","border-0","rounded-full","w-36","md:w-auto","hover:bg-pink-500","hover:text-pink-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-pink-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,un,30,8,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.invoices$))},dependencies:[m.mk,m.sg,m.O5,m.tP,a.Fj,a.JJ,a.oH,g.rH,g.yS,w.PQ,y.lW,C.Hw,p.KE,p.qo,Q.Nt,M.VK,M.OP,M.p6,A.NW,v.YE,v.nU,O.gM,G.gE,m.Ov,m.H9],encapsulation:2,data:{animation:P.L},changeDetection:0}),o})();var xe=l(32567);const ve=o=>o.paymentWays,be=((0,x.P1)(ve,o=>o.paymentWay),(0,x.P1)(ve,o=>o.paymentWays));class Ze{}var oe=l(96679),gn=l(12494),ye=l(79814);function _n(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar forma de pago"),e.qZA())}function fn(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Editar forma de pago "),e.qZA())}function hn(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Detalles del forma de pago"),e.qZA())}function xn(o,i){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.paymentWay.name||"Sin nombre")}}function vn(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function bn(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre debe contener entre 3 y 255 caracteres. "),e.qZA())}function Zn(o,i){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Porciento"),e.qZA())}function yn(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El porciento es obligatorio "),e.qZA())}function Cn(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function Tn(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.get("percent").getError("outOfRange")," ")}}function In(o,i){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Descripci\xf3n"),e.qZA())}function qn(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n es obligatoria "),e.qZA())}function An(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n debe contener entre 3 y 1000 caracteres. "),e.qZA())}function kn(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",50)(2,"button",51),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,s=e.oxw(2);return e.KtG(s.removeTermField(r))}),e._UZ(3,"mat-icon",29),e.qZA()(),e.BQk()}2&o&&(e.xp6(3),e.Q6J("svgIcon","heroicons_solid:trash"))}function wn(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",43)(2,"mat-form-field",44),e.YNc(3,Zn,2,0,"mat-label",6),e.TgZ(4,"span",45),e._uU(5,"%"),e.qZA(),e.TgZ(6,"input",46),e.NdJ("blur",function(r){const c=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.checkOutOfRange(r.target.value,c))}),e.qZA(),e.YNc(7,yn,2,0,"mat-error",6),e.YNc(8,Cn,2,0,"mat-error",6),e.YNc(9,Tn,2,1,"mat-error",6),e.qZA(),e.TgZ(10,"mat-form-field",47),e.YNc(11,In,2,0,"mat-label",6),e._UZ(12,"mat-icon",48)(13,"textarea",49),e.YNc(14,qn,2,0,"mat-error",6),e.YNc(15,An,2,0,"mat-error",6),e.qZA(),e.YNc(16,kn,4,1,"ng-container",6),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit,n=i.first,r=i.last;e.xp6(3),e.Q6J("ngIf",n),e.xp6(3),e.Q6J("formControl",t.get("percent"))("spellcheck",!1),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("min")||t.get("percent").hasError("max")),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("outOfRange")),e.xp6(2),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControl",t.get("description"))("placeholder","Descripci\xf3n")("minLength",3)("maxLength",1e3),e.xp6(1),e.Q6J("ngIf",t.get("description").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.get("description").hasError("maxlength")||t.get("description").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",!(n&&r))}}function Qn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",9)(2,"form",16)(3,"div",17)(4,"mat-form-field",18)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",19),e.YNc(8,vn,2,0,"mat-error",6),e.YNc(9,bn,2,0,"mat-error",6),e.qZA()(),e.TgZ(10,"div",20)(11,"fuse-alert",21)(12,"span",22),e._uU(13,"T\xe9rminos"),e.qZA(),e.TgZ(14,"div",23)(15,"span"),e._uU(16," Cuando usted factura la forma de pago puede tener tantos t\xe9rminos como usted pacte con sus clientes pero la sumatoria de todos debe ser el 100% del valor de la factura, por ejemplo:"),e.qZA(),e.TgZ(17,"li",24),e._uU(18,"50% a la firma del contrato"),e.qZA(),e.TgZ(19,"li",25),e._uU(20,"50% a la entrega de la mercanc\xeda"),e.qZA(),e.TgZ(21,"span"),e._uU(22," esta forma de pago tiene dos t\xe9rminos y la suma de ambos completa el valor de la factura "),e.qZA()()(),e.TgZ(23,"div",26),e.YNc(24,wn,17,15,"ng-container",27),e.qZA(),e.TgZ(25,"div",28),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addTermField())}),e._UZ(26,"mat-icon",29),e.TgZ(27,"span",30),e._uU(28,"Agregar t\xe9rmino"),e.qZA()()(),e.TgZ(29,"div",31)(30,"fuse-alert",21)(31,"span",22),e._uU(32,"Pagos"),e.qZA(),e._uU(33," Para que el cliente efect\xfae el pago usted puede marcar y escoger algunas de las siguientes opciones previamente introducida en la gesti\xf3n del negocio: "),e.TgZ(34,"li",32),e._uU(35,"Mostrar en la factura su cuenta bancaria."),e.qZA(),e.TgZ(36,"li",33),e._uU(37,"Seleccionar los QRs de pago que tiene contratado con Enzona y Transfermovil que se mostrar\xe1n en la factura."),e.qZA()(),e.TgZ(38,"div",34)(39,"mat-checkbox",35),e._uU(40),e.ALo(41,"uppercase"),e.qZA(),e.TgZ(42,"mat-radio-group",36)(43,"mat-radio-button",37),e._uU(44,"Ninguno"),e.qZA(),e.TgZ(45,"mat-radio-button",38),e._uU(46),e.ALo(47,"uppercase"),e.qZA()()(),e._UZ(48,"div",39),e.qZA(),e.TgZ(49,"div",40)(50,"span",41),e._uU(51,"Estado"),e.qZA(),e.TgZ(52,"mat-slide-toggle",42),e._uU(53),e.qZA()()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.paymentWayForm)("autocomplete","off"),e.xp6(5),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del forma de pago"),e.xp6(1),e.Q6J("ngIf",t.paymentWayForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.paymentWayForm.get("name").hasError("maxlength")||t.paymentWayForm.get("name").hasError("minlength")),e.xp6(2),e.Q6J("type","info")("appearance","outline"),e.xp6(13),e.Q6J("ngForOf",t.paymentWayForm.get("terms").controls)("ngForTrackBy",t.trackByFn),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:plus-circle"),e.xp6(4),e.Q6J("type","info")("appearance","outline"),e.xp6(9),e.Q6J("color","primary")("formControlName","includeBankAccount"),e.xp6(1),e.hij(" Incluir la cuenta bancaria de ",e.lcZ(41,25,t.currentMerchant.name),""),e.xp6(2),e.Q6J("color","primary")("formControlName","paymentBy"),e.xp6(4),e.hij("Pagos por QRs de ",e.lcZ(47,27,t.currentMerchant.name),""),e.xp6(6),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.paymentWayForm.get("active").value?"Activo":"Inactivo"," ")}}const Ce=function(o){return{"cursor-not-allowed":o}};function Sn(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",54),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.updatePaymentWay())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.paymentWayForm.invalid||100!==t.totalPercent||"none"===t.paymentWayForm.get("paymentBy").value&&!1===t.paymentWayForm.get("includeBankAccount").value)("ngClass",e.VKq(4,Ce,t.paymentWayForm.invalid||100!==t.totalPercent||"none"===t.paymentWayForm.get("paymentBy").value&&!1===t.paymentWayForm.get("includeBankAccount").value))}}function Un(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",54),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.createPaymentWay())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.paymentWayForm.invalid||100!==t.totalPercent||"none"===t.paymentWayForm.get("paymentBy").value&&!1===t.paymentWayForm.get("includeBankAccount").value)("ngClass",e.VKq(4,Ce,t.paymentWayForm.invalid||100!==t.totalPercent||"none"===t.paymentWayForm.get("paymentBy").value&&!1===t.paymentWayForm.get("includeBankAccount").value))}}function Fn(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",52),e.ynx(2),e.TgZ(3,"button",53),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,Sn,3,6,"ng-container",6),e.YNc(6,Un,3,6,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Jn=(()=>{class o{constructor(t,n,r,s,c,d,_){this.data=t,this._changeDetectorRef=n,this._formBuilder=r,this._fuseConfirmationService=s,this._paymentWaysService=c,this._snackBar=d,this.store=_,this.paymentWay=new Ze,this.dialogMode="view",this.merchants=[],this.selectedMerchant$=null,this.user=null,this.user$=(0,Z.of)(null),this.totalPercent=0,this._unsubscribeAll=new I.x}ngOnInit(){this.user$=this.store.select(B.rk),this.user$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(X.Qs).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.paymentWayForm=this._formBuilder.group({_id:[""],active:[!0,[a.kI.required]],userId:[this.user.id,[a.kI.required]],merchantId:[this.currentMerchant.id,[a.kI.required]],paymentBy:["none",[a.kI.required]],includeBankAccount:[!0],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],terms:this._formBuilder.array([])}),"edit"===this.data.dialogMode&&(this.paymentWayForm.patchValue(this.data.paymentWay),this.paymentWayForm.get("merchantId").setValue(this.data.paymentWay.merchantId._id)),this.setTermsDataOnForm()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addTermField(){const t=this._formBuilder.group({percent:[0,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(1e3)]]}),n=this.paymentWayForm.get("terms");n.length<=6&&n.push(t),this._changeDetectorRef.markForCheck()}removeTermField(t){this.paymentWayForm.get("terms").removeAt(t),this.totalPercent=this.paymentWayForm.get("terms").getRawValue().map(r=>r.percent).reduce((r,s)=>r+s,0),this._changeDetectorRef.markForCheck()}createPaymentWay(){if(100!==this.totalPercent||this.paymentWayForm.invalid)return;let t=this.paymentWayForm.getRawValue();t=(0,_e.Z)(t,"_id"),t.slug=new R.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._paymentWaysService.createPaymentWay(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updatePaymentWay(){if(100!==this.totalPercent||this.paymentWayForm.invalid)return;const t=this.paymentWayForm.getRawValue();t.slug=new R.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._paymentWaysService.updatePaymentWay(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}checkOutOfRange(t,n){if(+t<=100){const r=this.paymentWayForm.get("terms").getRawValue().map(c=>c.percent).reduce((c,d)=>c+d,0),s=this.paymentWayForm.get("terms").controls;r<=100&&s.forEach(c=>{c.get("percent").hasError("outOfRange")&&c.get("percent").setErrors(null)}),r>100&&s.at(n).get("percent").setErrors({outOfRange:"La suma del % de todos los t\xe9rminos no debe superar a 100"}),this.totalPercent=r}}trackByFn(t,n){return n.id||t}setTermsDataOnForm(){if("add"===this.data.dialogMode)return void this.addTermField();const t=[];this.data.paymentWay.terms.length>0?this.data.paymentWay.terms.forEach(n=>{t.push(this._formBuilder.group({percent:[n.percent,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:[n.description,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]}))}):t.push(this._formBuilder.group({percent:[0,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]})),t.forEach(n=>{this.paymentWayForm.get("terms").push(n)}),this.totalPercent=this.paymentWayForm.get("terms").getRawValue().map(n=>n.percent).reduce((n,r)=>n+r,0)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(k.WI),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(F.R),e.Y36(oe.x),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["paymentWays-detail"]],decls:12,vars:6,consts:[[1,"relative","flex","flex-col","w-full","h-full","overflow-y-auto"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"pt-5"],[1,"w-full"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],[1,"mt-4"],[3,"type","appearance"],["fuseAlertTitle",""],[1,"flex","flex-col"],[1,"mt-2","ml-3"],[1,"mb-2","ml-3"],[1,"p-6","pb-0"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inline-flex","items-center","px-4","mt-2","-ml-4","rounded","cursor-pointer","group",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"mt-6"],[1,"ml-3","mt-2"],[1,"ml-3"],[1,"grid","gap-4","p-6","pt-7","pb-7","sm:grid-cols-2"],[1,"mb-4",3,"color","formControlName"],["aria-label","Select an option",1,"flex","flex-wrap","justify-between","gap-2","sm:col-span-2",3,"color","formControlName"],["value","none",1,"sm:col-span-1"],["value","UseMerchantPayments",1,"sm:col-span-1"],[1,"w-full","border-t-2"],[1,"flex","flex-col","mt-8"],[1,"font-medium"],[1,"mt-1","sm:mt-3",3,"formControlName","color"],[1,"flex","flex-col","sm:flex-row"],[1,"flex-auto","mt-2","sm:max-w-[20%]"],["matPrefix",""],["matInput","","type","number","min","0","max","100","required","",3,"formControl","spellcheck","blur"],[1,"flex-auto","w-full","mt-2","sm:ml-4","fuse-mat-textarea"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","required","",3,"formControl","placeholder","minLength","maxLength"],[1,"flex","self-end","w-10","mb-2","sm:items-center","sm:pl-2"],["mat-icon-button","","matTooltip","Eliminar",1,"w-8","h-8","min-h-8",3,"click"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","matDialogClose","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,_n,2,0,"h2",2),e.YNc(4,fn,2,0,"h2",2),e.YNc(5,hn,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(6,"div",3),e.ynx(7),e.YNc(8,xn,9,1,"div",4),e.BQk(),e.ynx(9),e.YNc(10,Qn,54,29,"div",5),e.BQk(),e.qZA(),e.YNc(11,Fn,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",null===n.data.paymentWay._id&&"add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.paymentWay._id&&"edit"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.paymentWay._id&&"view"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},dependencies:[m.mk,m.sg,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.qQ,a.Fd,a.oH,a.sg,a.u,gn.W,y.lW,de.oG,k.ZT,C.Hw,p.TO,p.KE,p.hX,p.qo,Q.Nt,ye.VQ,ye.U0,pe.Rr,O.gM,m.gd],encapsulation:2,changeDetection:0}),o})();function Pn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",19)(1,"mat-form-field",20),e._UZ(2,"mat-icon",21)(3,"input",22),e.qZA(),e.TgZ(4,"button",23),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.createPaymentWay())}),e._UZ(5,"mat-icon",24),e.TgZ(6,"span",25),e._uU(7,"Nueva"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Buscar formas de pago"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus")}}function Dn(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",40),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Nn(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",41),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function En(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",34)(2,"div",35),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e.YNc(5,Dn,2,1,"ng-container",31),e.YNc(6,Nn,2,1,"ng-container",31),e.qZA(),e.TgZ(7,"div",37)(8,"button",38),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.editPaymentWay(s))}),e._UZ(9,"mat-icon",39),e.qZA(),e.TgZ(10,"button",38),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deletePaymentWay(s._id))}),e._UZ(11,"mat-icon",39),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function Rn(o,i){if(1&o&&(e.ynx(0),e.YNc(1,En,12,5,"ng-container",33),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const On=function(o){return{"pointer-events-none":o}},Yn=function(){return[10,25,50,100]};function Mn(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26)(2,"div",27)(3,"div",28),e._uU(4," Nombre "),e.qZA(),e.TgZ(5,"div",29),e._uU(6," Activo "),e.qZA(),e.TgZ(7,"div",30),e._uU(8," Acciones "),e.qZA()(),e.YNc(9,Rn,2,2,"ng-container",31),e.ALo(10,"async"),e._UZ(11,"mat-paginator",32),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name")("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(10,10,t.paymentWays$)),e.xp6(2),e.Q6J("ngClass",e.VKq(12,On,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(14,Yn))("showFirstLastButtons",!0)}}function Ln(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Mn,12,15,"ng-container",17),e.BQk()),2&o){const t=i.ngIf;e.oxw();const n=e.MAs(30);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Bn(o,i){if(1&o&&(e.TgZ(0,"div",42),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.searchInputControl.value?"\xa1No se han encontrado formas de pago!":"\xa1No se ha creado ninguna forma de pago a\xfan!")}}const Wn=function(){return["Super Administrador"]};let jn=(()=>{class o{constructor(t,n,r,s,c,d){this._changeDetectorRef=t,this._paymentWayService=n,this._dialog=r,this._fuseConfirmationService=s,this._snackBar=c,this.store=d,this.merchantId="",this.paymentWays$=(0,Z.of)([]),this.paymentWay=new Ze,this.isLoading=!1,this.searchInputControl=new a.NI(null),this._unsubscribeAll=new I.x}ngOnInit(){this.paymentWays$=this.store.select(be),this.store.select(D.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,z.O)(null),(0,b.w)(t=>null!==t?(this.isLoading=!0,this._paymentWayService.getPaymentWays(0,20,"active","desc",t)):(0,Z.of)()),(0,S.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,Y.T)(this._sort.sortChange,this._paginator.page).pipe((0,b.w)(()=>(this.isLoading=!0,this._paymentWayService.getPaymentWays(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,S.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createPaymentWay(){this._openDialog(this.paymentWay,"add")}editPaymentWay(t){this._openDialog(t,"edit")}deletePaymentWay(t){this._fuseConfirmationService.open({title:"Eliminar Forma de pago",message:"\xbfEsta seguro que desea Eliminar el Forma de pago? Perder\xe1 el acceso a todos los datos asociados al mismo.",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._paymentWayService.deletePaymentWay(t,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}_openDialog(t,n){this._dialog.open(Jn,{data:{paymentWay:t,dialogMode:n},panelClass:"ath-payment-method-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(oe.x),e.Y36(k.uw),e.Y36(F.R),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-paymentWays"]],viewQuery:function(t,n){if(1&t&&(e.Gf(A.NW,5),e.Gf(v.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:31,vars:10,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto","overflow-x-auto","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex flex-wrap items-center mt-2  shrink-0 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[4,"ngIf","ngIfElse"],["noPaymentWays",""],[1,"flex","flex-wrap","items-center","mt-2","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","sm:mt-0","text-white","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5","payment-methods-table"],[3,"mat-sort-header"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"text-center","mr-4","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","md:px-8","payment-methods-table"],[1,"truncate"],[1,"text-center","sm:mr-4"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Formas de pago"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13),e._uU(23," Formas de Pago "),e.qZA()()(),e.YNc(24,Pn,8,5,"div",14),e.qZA(),e.TgZ(25,"div",15)(26,"div",16),e.YNc(27,Ln,2,2,"ng-container",17),e.ALo(28,"async"),e.YNc(29,Bn,2,1,"ng-template",null,18,e.W1O),e.qZA()()()),2&t){const r=e.MAs(30);e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(6),e.Q6J("ngxPermissionsExcept",e.DdM(9,Wn)),e.xp6(3),e.Q6J("ngIf",e.lcZ(28,7,n.paymentWays$))("ngIfElse",r)}},dependencies:[g.yS,m.mk,m.sg,m.O5,a.Fj,a.JJ,a.oH,w.PQ,y.lW,C.Hw,p.KE,p.qo,Q.Nt,A.NW,v.YE,v.nU,G.gE,m.Ov],encapsulation:2,data:{animation:P.L},changeDetection:0}),o})(),zn=(()=>{class o{constructor(t){this._paymentWaysService=t}resolve(t,n){return this._paymentWaysService.getPaymentWays(0,20,"name","asc","")}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(oe.x))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Gn=l(65453);const $n=["quotationDetail"],Vn=function(){return["../"]};let Hn=(()=>{class o{constructor(){}ngOnInit(){}generatePDF(t){this.quotationDetailsComponent.generatePDF(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["quotation-details-header"]],viewQuery:function(t,n){if(1&t&&e.Gf($n,5),2&t){let r;e.iGM(r=e.CRH())&&(n.quotationDetailsComponent=r.first)}},decls:35,vars:9,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"],["quotationDetail",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Ofertas"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la oferta"),e.qZA()()()(),e.TgZ(25,"div",14)(26,"button",15),e.NdJ("click",function(){return n.generatePDF("open")}),e._UZ(27,"mat-icon",16),e.qZA(),e.TgZ(28,"button",15),e.NdJ("click",function(){return n.generatePDF("download")}),e._UZ(29,"mat-icon",16),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return n.generatePDF("print")}),e._UZ(31,"mat-icon",16),e.qZA()()(),e.TgZ(32,"div",17),e._UZ(33,"quotation-details",null,18),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink",e.DdM(8,Vn)),e.xp6(3),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(9),e.Q6J("svgIcon","heroicons_outline:eye"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:download"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:printer"))},dependencies:[g.yS,w.PQ,y.lW,C.Hw,Gn.i],encapsulation:2,changeDetection:0}),o})();var Kn=l(66861),Xn=l(1494);function ei(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 60. "),e.qZA())}const ti=function(o){return{"cursor-not-allowed":o}};let oi=(()=>{class o{constructor(t,n,r,s,c,d){this.data=t,this._formBuilder=n,this._dialogRef=r,this._invoiceService=s,this._snackBar=c,this.store=d,this.selectedQuotation=null,this.user$=(0,Z.of)(null),this._unsubscribeAll=new I.x,this.selectedQuotation=t.quotation}ngOnInit(){this.user$=this.store.select(B.rk),this.user$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t}),this.invoiceForm=this._formBuilder.group({merchantId:[this.selectedQuotation.merchantId._id,[a.kI.required]],userId:[this.user.id,[a.kI.required]],quotationId:[this.selectedQuotation._id,[a.kI.required]],quotationNo:[{disabled:!0,value:this.selectedQuotation.no},[a.kI.required]],expirationDays:[this.selectedQuotation.merchantId.commercialManagement.expirationInvoiceDays,[a.kI.required,a.kI.min(1),a.kI.max(60)]],bankAccount:["",[a.kI.minLength(16),a.kI.maxLength(24)]],status:[$.PendientePago,[a.kI.required]]}),this.selectedQuotation.paymentMethodData.includeBankAccount&&this.invoiceForm.get("bankAccount").setValue(this.selectedQuotation.merchantId.bankAccount)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createInvoice(){const t=this.invoiceForm.getRawValue();this._invoiceService.createInvoice(t).subscribe(n=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.store.dispatch((0,Xn.qm)({quotation:Object.assign(Object.assign({},this.selectedQuotation),{status:"Facturada"})})),this._dialogRef.close()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(k.WI),e.Y36(a.qu),e.Y36(k.so),e.Y36(he.x),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-invoice-conform-dialog"]],decls:29,vars:15,consts:[[1,"ng-star-inserted","h-full"],[1,"relative","flex","flex-col","w-full","h-full"],[1,"h-full","flex","items-center"],[1,"block","w-full"],[1,"flex","flex-col","sm:flex-row","flex-auto","items-center","sm:items-start","p-8","pb-4","sm:pb-6"],["ng-reflect-ng-class","[object Object]",1,"flex","flex-0","items-center","justify-center","w-10","h-10","sm:mr-4","rounded-full","text-blue-600","bg-blue-100","dark:text-blue-50","dark:bg-blue-600","ng-star-inserted"],["role","img","aria-hidden","true","ng-reflect-svg-icon","heroicons_outline:question-mar","data-mat-icon-type","svg","data-mat-icon-name","question-mark-circle","data-mat-icon-namespace","heroicons_outline",1,"mat-icon","notranslate","text-current","mat-icon-no-color"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","fit","","height","100%","width","100%","preserveAspectRatio","xMidYMid meet","focusable","false"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","flex-col","items-center","sm:items-start","mt-4","sm:mt-0","sm:pr-8","space-y-1","text-center","sm:text-left","ng-star-inserted"],[1,"text-xl","leading-6","font-medium","ng-star-inserted"],[1,"text-secondary","ng-star-inserted"],[1,"pr-8","pl-8","mt-10","sm:mt-0","sm:pl-22","pb-6",3,"formGroup","autocomplete"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[4,"ngIf"],[1,"flex","flex-wrap","tems-center","justify-center","md:justify-end","px-6","py-4","space-x-3","bg-gray-50","dark:bg-black","dark:bg-opacity-10","ng-star-inserted"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","","mat-button","",3,"color","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"mat-icon",6),e.O4$(),e.TgZ(7,"svg",7),e._UZ(8,"path",8),e.qZA()()(),e.kcU(),e.TgZ(9,"div",9)(10,"div",10),e._uU(11),e.qZA(),e.TgZ(12,"div",11),e._uU(13),e.qZA()()(),e.TgZ(14,"form",12)(15,"div")(16,"mat-form-field",13)(17,"mat-label"),e._uU(18,"Expira en"),e.qZA(),e.TgZ(19,"span",14),e._uU(20,"D\xedas"),e.qZA(),e._UZ(21,"mat-icon",15)(22,"input",16),e.YNc(23,ei,2,0,"mat-error",17),e.qZA()()()()(),e.TgZ(24,"div",18)(25,"button",19),e._uU(26,"Cancelar"),e.qZA(),e.TgZ(27,"button",20),e.NdJ("click",function(){return n.createInvoice()}),e._uU(28," Aceptar "),e.qZA()()()()),2&t&&(e.xp6(11),e.Oqu(n.data.title),e.xp6(2),e.Oqu(n.data.message),e.xp6(1),e.Q6J("formGroup",n.invoiceForm)("autocomplete","off"),e.xp6(7),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(1),e.Q6J("formControlName","expirationDays")("min",1)("max",60),e.xp6(1),e.Q6J("ngIf",n.invoiceForm.get("expirationDays").hasError("min")||n.invoiceForm.get("expirationDays").hasError("max")),e.xp6(2),e.Q6J("matDialogClose",!0),e.xp6(2),e.Q6J("color","primary")("disabled",n.invoiceForm.invalid)("ngClass",e.VKq(13,ti,n.invoiceForm.invalid)))},dependencies:[m.mk,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.qQ,a.Fd,a.sg,a.u,y.lW,k.ZT,C.Hw,p.TO,p.KE,p.hX,p.qo,p.R9,Q.Nt],encapsulation:2,data:{animation:P.L},changeDetection:0}),o})();var Te=l(67272);function ni(o,i){if(1&o&&(e.TgZ(0,"div",19)(1,"mat-form-field",20),e._UZ(2,"mat-icon",21)(3,"input",22),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Buscar ofertas")}}function ii(o,i){1&o&&e.GkF(0)}const ri=function(){return[""]};function ai(o,i){if(1&o&&(e.TgZ(0,"div",48)(1,"span"),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.AsE("",e.xi3(3,2,t.total,e.DdM(5,ri))," ",t.currency,"")}}const si=function(o,i,t,n,r){return{"bg-amber-50 text-amber-700":o,"bg-green-50 text-green-700":i,"bg-blue-50 text-blue-700":t,"bg-red-50 text-red-700":n,"bg-pink-50 text-pink-700":r}},ci=function(o){return[o]};function li(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",37),e._uU(5),e.qZA(),e.TgZ(6,"div",29),e.YNc(7,ai,4,6,"div",38),e.qZA(),e.TgZ(8,"div",39),e._uU(9),e.qZA(),e.TgZ(10,"div",40)(11,"span",41),e._uU(12),e.qZA()(),e.TgZ(13,"div",42)(14,"button",43),e._UZ(15,"mat-icon",44),e.qZA(),e.TgZ(16,"button",45),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.rejectQuotation(s))}),e._UZ(17,"mat-icon",44),e.qZA(),e.TgZ(18,"button",46),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.conformInvoice(s))}),e._UZ(19,"mat-icon",44),e.qZA(),e.TgZ(20,"button",47),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteQuotation(s))}),e._UZ(21,"mat-icon",44),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit,n=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.requestNo," "),e.xp6(2),e.Q6J("ngForOf",n.getTotalAmount(t)),e.xp6(2),e.hij(" ",t.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Rechazada"===t.status?"Motivo: "+t.rejectedReason:"")("ngClass",e.qbA(16,si,"Nueva"===t.status,"Aceptada"===t.status,"Facturada"===t.status,"Rechazada"===t.status,"Vencida"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("routerLink",e.VKq(22,ci,t._id)),e.xp6(1),e.Q6J("svgIcon","mat_solid:visibility"),e.xp6(1),e.Q6J("disabled",!t.status.includes("Nueva")&&!t.status.includes("Aceptada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-copy"),e.xp6(1),e.Q6J("disabled",!t.status.includes("Aceptada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-check"),e.xp6(1),e.Q6J("matTooltip","Eliminar")("disabled",!t.status.includes("Nueva")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function mi(o,i){if(1&o&&(e.ynx(0),e.YNc(1,li,22,24,"ng-container",35),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const di=function(o){return{"pointer-events-none":o}},ui=function(){return[10,25,50,100]};function pi(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23),e.YNc(2,ii,1,0,"ng-container",24),e.TgZ(3,"div",25)(4,"div",26)(5,"div",27)(6,"div",28),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",28),e._uU(9," N.Oferta "),e.qZA(),e.TgZ(10,"div",29),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",30),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",31),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",32),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,mi,2,2,"ng-container",33),e.ALo(19,"async"),e._UZ(20,"mat-paginator",34),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(27),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","requestNo"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.quotations$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,di,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,ui))("showFirstLastButtons",!0)}}const gi=function(o){return{"bg-amber-500 text-amber-50":o}},_i=function(o){return{"bg-green-500 text-green-50":o}},fi=function(o){return{"bg-blue-500 text-blue-50":o}},hi=function(o){return{"bg-red-500 text-pink-50 text-red-5":o}},xi=function(o){return{"bg-pink-500 text-pink-50":o}};function vi(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",49)(1,"button",50),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Nueva"!==r.filterInputControl.value?"Nueva":""))}),e.TgZ(2,"span",51),e._uU(3,"Nuevas"),e.qZA(),e._UZ(4,"div",52),e.qZA(),e.TgZ(5,"button",53),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Aceptada"!==r.filterInputControl.value?"Aceptada":""))}),e.TgZ(6,"span",51),e._uU(7,"Aceptadas"),e.qZA(),e._UZ(8,"div",54),e.qZA(),e.TgZ(9,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Facturada"!==r.filterInputControl.value?"Facturada":""))}),e.TgZ(10,"span",51),e._uU(11,"Facturadas"),e.qZA(),e._UZ(12,"div",56),e.qZA(),e.TgZ(13,"button",57),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Rechazada"!==r.filterInputControl.value?"Rechazada":""))}),e.TgZ(14,"span",51),e._uU(15,"Rechazadas"),e.qZA(),e._UZ(16,"div",58),e.qZA(),e.TgZ(17,"button",59),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Vencida"!==r.filterInputControl.value?"Vencida":""))}),e.TgZ(18,"span",51),e._uU(19,"Vencidas"),e.qZA(),e._UZ(20,"div",60),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(5,gi,"Nueva"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(7,_i,"Aceptada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(9,fi,"Facturada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(11,hi,"Rechazada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(13,xi,"Vencida"===t.filterInputControl.value))}}function bi(o,i){if(1&o&&(e.TgZ(0,"div",61),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.searchInputControl.value?"\xa1No se han encontrado ofertas!":"\xa1No se ha creado ninguna oferta a\xfan!","")}}const Zi=function(){return["Super Administrador"]};function yi(o,i){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Ofertas"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Ofertas "),e.qZA()()(),e.YNc(24,ni,4,4,"div",15),e.qZA(),e.YNc(25,pi,21,16,"ng-container",16),e.YNc(26,vi,21,15,"ng-template",null,17,e.W1O),e.YNc(28,bi,2,1,"ng-template",null,18,e.W1O),e.qZA()),2&o){const t=i.ngIf,n=e.MAs(27),r=e.MAs(29),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(6),e.Q6J("ngxPermissionsExcept",e.DdM(7,Zi)),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:r)}}let Ci=(()=>{class o{constructor(t,n,r,s,c,d){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=r,this._quotationService=s,this._snackBar=c,this.store=d,this.isLoading=!1,this.searchInputControl=new a.NI(null),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new I.x}ngOnInit(){this.quotations$=this.store.select(Kn.uy),this.store.select(D.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,z.O)(null),(0,b.w)(t=>null!==t?(this.isLoading=!0,this._quotationService.getQuotations(0,20,"createdAt","desc",t,this.filterInputControl.value)):(0,Z.of)()),(0,S.U)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,b.w)(t=>this._quotationService.getQuotations(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,Y.T)(this._sort.sortChange,this._paginator.page).pipe((0,b.w)(()=>(this.isLoading=!0,this._quotationService.getQuotations(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,S.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteQuotation(t){this._fuseConfirmationService.open({title:"Eliminar Oferta",message:`\xbfEst\xe1 seguro que desea eliminar la oferta # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._quotationService.deleteQuotation(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectQuotation(t){this._dialog.open(te.g,{data:{title:"Rechazar Oferta",message:`\xbfEst\xe1 seguro desea Rechazar la oferta # ${t.no}?`,rejectedReason:t.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(r=>{void 0!==r&&this._quotationService.rejectQuotation(t._id,r.reason).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}conformInvoice(t){this._dialog.open(oi,{data:{title:"Generar Factura",message:`\xbfEst\xe1 seguro que desea generar una factura para la oferta # ${t.no}?`,quotation:t},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"})}getTotalAmount(t){return t.goodsData.reduce((n,{currency:r})=>{if(!n.some(s=>s.currency===r)){const s=t.goodsData.filter(c=>c.currency===r).map(c=>c.quantity).reduce((c,d)=>c+d,0);n.push({currency:r,total:s})}return n},[])}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(k.uw),e.Y36(F.R),e.Y36(Te.D),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-quotations"]],viewQuery:function(t,n){if(1&t&&(e.Gf(A.NW,5),e.Gf(v.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex items-center flex-shrink-0 mt-6 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[4,"ngIf","ngIfElse"],["filter",""],["noQuotations",""],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","quotations-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-10","mr-6","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","quotations-table","md:px-8"],[1,"whitespace-nowrap"],["class","flex flex-col items-end",4,"ngFor","ngForOf"],[1,"truncate","text-center"],[1,"flex","h-7","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["matTooltip","Rechazar Oferta","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["matTooltip","Generar Factura","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","disabled","click"],[1,"flex","flex-col","items-end"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-2","pl-2","sm:pr-6","w-full","md:w-11/12","lg:w-10/12","xl:w-8/12","flex","justify-around"],[1,"flex","justify-center","items-center","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","hover:bg-amber-500","hover:text-amber-50",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-green-700","transition-all","ease-in-out","delay-100","bg-green-50","border-0","rounded-full","w-36","hover:bg-green-500","hover:text-green-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","hover:bg-blue-500","hover:text-blue-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","hover:bg-red-500","hover:text-red-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"flex","justify-center","items-center","ml-1","sm:ml-0","h-full","text-pink-700","transition-all","ease-in-out","delay-50","bg-pink-100","border-0","rounded-full","w-36","hover:bg-pink-500","hover:text-pink-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-pink-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,yi,30,8,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.quotations$))},dependencies:[m.mk,m.sg,m.O5,m.tP,a.Fj,a.JJ,a.oH,g.rH,g.yS,w.PQ,y.lW,C.Hw,p.KE,p.qo,Q.Nt,A.NW,v.YE,v.nU,O.gM,G.gE,m.Ov,m.H9],encapsulation:2,data:{animation:P.L},changeDetection:0}),o})();var Ie=l(59641),Ti=l(32627);const Ii=["requestDetail"];let qi=(()=>{class o{constructor(){}ngOnInit(){}generatePDF(t){this.quotationDetailsComponent.generatePDF(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["request-details-header"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ii,5),2&t){let r;e.iGM(r=e.CRH())&&(n.quotationDetailsComponent=r.first)}},decls:35,vars:7,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],["routerLink","/modules/commercial/request",1,"ml-1","text-primary-500","hover:underline"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"],["requestDetail",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Solicitudes"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la solicitud"),e.qZA()()()(),e.TgZ(25,"div",14)(26,"button",15),e.NdJ("click",function(){return n.generatePDF("open")}),e._UZ(27,"mat-icon",16),e.qZA(),e.TgZ(28,"button",15),e.NdJ("click",function(){return n.generatePDF("download")}),e._UZ(29,"mat-icon",16),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return n.generatePDF("print")}),e._UZ(31,"mat-icon",16),e.qZA()()(),e.TgZ(32,"div",17),e._UZ(33,"request-details",null,18),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(9),e.Q6J("svgIcon","heroicons_outline:eye"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:download"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:printer"))},dependencies:[g.yS,w.PQ,y.lW,C.Hw,Ti.d],encapsulation:2,changeDetection:0}),o})();var Ai=l(54899),qe=l(82440),ki=l(12454),Ae=l(97205),T=l(88279);function wi(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",27),e._uU(2),e.qZA(),e.BQk()),2&o){const t=i.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("value",n.transformPaymentMethod(t)),e.xp6(1),e.hij(" ",t.name," ")}}function Qi(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El m\xe9todo de pago es obligatoria. "),e.qZA())}function Si(o,i){if(1&o&&(e.TgZ(0,"mat-form-field",6)(1,"mat-label"),e._uU(2,"M\xe9todo de pago"),e.qZA(),e._UZ(3,"mat-icon",8),e.TgZ(4,"mat-select",25),e.YNc(5,wi,3,2,"ng-container",26),e.qZA(),e.YNc(6,Qi,2,0,"mat-error",10),e.qZA()),2&o){const t=i.ngIf,n=e.oxw();e.xp6(3),e.Q6J("svgIcon","heroicons_solid:credit-card"),e.xp6(1),e.Q6J("formControlName","paymentMethodData"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.quotationForm.get("paymentMethodData").hasError("required"))}}function Ui(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 60. "),e.qZA())}const Fi=function(o,i){return{"text-center pl-8  md:pl-0":o,"min-w-60 lg:w-80":i}};function Ji(o,i){if(1&o&&(e.TgZ(0,"th",32),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit,n=e.oxw();e.Q6J("ngClass",e.WLB(2,Fi,"name"!==t,"name"===t)),e.xp6(1),e.hij(" ",n.getFieldsTableHeaderNames(t)," ")}}const ke=function(){return[""]};function Pi(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2).$implicit;e.xp6(1),e.AsE("",e.xi3(2,2,t[n],e.DdM(5,ke))," ",t.currency," ")}}const Di=function(){return["$"]};function Ni(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2).$implicit;e.xp6(1),e.hij("",e.xi3(2,1,t[n],e.DdM(4,Di))," ")}}function Ei(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2).$implicit;e.xp6(1),e.hij("",t[n]," ")}}const Ri=function(o,i){return{"text-center":o,"w-60 lg:w-80":i}};function Oi(o,i){if(1&o&&(e.TgZ(0,"td",33),e.YNc(1,Pi,3,6,"span",10),e.YNc(2,Ni,3,5,"span",10),e.YNc(3,Ei,2,1,"span",10),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.Q6J("ngClass",e.WLB(4,Ri,"name"!==t,"name"===t)),e.xp6(1),e.Q6J("ngIf","price"===t),e.xp6(1),e.Q6J("ngIf","quantity"===t),e.xp6(1),e.Q6J("ngIf","price"!==t&&"quantity"!==t)}}function Yi(o,i){1&o&&(e.TgZ(0,"span"),e._uU(1,"Total"),e.qZA())}const Mi=function(o,i){return{"text-center":o,truncate:i}};function Li(o,i){if(1&o&&(e.TgZ(0,"td",34),e.YNc(1,Yi,2,0,"span",10),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.Q6J("ngClass",e.WLB(2,Mi,"name"!==t,"name"===t)),e.xp6(1),e.Q6J("ngIf","name"===t)}}function Bi(o,i){1&o&&(e.TgZ(0,"div"),e.YNc(1,Ji,2,5,"th",29),e.YNc(2,Oi,4,7,"td",30),e.YNc(3,Li,2,5,"td",31),e.qZA())}function Wi(o,i){if(1&o&&(e.TgZ(0,"th",38),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit,n=e.oxw();e.xp6(1),e.hij(" ",n.getFieldsTableHeaderNames(t)," ")}}function ji(o,i){if(1&o&&(e.TgZ(0,"span",42),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t[n],"")}}function zi(o,i){if(1&o&&(e.TgZ(0,"div",42)(1,"mat-form-field",43),e._UZ(2,"input",44),e.qZA()()),2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("formControl",n.amountFormControl)("min",0)("max",n.getOldGoodsAmountById(t.goodsId))}}function Gi(o,i){if(1&o&&(e.TgZ(0,"td",39)(1,"div",40),e.YNc(2,ji,2,1,"span",41),e.YNc(3,zi,3,3,"div",41),e.qZA()()),2&o){const t=i.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId))}}function $i(o,i){1&o&&e._UZ(0,"td",45)}function Vi(o,i){1&o&&(e.TgZ(0,"div"),e.YNc(1,Wi,2,1,"th",35),e.YNc(2,Gi,4,2,"td",36),e.YNc(3,$i,1,0,"td",37),e.qZA())}function Hi(o,i){1&o&&(e.TgZ(0,"th",49),e._uU(1," Acciones "),e.qZA())}function Ki(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.operation(r.goodsId,-1))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.Q6J("disabled",0===t.amount),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:minus-sm")}}function Xi(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.operation(r.goodsId,1))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.Q6J("disabled",t.amount===n.getOldGoodsAmountById(t.goodsId)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:plus-sm")}}function er(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",57),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.toggleToEditGoods(r))}),e._UZ(1,"mat-icon",56),e.qZA()}2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil-alt"))}function tr(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.toggleToEditGoods(r))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.Q6J("color","primary")("disabled",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)&&n.amountFormControl.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil-alt")}}function or(o,i){if(1&o&&(e.TgZ(0,"td",50)(1,"div",51),e.YNc(2,Ki,2,2,"button",52),e.YNc(3,Xi,2,2,"button",52),e.YNc(4,er,2,1,"button",53),e.YNc(5,tr,2,3,"button",54),e.qZA()()),2&o){const t=i.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId))}}function nr(o,i){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=i.$implicit;e.xp6(1),e.AsE("",e.xi3(2,2,t.total,e.DdM(5,ke))," ",t.currency,"")}}function ir(o,i){if(1&o&&(e.TgZ(0,"td",59),e.YNc(1,nr,3,6,"div",26),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.getTotalQuantity())}}function rr(o,i){1&o&&(e.TgZ(0,"div"),e.YNc(1,Hi,2,0,"th",46),e.YNc(2,or,6,4,"td",47),e.YNc(3,ir,2,1,"td",48),e.qZA())}function ar(o,i){if(1&o&&(e.ynx(0,28),e.YNc(1,Bi,4,0,"div",10),e.YNc(2,Vi,4,0,"div",10),e.YNc(3,rr,4,0,"div",10),e.BQk()),2&o){const t=i.$implicit;e.s9C("matColumnDef",t),e.xp6(1),e.Q6J("ngIf","actions"!==t&&"amount"!==t),e.xp6(1),e.Q6J("ngIf","amount"===t),e.xp6(1),e.Q6J("ngIf","actions"===t)}}function sr(o,i){1&o&&e._UZ(0,"tr",60)}function cr(o,i){1&o&&e._UZ(0,"tr",61)}function lr(o,i){1&o&&e._UZ(0,"tr",62)}const mr=function(o){return{"cursor-not-allowed":o}};let dr=(()=>{class o{constructor(t,n,r,s,c,d){this._changeDetectorRef=t,this._formBuilder=n,this._fuseConfirmationService=r,this._quotationsService=s,this._snackBar=c,this.store=d,this.selectedRequest=null,this.reject=new e.vpe,this.isQuotationCreated=new e.vpe,this.user$=(0,Z.of)(null),this.selectedGoodDataToEdit=null,this.amountFormControl=new a.NI(0),this.paymentMethods$=(0,Z.of)(null),this.displayedColumns=["name","type","uom","amount","price","quantity","actions"],this._unsubscribeAll=new I.x,this.amountFormControl.setValidators([a.kI.required])}ngOnInit(){this.goodsData=(0,E.cloneDeep)(this.selectedRequest.goodsData),this.user$=this.store.select(B.rk),this.user$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.paymentMethods$=this.store.select(be),this.quotationForm=this._formBuilder.group({merchantId:[this.selectedRequest.merchantId._id,[a.kI.required]],userId:[this.user.id,[a.kI.required]],requestId:[this.selectedRequest._id,[a.kI.required]],requestNo:[{disabled:!0,value:this.selectedRequest.no},[a.kI.required]],expirationDays:[this.selectedRequest.merchantId.commercialManagement.expirationQuotationDays,[a.kI.required,a.kI.min(1),a.kI.max(60)]],status:[Ae.qm.Nueva,[a.kI.required]],description:["",[a.kI.maxLength(1e3)]],paymentMethodData:[null,[a.kI.required]]})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createQuotation(){let t=this.quotationForm.getRawValue();t=Object.assign(Object.assign({},t),{goodsData:this.goodsData}),this._fuseConfirmationService.open({title:"Crear Oferta",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._quotationsService.createQuotation(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.isQuotationCreated.next(this.selectedRequest)}),this._changeDetectorRef.markForCheck()})}transformPaymentMethod(t){return new Ae.R8(t)}getTotal(){return this.getTotalQuantity().map(t=>t.total).reduce((t,n)=>t+n,0)}getTotalQuantity(){return this.goodsData.reduce((t,{currency:n})=>{if(!t.some(r=>r.currency===n)){const r=this.goodsData.filter(s=>s.currency===n).map(s=>s.quantity).reduce((s,c)=>s+c,0);t.push({currency:n,total:r})}return t},[])}getFieldsTableHeaderNames(t){switch(t){case"name":return"Nombre";case"uom":return"U.M";case"amount":return"Cantidad";case"price":return"Precio";case"quantity":return"Total unitario";case"type":return"Tipo"}}operation(t,n){const r=this.goodsData.find(s=>s.goodsId===t);r.amount=r.amount+n,r.quantity=r.amount*r.price}getOldGoodsAmountById(t){return this.selectedRequest.goodsData.find(n=>n.goodsId===t).amount}toggleToEditGoods(t){if(this.selectedGoodDataToEdit&&this.selectedGoodDataToEdit.goodsId===t.goodsId){const r=this.amountFormControl.value;this.amountFormControl.clearValidators();const s=this.goodsData.find(c=>c.goodsId===t.goodsId);return s.amount=r,s.quantity=s.amount*s.price,this.amountFormControl.clearValidators(),void(this.selectedGoodDataToEdit=null)}const n=this.selectedRequest.goodsData.find(r=>r.goodsId===t.goodsId);this.amountFormControl.setValidators([a.kI.required,a.kI.min(0),a.kI.max(n.amount)]),this.amountFormControl.setValue(t.amount),this.selectedGoodDataToEdit=t}triggerReject(){this.reject.next(this.selectedRequest)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(a.qu),e.Y36(F.R),e.Y36(Te.D),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["quotation-conform"]],inputs:{selectedRequest:"selectedRequest"},outputs:{reject:"reject",isQuotationCreated:"isQuotationCreated"},decls:36,vars:25,consts:[[1,"shadow-lg","overflow-hidden"],[1,"flex","flex-col","justify-between","order-b"],[1,"p-4","sm:p-10","flex","flex-col","space-y-1","w-full"],[1,"grid","w-full","grid-cols-4","gap-y-1","gap-x-6",3,"formGroup"],[1,"col-span-1"],["class","w-full",4,"ngIf"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[4,"ngIf"],[1,"col-span-2"],[1,"flex-auto","w-full","fuse-mat-textarea"],["matInput","","matTextareaAutosize","",1,"h-4","min-h-4","max-h-20",3,"formControlName","rows","spellcheck","maxlength"],[1,"flex","flex-col","col-span-4"],[1,"font-medium"],["tabindex","0",1,"mt-2","overflow-auto","max-h-80","rounded-md",2,"box-shadow","0 0 3px 0 rgb(0 0 0 / 10%), 0 1px 2px -1px rgb(0 0 0 / 10%) !important"],["mat-table","",1,"w-full",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","font-medium",4,"matFooterRowDef"],[1,"flex","items-center","justify-between","w-full","border-t","px-8","py-4"],["mat-button","",1,"-ml-4",3,"color","click"],["mat-flat-button","",3,"color","disabled","ngClass","click"],["required","",3,"formControlName"],[4,"ngFor","ngForOf"],[3,"value"],[3,"matColumnDef"],["mat-header-cell","","class","w-10 pr-8 md:w-auto md:pr-0",3,"ngClass",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["mat-footer-cell","",3,"ngClass",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pr-8","md:w-auto","md:pr-0",3,"ngClass"],["mat-cell","",3,"ngClass"],["mat-footer-cell","",3,"ngClass"],["mat-header-cell","","class","w-10 pr-8 md:w-auto md:pr-0 text-center pl-8  md:pl-0",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-center",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pr-8","md:w-auto","md:pr-0","text-center","pl-8","md:pl-0"],["mat-cell","",1,"text-center"],[1,"flex","justify-center"],["class","w-24",4,"ngIf"],[1,"w-24"],[1,"w-full","fuse-mat-no-subscript"],["type","number","matInput","","required","",3,"formControl","min","max"],["mat-footer-cell","",1,"text-center"],["mat-header-cell","","class","text-center pr-8 pl-8 md:pr-6 md:pl-0",4,"matHeaderCellDef"],["style","width: 120px;","mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-end",4,"matFooterCellDef"],["mat-header-cell","",1,"text-center","pr-8","pl-8","md:pr-6","md:pl-0"],["mat-cell","",1,"text-center",2,"width","120px"],[1,"flex","justify-center","space-x-2",2,"width","120px"],["class","min-w-10 min-h-7 h-7 px-2 leading-6","mat-button","",3,"disabled","click",4,"ngIf"],["class","min-w-10 min-h-7 h-7 px-2 leading-6","mat-button","",3,"click",4,"ngIf"],["class","min-h-7 h-7 px-2 leading-6","mat-flat-button","",3,"color","disabled","click",4,"ngIf"],["mat-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],["mat-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],["mat-flat-button","",1,"min-h-7","h-7","px-2","leading-6",3,"color","disabled","click"],["mat-footer-cell","",1,"text-end"],["mat-header-row",""],["mat-row",""],["mat-footer-row","",1,"font-medium"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4),e.YNc(5,Si,7,4,"mat-form-field",5),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"div",4)(8,"mat-form-field",6)(9,"mat-label"),e._uU(10,"Expira en"),e.qZA(),e.TgZ(11,"span",7),e._uU(12,"D\xedas"),e.qZA(),e._UZ(13,"mat-icon",8)(14,"input",9),e.YNc(15,Ui,2,0,"mat-error",10),e.qZA()(),e.TgZ(16,"div",11)(17,"mat-form-field",12)(18,"mat-label"),e._uU(19,"Descripci\xf3n"),e.qZA(),e._UZ(20,"mat-icon",8)(21,"textarea",13),e.qZA()()(),e.TgZ(22,"div",14)(23,"mat-label",15),e._uU(24,"Productos y servicios"),e.qZA(),e.TgZ(25,"div",16)(26,"table",17),e.YNc(27,ar,4,4,"ng-container",18),e.YNc(28,sr,1,0,"tr",19),e.YNc(29,cr,1,0,"tr",20),e.YNc(30,lr,1,0,"tr",21),e.qZA()()()(),e.TgZ(31,"div",22)(32,"button",23),e.NdJ("click",function(){return n.triggerReject()}),e._uU(33," Rechazar Solicitud "),e.qZA(),e.TgZ(34,"button",24),e.NdJ("click",function(){return n.createQuotation()}),e._uU(35," Conformar Oferta "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",n.quotationForm),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,21,n.paymentMethods$)),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(1),e.Q6J("formControlName","expirationDays")("min",1)("max",60),e.xp6(1),e.Q6J("ngIf",n.quotationForm.get("expirationDays").hasError("min")||n.quotationForm.get("expirationDays").hasError("max")),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.xp6(5),e.Q6J("dataSource",n.goodsData),e.xp6(1),e.Q6J("ngForOf",n.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",n.displayedColumns),e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("color","primary")("disabled",n.quotationForm.invalid||n.amountFormControl.invalid||0===n.getTotal())("ngClass",e.VKq(23,mr,n.quotationForm.invalid||n.amountFormControl.invalid||0===n.getTotal())))},dependencies:[m.mk,m.sg,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.nD,a.qQ,a.Fd,a.oH,a.sg,a.u,ee.ey,y.lW,C.Hw,p.TO,p.KE,p.hX,p.qo,p.R9,Q.Nt,ue.gD,T.BZ,T.fO,T.as,T.w1,T.Dz,T.nj,T.mD,T.Ke,T.ge,T.ev,T.yh,T.XQ,T.Gk,T.Q2,m.Ov,m.H9],encapsulation:2,changeDetection:0}),o})();function ur(o,i){if(1&o&&(e.TgZ(0,"div",19)(1,"mat-form-field",20),e._UZ(2,"mat-icon",21)(3,"input",22),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",t.searchInputControl)("autocomplete","off")("placeholder","Buscar solicitudes")}}function pr(o,i){1&o&&e.GkF(0)}const gr=function(){return[""]};function _r(o,i){if(1&o&&(e.TgZ(0,"div",47)(1,"span"),e._uU(2),e.ALo(3,"currency"),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.AsE("",e.xi3(3,2,t.total,e.DdM(5,gr))," ",t.currency,"")}}function fr(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"quotation-conform",48),e.NdJ("reject",function(r){e.CHM(t);const s=e.oxw(5);return e.KtG(s.rejectRequest(r))})("isQuotationCreated",function(r){e.CHM(t);const s=e.oxw(5);return e.KtG(s.getRequestById(r))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("selectedRequest",t)}}const hr=function(o,i,t){return{"bg-amber-50 text-amber-700":o,"bg-blue-50 text-blue-700":i,"bg-red-50 text-red-700":t}},xr=function(o){return[o]};function vr(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",37),e._uU(5),e.qZA(),e.TgZ(6,"div",29),e.YNc(7,_r,4,6,"div",38),e.qZA(),e.TgZ(8,"div",39),e._uU(9),e.qZA(),e.TgZ(10,"div",40)(11,"span",41),e._uU(12),e.qZA()(),e.TgZ(13,"div",42)(14,"button",43),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.toggleDetails(s))}),e._UZ(15,"mat-icon",44),e.qZA(),e.TgZ(16,"button",45),e._UZ(17,"mat-icon",44),e.qZA(),e.TgZ(18,"button",46),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteRequest(s))}),e._UZ(19,"mat-icon",44),e.qZA()()(),e.TgZ(20,"div",26),e.YNc(21,fr,2,1,"ng-container",33),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit,n=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.AsE(" ",t.name," ",t.lastname," "),e.xp6(2),e.Q6J("ngForOf",n.getTotalAmount(t)),e.xp6(2),e.hij(" ",t.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Rechazada"===t.status?"Motivo: "+t.rejectedReason:"")("ngClass",e.kEZ(15,hr,"Nueva"===t.status,"Aceptada"===t.status,"Rechazada"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("disabled","Nueva"!==t.status),e.xp6(1),e.Q6J("svgIcon",(null==n.selectedRequest?null:n.selectedRequest._id)===t._id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),e.xp6(1),e.Q6J("routerLink",e.VKq(19,xr,t._id)),e.xp6(1),e.Q6J("svgIcon","mat_solid:visibility"),e.xp6(1),e.Q6J("matTooltip","Eliminar"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash"),e.xp6(2),e.Q6J("ngIf",(null==n.selectedRequest?null:n.selectedRequest._id)===t._id)}}function br(o,i){if(1&o&&(e.ynx(0),e.YNc(1,vr,22,21,"ng-container",35),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Zr=function(o){return{"pointer-events-none":o}},yr=function(){return[10,25,50,100]};function Cr(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23),e.YNc(2,pr,1,0,"ng-container",24),e.TgZ(3,"div",25)(4,"div",26)(5,"div",27)(6,"div",28),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",28),e._uU(9," Nombre "),e.qZA(),e.TgZ(10,"div",29),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",30),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",31),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",32),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,br,2,2,"ng-container",33),e.ALo(19,"async"),e._UZ(20,"mat-paginator",34),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(27),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","name"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.requests$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,Zr,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,yr))("showFirstLastButtons",!0)}}const Tr=function(o){return{"bg-amber-500 text-amber-50":o}},Ir=function(o){return{"bg-blue-500 text-blue-50":o}},qr=function(o){return{"bg-red-500 text-red-50":o}};function Ar(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",49)(1,"button",50),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Nueva"!==r.filterInputControl.value?"Nueva":""))}),e.TgZ(2,"span",51),e._uU(3,"Nuevas"),e.qZA(),e._UZ(4,"div",52),e.qZA(),e.TgZ(5,"button",53),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Aceptada"!==r.filterInputControl.value?"Aceptada":""))}),e.TgZ(6,"span",51),e._uU(7,"Aceptadas"),e.qZA(),e._UZ(8,"div",54),e.qZA(),e.TgZ(9,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Rechazada"!==r.filterInputControl.value?"Rechazada":""))}),e.TgZ(10,"span",51),e._uU(11,"Rechazadas"),e.qZA(),e._UZ(12,"div",56),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(3,Tr,"Nueva"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(5,Ir,"Aceptada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(7,qr,"Rechazada"===t.filterInputControl.value))}}function kr(o,i){if(1&o&&(e.TgZ(0,"div",57),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.searchInputControl.value?"\xa1No se han encontrado solicitudes!":"\xa1No le han enviado ninguna solicitud a\xfan!")}}const wr=function(){return["Super Administrador"]};function Qr(o,i){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Solicitudes"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Solicitudes "),e.qZA()()(),e.YNc(24,ur,4,4,"div",15),e.qZA(),e.YNc(25,Cr,21,16,"ng-container",16),e.YNc(26,Ar,13,9,"ng-template",null,17,e.W1O),e.YNc(28,kr,2,1,"ng-template",null,18,e.W1O),e.qZA()),2&o){const t=i.ngIf,n=e.MAs(27),r=e.MAs(29),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(6),e.Q6J("ngxPermissionsExcept",e.DdM(7,wr)),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:r)}}let Sr=(()=>{class o{constructor(t,n,r,s,c,d){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=r,this._requestService=s,this._snackBar=c,this.store=d,this.isLoading=!1,this.searchInputControl=new a.NI(null),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new I.x}ngOnInit(){this.requests$=this.store.select(Ai.Mu),this.store.select(D.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,z.O)(null),(0,b.w)(t=>(null!==t&&(this.isLoading=!0,this._requestService.getRequests(0,20,"createdAt","desc",t,this.filterInputControl.value)),(0,Z.of)())),(0,S.U)(()=>{this.isLoading=!1})).subscribe(),this.filterInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(300),(0,b.w)(t=>this._requestService.getRequests(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,Y.T)(this._sort.sortChange,this._paginator.page).pipe((0,b.w)(()=>(this.isLoading=!0,this._requestService.getRequests(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,S.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteRequest(t){this._fuseConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar la solicitud # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._requestService.deleteRequest(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectRequest(t){this._dialog.open(te.g,{data:{title:"Rechazar Solicitud",message:`\xbfEst\xe1 seguro desea Rechazar la solicitud # ${t.no}?`,rejectedReason:t.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,u.R)(this._unsubscribeAll)).subscribe(r=>{void 0!==r&&this._requestService.rejectRequest(t._id,r.reason).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this.closeDetails(),this._changeDetectorRef.markForCheck()})})}getRequestById(t){this._requestService.getRequestById(t._id).subscribe(n=>{this.store.dispatch((0,qe.WN)({request:n.data})),this.store.dispatch((0,qe._P)()),this.closeDetails(),this._changeDetectorRef.markForCheck()})}getTotalAmount(t){return t.goodsData.reduce((n,{currency:r})=>{if(!n.some(s=>s.currency===r)){const s=t.goodsData.filter(c=>c.currency===r).map(c=>c.quantity).reduce((c,d)=>c+d,0);n.push({currency:r,total:s})}return n},[])}toggleDetails(t){this.selectedRequest&&this.selectedRequest._id===t._id?this.closeDetails():this.selectedRequest=t}closeDetails(){this.selectedRequest=null}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(k.uw),e.Y36(F.R),e.Y36(ki.r),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["hrm-requests"]],viewQuery:function(t,n){if(1&t&&(e.Gf(A.NW,5),e.Gf(v.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],["class","flex items-center flex-shrink-0 mt-6 sm:mt-0 sm:ml-4",4,"ngxPermissionsExcept"],[4,"ngIf","ngIfElse"],["filter",""],["noRequests",""],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","requests-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","requests-table","md:px-8"],[1,"truncate","whitespace-nowrap"],["class","flex flex-col items-end",4,"ngFor","ngForOf"],[1,"truncate","text-center"],[1,"flex","h-7","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","click"],[1,"flex","flex-col","items-end"],[3,"selectedRequest","reject","isQuotationCreated"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-6","w-7/12","md:w-7/12","lg:w-6/12","xl:w-5/12","flex","justify-around"],[1,"flex","justify-center","items-center","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","hover:bg-amber-500","hover:text-amber-50",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","hover:bg-blue-500","hover:text-blue-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","hover:bg-red-500","hover:text-red-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,Qr,30,8,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.requests$))},dependencies:[g.rH,g.yS,m.mk,m.sg,m.O5,m.tP,a.Fj,a.JJ,a.oH,w.PQ,y.lW,C.Hw,p.KE,p.qo,Q.Nt,A.NW,v.YE,v.nU,O.gM,G.gE,dr,m.Ov,m.H9],encapsulation:2,data:{animation:P.L},changeDetection:0}),o})();var we=l(94290),Ur=l(98118),Fr=l(31366);let Jr=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["selling-orders"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[g.lC],encapsulation:2}),o})();var L=l(33921);const Pr=L.Ps`
    query FindAllOrders($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllOrders(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }
            orders {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight

            }
        }
    }
`,Dr=L.Ps`
    query FindOrdersByMerchant($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findOrdersByMerchant(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            orders {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight

            }
        }
    }
`,Nr=L.Ps`
    query FindOrderById($findOrderByIdId: String!) {
        findOrderById(id: $findOrderByIdId) {
            ok
            message

            order {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                    address
                    state
                    city
                    nit
                    website
                }

                clientId
                client {
                    fullname
                    idNumber
                    address
                    state
                    city
                    email
                    phone
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    description
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight

            }
        }
    }
`,Er=L.Ps`
    mutation UpdateOrder($updateOrderInput: UpdateOrderInput!) {
        updateOrder(updateOrderInput: $updateOrderInput) {

            ok
            message

            order {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight
            }
        }
    }
`,Rr=L.Ps`
    mutation UpdateOrderStatus($updateOrderStatusInput: UpdateOrderStatusInput!) {
        updateOrderStatus(updateOrderStatusInput: $updateOrderStatusInput) {
            ok
            message

            order {
                id

                currencyId
                currency {
                    iso
                }

                merchantId
                merchant {
                    name
                }

                clientId
                client {
                    fullname
                }

                beneficiaryId
                beneficiary {
                    idNumber
                    fullname
                    email
                    phone
                    address
                    state
                    city
                }

                paymentMethodId
                paymentMethod {
                    name
                }

                products {
                    productId
                    quantity
                }

                productsInOrder {
                    id
                    name
                    price
                    thumbnail
                }

                canceled
                canceledAt
                cancelObs
                changeStatusAt
                createdAt
                delivered
                deliveredAt
                discount
                no
                obs
                orderType
                payed
                payedAt
                paymentStatus
                ready
                readyAt
                shipped
                shippedAt
                shippingCost
                shippingWay
                status
                subtotal
                tax
                total
                tracking
                volume
                weight
            }
        }
    }
`;var V=l(18505),Qe=l(95698),N=l(66198),Se=l(75714);const ne=o=>o.orders,Or=(0,x.P1)(ne,o=>o.order),ie=(0,x.P1)(ne,o=>o.orders);(0,x.P1)(ne,o=>o.ordersByWeekdayStats);let re=(()=>{class o{constructor(t,n,r){this.apolloProvider=t,this._snackBar=n,this.store=r,this._apollo=this.apolloProvider.use("BALANC")}getOrders(t=1,n=10,r="name",s="asc",c=""){return this._apollo.query({query:Pr,errorPolicy:"all",variables:{offset:n*(t-1),limit:n,sort:r,order:s,search:c}}).pipe((0,V.b)(({errors:d,data:_})=>{if(d){let h="";d.forEach(H=>h+=`\n ${H.message}.`),this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:h,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,N.qQ)({orders:_.findAllOrders.orders})),this.store.dispatch((0,Se.Jr)({pagination:_.findAllOrders.pagination}))}))}getOrdersByMerchant(t=1,n=10,r="name",s="asc",c=""){return this._apollo.query({query:Dr,errorPolicy:"all",variables:{offset:n*(t-1),limit:n,sort:r,order:s,search:c}}).pipe((0,V.b)(({errors:d,data:_})=>{if(d){let h="";d.forEach(H=>h+=`\n ${H.message}.`),this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:h,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,N.qQ)({orders:_.findOrdersByMerchant.orders})),this.store.dispatch((0,Se.Jr)({pagination:_.findOrdersByMerchant.pagination}))}))}getOrderById(t){return this._apollo.query({query:Nr,variables:{findOrderByIdId:t},errorPolicy:"all"}).pipe((0,V.b)(({errors:n,data:r})=>{if(n){let s="";n.forEach(c=>s+=`\n ${c.message}.`),this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:s,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,N.OL)({order:r.findOrderById.order}))}))}updateOrder(t){return this.store.select(ie).pipe((0,Qe.q)(1),(0,b.w)(n=>this._apollo.mutate({mutation:Er,variables:{updateOrderInput:t},errorPolicy:"all"}).pipe((0,V.b)(({errors:r,data:s})=>{if(r){let _="";r.forEach(h=>_+=`\n ${h.message}.`),this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:_,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const c=(0,E.cloneDeep)(n);c[n.findIndex(_=>_.id==_.id)]=s.updateOrder.order,this.store.dispatch((0,N.qQ)({orders:c})),this.store.dispatch((0,N.OL)({order:s.updateOrder.order}))}))))}updateOrderStatus(t){return this.store.select(ie).pipe((0,Qe.q)(1),(0,b.w)(n=>this._apollo.mutate({mutation:Rr,variables:{updateOrderStatusInput:t},errorPolicy:"all"}).pipe((0,V.b)(({errors:r,data:s})=>{if(r){let _="";r.forEach(h=>_+=`\n ${h.message}.`),this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:_,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const c=(0,E.cloneDeep)(n);c[n.findIndex(_=>_.id==_.id)]=s.updateOrderStatus.order,this.store.dispatch((0,N.qQ)({orders:c})),this.store.dispatch((0,N.OL)({order:s.updateOrderStatus.order}))}))))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(L._M),e.LFG(q.ux),e.LFG(x.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Yr=(()=>{class o{constructor(t){this._ordersService=t}resolve(t,n){const r=t.paramMap.get("orderId");if(null!==r)return this._ordersService.getOrderById(r)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(re))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),Mr=(()=>{class o{constructor(t){this._ordersService=t}resolve(t,n){return this._ordersService.getOrdersByMerchant()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(re))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Lr=l(51927);const Br=["htmlOrderList"],Wr=function(o,i,t,n,r,s){return{"bg-pink-200 text-pink-800 dark:bg-pink-600 dark:text-pink-50":o,"bg-teal-200 text-teal-800 dark:bg-teal-600 dark:text-teal-50":i,"bg-orange-200 text-orange-800 dark:bg-orange-600 dark:text-orange-50":t,"bg-yellow-200 text-yellow-800 dark:bg-yellow-600 dark:text-yellow-50":n,"bg-green-200 text-green-800 dark:bg-green-600 dark:text-green-50":r,"bg-red-200 text-red-800 dark:bg-red-600 dark:text-red-50":s}},jr=function(o){return["/modules/commercial/orders/invoice/",o]};function zr(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",31)(2,"div",32),e._uU(3),e.qZA(),e.TgZ(4,"div",33),e._uU(5),e.ALo(6,"date"),e.qZA(),e.TgZ(7,"div",34),e._uU(8),e.qZA(),e.TgZ(9,"div",34),e._uU(10),e.qZA(),e.TgZ(11,"div",27),e._uU(12),e.ALo(13,"number"),e.qZA(),e.TgZ(14,"div",35)(15,"span",36)(16,"span",37),e._uU(17),e.qZA()()(),e.TgZ(18,"div",38)(19,"button",39),e._UZ(20,"mat-icon",40),e.qZA(),e.TgZ(21,"button",41),e._UZ(22,"mat-icon",40),e.qZA(),e.TgZ(23,"mat-menu",42,43)(25,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updatedOrderStatus(s.id,"pagada"))}),e.TgZ(26,"span"),e._uU(27,"Pagada"),e.qZA()(),e.TgZ(28,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updatedOrderStatus(s.id,"procesando"))}),e.TgZ(29,"span"),e._uU(30,"Procesando"),e.qZA()(),e.TgZ(31,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updatedOrderStatus(s.id,"lista"))}),e.TgZ(32,"span"),e._uU(33,"Lista"),e.qZA()(),e.TgZ(34,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updatedOrderStatus(s.id,"enviada"))}),e.TgZ(35,"span"),e._uU(36,"Enviada"),e.qZA()(),e.TgZ(37,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updatedOrderStatus(s.id,"entregada"))}),e.TgZ(38,"span"),e._uU(39,"Entregada"),e.qZA()(),e.TgZ(40,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updatedOrderStatus(s.id,"cancelada"))}),e.TgZ(41,"span"),e._uU(42,"Cancelada"),e.qZA()()()()(),e.BQk()}if(2&o){const t=i.$implicit,n=e.MAs(24);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",e.xi3(6,17,t.createdAt,"shortDate")," "),e.xp6(3),e.hij(" ",t.client.fullname," "),e.xp6(2),e.hij(" ",t.beneficiary.fullname," "),e.xp6(2),e.hij(" $ ",e.xi3(13,20,t.total,"1.2-2")," "),e.xp6(3),e.Q6J("ngClass",e.HTZ(23,Wr,"nueva"===t.status,"procesando"===t.status,"lista"===t.status,"enviada"===t.status,"entregada"===t.status,"cancelada"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("routerLink",e.VKq(30,jr,t.id)),e.xp6(1),e.Q6J("svgIcon","mat_solid:description"),e.xp6(1),e.Q6J("matMenuTriggerFor",n),e.xp6(1),e.Q6J("svgIcon","mat_solid:drag_indicator"),e.xp6(3),e.Q6J("disabled",t.payed||t.canceled),e.xp6(3),e.Q6J("disabled",t.ready||t.shipped||t.delivered||t.delivered||t.canceled),e.xp6(3),e.Q6J("disabled",t.shipped||t.delivered||t.canceled),e.xp6(3),e.Q6J("disabled",t.delivered||t.canceled),e.xp6(3),e.Q6J("disabled",t.canceled),e.xp6(3),e.Q6J("disabled",t.delivered||t.canceled)}}function Gr(o,i){if(1&o&&(e.ynx(0),e.YNc(1,zr,43,32,"ng-container",30),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const $r=function(o){return{"pointer-events-none":o}},Vr=function(){return[5,10,25,100]};function Hr(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22)(2,"div",23)(3,"div",24),e._uU(4," N\xfamero "),e.qZA(),e.TgZ(5,"div",25),e._uU(6," Fecha "),e.qZA(),e.TgZ(7,"div",26),e._uU(8," Cliente "),e.qZA(),e.TgZ(9,"div",26),e._uU(10," Beneficiario "),e.qZA(),e.TgZ(11,"div",27),e._uU(12," Importe "),e.qZA(),e.TgZ(13,"div",25),e._uU(14," Estado "),e.qZA(),e.TgZ(15,"div",28),e._uU(16," Acciones "),e.qZA()(),e.YNc(17,Gr,2,2,"ng-container",19),e.ALo(18,"async"),e.qZA(),e._UZ(19,"mat-paginator",29),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","orderNo"),e.xp6(14),e.Q6J("ngIf",e.lcZ(18,8,t.orders$)),e.xp6(2),e.Q6J("ngClass",e.VKq(10,$r,t.isLoading))("length",t.pagination.length)("page",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(12,Vr))("showFirstLastButtons",!0)}}function Kr(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Hr,20,13,"ng-container",21),e.BQk()),2&o){const t=i.ngIf;e.oxw();const n=e.MAs(33);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Xr(o,i){1&o&&(e.TgZ(0,"div",45),e._uU(1,"\xa1No se ha generado ninguna orden!"),e.qZA())}function ta(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div")(2,"div",9)(3,"div",10)(4,"a",11),e._uU(5,"Inicio"),e.qZA()(),e.TgZ(6,"div",10),e._UZ(7,"mat-icon",12),e.TgZ(8,"a",11),e._uU(9,"Ventas"),e.qZA()(),e.TgZ(10,"div",10),e._UZ(11,"mat-icon",12),e.TgZ(12,"a",11),e._uU(13,"\xd3rdenes"),e.qZA()(),e.TgZ(14,"div",10),e._UZ(15,"mat-icon",12),e.TgZ(16,"a",13),e._uU(17),e.qZA()(),e.TgZ(18,"div",14)(19,"a",15),e._UZ(20,"mat-icon",12),e.TgZ(21,"span",16),e._uU(22,"Regresar"),e.qZA()()()()(),e.TgZ(23,"div",17)(24,"h2",18),e._uU(25),e.qZA()(),e.BQk()),2&o){const t=i.ngIf;e.xp6(4),e.Q6J("routerLink","/home"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink","/selling/panels"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink","/selling/panels/orders"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(2),e.Oqu(t.no),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(5),e.hij(" Orden ",t.no," ")}}function oa(o,i){if(1&o&&(e.ynx(0),e._UZ(1,"div",53),e.TgZ(2,"div",54)(3,"div",55),e._uU(4),e.qZA(),e.TgZ(5,"div",56),e._uU(6),e.qZA()(),e.TgZ(7,"div",57),e._uU(8),e.qZA(),e.TgZ(9,"div",58),e._uU(10),e.ALo(11,"currency"),e.qZA(),e.TgZ(12,"div",59),e._uU(13),e.ALo(14,"currency"),e.qZA(),e.BQk()),2&o){const t=i.$implicit,n=e.oxw(2).ngIf,r=e.oxw();e.xp6(4),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.description," "),e.xp6(2),e.Oqu(r.getProductQty(t.id,n.products)),e.xp6(2),e.hij("",e.Dn7(11,5,t.price,n.currency.iso+" ","symbol")," "),e.xp6(3),e.Oqu(e.Dn7(14,9,r.getProductQty(t.id,n.products)*t.price,n.currency.iso+" ","symbol"))}}function na(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",19)(2,"div",20)(3,"div",21)(4,"div",22)(5,"div",23),e._UZ(6,"img",24),e.qZA(),e.TgZ(7,"div",25)(8,"div",26),e._uU(9),e.qZA(),e.TgZ(10,"div"),e._uU(11),e.qZA(),e.TgZ(12,"div"),e._uU(13),e.qZA(),e.TgZ(14,"div"),e._uU(15),e.qZA(),e.TgZ(16,"div"),e._uU(17),e.qZA(),e.TgZ(18,"div"),e._uU(19),e.qZA()()()(),e.TgZ(20,"div",27)(21,"div",28),e._uU(22,"FACTURA "),e.qZA(),e.TgZ(23,"div",29),e._uU(24),e.qZA(),e.TgZ(25,"div",30),e._uU(26,"FECHA"),e.qZA(),e.TgZ(27,"div",26),e._uU(28),e.ALo(29,"date"),e.qZA(),e.TgZ(30,"div",30),e._uU(31,"VENCIMIENTO"),e.qZA(),e.TgZ(32,"div",26),e._uU(33),e.ALo(34,"date"),e.qZA(),e.TgZ(35,"div",30),e._uU(36,"TOTAL"),e.qZA(),e.TgZ(37,"div",26),e._uU(38),e.ALo(39,"currency"),e.qZA(),e.TgZ(40,"div",30),e._uU(41,"ESTADO"),e.qZA(),e.TgZ(42,"div",26),e._uU(43),e.qZA()()(),e.TgZ(44,"table",31)(45,"thead")(46,"tr")(47,"th",32),e._uU(48,"CLIENTE"),e.qZA(),e.TgZ(49,"th",33),e._uU(50,"BENEFICIARIO"),e.qZA()()(),e.TgZ(51,"tbody")(52,"tr")(53,"td",34)(54,"div",35)(55,"div",26),e._uU(56),e.qZA(),e.TgZ(57,"div"),e._uU(58),e.qZA(),e.TgZ(59,"div"),e._uU(60),e.qZA(),e.TgZ(61,"div"),e._uU(62),e.qZA(),e.TgZ(63,"div"),e._uU(64),e.qZA(),e.TgZ(65,"div"),e._uU(66),e.qZA()()(),e.TgZ(67,"td")(68,"div",36)(69,"div",26),e._uU(70),e.qZA(),e.TgZ(71,"div"),e._uU(72),e.qZA(),e.TgZ(73,"div"),e._uU(74),e.qZA(),e.TgZ(75,"div"),e._uU(76),e.qZA(),e.TgZ(77,"div"),e._uU(78),e.qZA(),e.TgZ(79,"div"),e._uU(80),e.qZA()()()()()(),e.TgZ(81,"div",37)(82,"div",38),e._uU(83,"PRODUCTO"),e.qZA(),e.TgZ(84,"div",39),e._uU(85,"CANTIDAD"),e.qZA(),e.TgZ(86,"div",40),e._uU(87,"PRECIO"),e.qZA(),e.TgZ(88,"div",41),e._uU(89,"TOTAL"),e.qZA(),e.YNc(90,oa,15,13,"ng-container",42),e._UZ(91,"div",43),e.TgZ(92,"div",44),e._uU(93,"SUBTOTAL"),e.qZA(),e.TgZ(94,"div",45),e._uU(95),e.ALo(96,"currency"),e.qZA(),e._UZ(97,"div",46),e.TgZ(98,"div",44),e._uU(99,"DESCUENTO"),e.qZA(),e.TgZ(100,"div",45),e._uU(101),e.ALo(102,"currency"),e.qZA(),e._UZ(103,"div",46),e.TgZ(104,"div",44),e._uU(105,"Recargo"),e.qZA(),e.TgZ(106,"div",45),e._uU(107),e.ALo(108,"currency"),e.qZA(),e._UZ(109,"div",46),e.TgZ(110,"div",44),e._uU(111,"ENV\xcdO"),e.qZA(),e.TgZ(112,"div",45),e._uU(113),e.ALo(114,"currency"),e.qZA(),e._UZ(115,"div",46),e.TgZ(116,"div",47),e._uU(117,"TOTAL "),e.qZA(),e.TgZ(118,"div",48),e._uU(119),e.ALo(120,"currency"),e.qZA()(),e.TgZ(121,"div",49)(122,"div",26),e._uU(123,"\xa1Muchas gracias por su compra!"),e.qZA(),e.TgZ(124,"div",50),e._UZ(125,"img",51),e.TgZ(126,"div",52),e._uU(127,' "La devoluci\xf3n de los fondos depende de la pol\xedtica de devoluciones del vendedor y no es responsabilidad de la empresa que facilita la plataforma de comercio electr\xf3nico." '),e.qZA()()()(),e.BQk()),2&o){const t=e.oxw().ngIf;e.xp6(9),e.Oqu(t.merchant.name),e.xp6(2),e.Oqu(t.merchant.address),e.xp6(2),e.AsE("provincia ",t.merchant.state,", municipio ",t.merchant.city,""),e.xp6(2),e.Oqu(t.merchant.phone),e.xp6(2),e.Oqu(t.merchant.email),e.xp6(2),e.Oqu(t.merchant.website),e.xp6(5),e.Oqu(t.no),e.xp6(4),e.Oqu(e.xi3(29,32,t.createdAt,"dd/MM/yyyy")),e.xp6(5),e.Oqu(e.xi3(34,35,t.createdAt,"dd/MM/yyyy")),e.xp6(5),e.Oqu(e.Dn7(39,38,t.total,t.currency.iso+" ","symbol")),e.xp6(5),e.Oqu(t.status),e.xp6(13),e.hij("",t.client.fullname," "),e.xp6(2),e.hij("ID: ",t.client.idNumber,""),e.xp6(2),e.hij("Direcci\xf3n: ",t.client.address,""),e.xp6(2),e.AsE("Estado: ",t.client.state,", Ciudad: ",t.client.city,""),e.xp6(2),e.hij("Tel.: ",t.client.cell,""),e.xp6(2),e.hij("Correo electr\xf3nico: ",t.client.email,""),e.xp6(4),e.Oqu(t.beneficiary.fullname),e.xp6(2),e.hij("ID: ",t.beneficiary.idNumber,""),e.xp6(2),e.hij("Direcci\xf3n: ",t.beneficiary.address,""),e.xp6(2),e.AsE("Provincia: ",t.beneficiary.state,", Municipio: ",t.beneficiary.city," "),e.xp6(2),e.hij("Tel.: ",t.beneficiary.phone,""),e.xp6(2),e.hij("Correo electr\xf3nico: ",t.beneficiary.email,""),e.xp6(10),e.Q6J("ngForOf",t.productsInOrder),e.xp6(5),e.hij("",e.Dn7(96,42,t.subtotal,t.currency.iso+" ","symbol")," "),e.xp6(6),e.hij("",e.Dn7(102,46,t.discount,t.currency.iso+" ","symbol")," "),e.xp6(6),e.Oqu(e.Dn7(108,50,t.tax,t.currency.iso+" ","symbol")),e.xp6(6),e.hij("",e.Dn7(114,54,t.shippingCost,t.currency.iso+" ","symbol")," "),e.xp6(6),e.hij("",e.Dn7(120,58,t.total,t.currency.iso+" ","symbol")," ")}}function ia(o,i){if(1&o&&(e.ynx(0),e.YNc(1,na,128,62,"ng-container",3),e.BQk()),2&o){const t=i.ngIf;e.xp6(1),e.Q6J("ngIf",null!==t)}}const aa=[{path:"",component:Do},{path:"uoms",component:Fr.B,resolve:{uoms:Ur.d}},{path:"request",component:Sr,resolve:{requests:we.r}},{path:"request/:requestId",component:qi,resolve:{request:we.N}},{path:"payment-ways",component:jn,resolve:{paymentMethod:zn}},{path:"quotations",component:Ci,resolve:{quotations:Ie.S}},{path:"quotations/:quotationId",component:Hn,resolve:{quotation:Ie.x}},{path:"invoices",component:pn,resolve:{quotations:xe.l}},{path:"invoices/:invoiceId",component:Oo,resolve:{quotation:xe.u}},{path:"orders",component:Jr,resolve:{orders:Mr},children:[{path:"",component:(()=>{class o{constructor(t,n,r,s,c,d){this._changeDetectorRef=t,this._fileSaverService=n,this._ordersService=r,this._router=s,this._snackBar=c,this.store=d,this.alertTitle=null,this.canceled=!1,this.delivered=!1,this.isLoading=!1,this.order=null,this.orders=[],this.orders$=(0,Z.of)([]),this.payed=!1,this.ready=!1,this.roles=[],this.searchInputControl=new a.NI,this.selectedOrder=null,this.shipped=!1,this._unsubscribeAll=new I.x}ngOnInit(){this.store.select(D.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.orders$=this.store.select(ie),this.orders$.subscribe(t=>this.orders=t),this.store.select(D.B).pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,J.b)(900),(0,b.w)(t=>this._ordersService.getOrders(0,10,"orderNo","asc",t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0,this.closeDetails()}),(0,Y.T)(this._sort.sortChange,this._paginator.page).pipe((0,b.w)(()=>(this.closeDetails(),this._ordersService.getOrders(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction)))).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDetails(){this.selectedOrder=null}exportAsExcelFile(){this._fileSaverService.exportAsExcelFile(this.orders,"orders")}exportAsCsvFile(){this._fileSaverService.exportAsCsvFile(this.orders,"orders")}updatedOrderStatus(t,n){this._ordersService.updateOrderStatus({id:t,status:n}).pipe((0,u.R)(this._unsubscribeAll)).subscribe(({data:r})=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{title:"Confirmaci\xf3n",message:r.updateOrderStatus.message,type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})}viewPurchaseOrder(t){this._router.navigateByUrl(`/modules/commercial/orders/invoice/${t}`)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(Lr.m),e.Y36(re),e.Y36(g.F0),e.Y36(q.ux),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["selling-orders-list"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Br,5),e.Gf(A.NW,5),e.Gf(v.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.htmlOrderList=r.first),e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:34,vars:13,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"flex","flex-col","flex-wrap","p-6","py-8","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-10","bg-mine-50","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"text-2xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:overflow-y-auto","sm:mb-18"],[4,"ngIf"],["noOrders",""],[4,"ngIf","ngIfElse"],[1,"grid","overflow-auto"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","orders-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"",3,"mat-sort-header"],[1,"text-center","md:block"],[1,"xl:block"],[1,"text-right","sm:block"],[1,"text-center"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","page","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","orders-grid","md:px-8"],[1,""],[1,"text-center","truncate","md:block"],[1,"truncate","xl:block"],[1,"flex","items-center","justify-center"],[1,"inline-flex","items-center","font-bold","text-xs","px-2.5","py-0.5","rounded-full","tracking-wide","uppercase",3,"ngClass"],[1,"leading-relaxed","whitespace-nowrap"],[1,"flex","flex-row","items-center","justify-center","gap-1"],["mat-stroked-button","","matTooltip","Ver orden",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","aria-label","Estados de la orden",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor"],["xPosition","before"],["orderMenu","matMenu"],["mat-menu-item","",3,"disabled","click"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",5),e._uU(11,"Ventas"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",7),e._uU(15,"\xd3rdenes"),e.qZA()(),e.TgZ(16,"div",8)(17,"a",9),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",10),e._uU(20,"Regresar"),e.qZA()()()()(),e.TgZ(21,"div",11)(22,"h2",12),e._uU(23," Listado de \xf3rdenes "),e.qZA()()(),e.TgZ(24,"div",13)(25,"mat-form-field",14),e._UZ(26,"mat-icon",15)(27,"input",16),e.qZA()()(),e.TgZ(28,"div",17)(29,"div",18),e.YNc(30,Kr,2,2,"ng-container",19),e.ALo(31,"async"),e.YNc(32,Xr,2,0,"ng-template",null,20,e.W1O),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("routerLink","/home"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink","/selling/panels"),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(8),e.Q6J("svgIcon","mat_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar \xf3rdenes"),e.xp6(3),e.Q6J("ngIf",e.lcZ(31,11,n.orders$)))},dependencies:[g.rH,g.yS,m.mk,m.sg,m.O5,a.Fj,a.JJ,a.oH,y.lW,C.Hw,p.KE,p.qo,Q.Nt,M.VK,M.OP,M.p6,A.NW,v.YE,v.nU,O.gM,m.Ov,m.JJ,m.uU],styles:[".orders-grid{grid-template-columns:75px 75px 180px 180px 150px 150px auto}\n"],encapsulation:2,data:{animation:P.L},changeDetection:0}),o})()},{path:"invoice/:orderId",component:(()=>{class o{constructor(t,n,r,s){this._activatedRoute=t,this._changeDetectorRef=n,this._router=r,this.store=s,this.order$=(0,Z.of)(null),this._unsubscribeAll=new I.x}ngOnInit(){this.order$=this.store.select(Or)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}printDocument(){window.print()}getProductQty(t,n){return n.find(r=>r.productId===t).quantity}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz),e.Y36(e.sBO),e.Y36(g.F0),e.Y36(x.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["selling-invoice"]],decls:13,vars:7,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","text-center","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","py-8","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:px-10","bg-mine-50","dark:bg-transparent","print:hidden"],[1,"flex-1","min-w-0"],[4,"ngIf"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-raised-button","","mat-button","",1,"ml-4","text-white","bg-primary-500",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"inline-block","p-6","text-left","sm:p-10","print:p-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"ml-1","text-primary-700",3,"routerLink"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-700"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","text-left","truncate","md:text-4xl","sm:leading-10"],[1,"p-16","shadow","w-240","min-w-240","rounded-2xl","bg-card","print:w-auto","print:p-0","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start"],[1,"grid","place-items-start"],[1,"grid","grid-flow-col","auto-cols-max","gap-x-8"],[1,"w-24","place-self-center"],["src","assets/images/logo/logo.svg",1,"w-24"],[1,"pl-10","border-l","text-md"],[1,"font-medium"],[1,"grid","grid-cols-2","ml-auto","gap-x-4","gap-y-1"],[1,"text-2xl","font-medium","tracking-tight","justify-self-end","text-secondary"],[1,"text-2xl","font-medium"],[1,"font-medium","tracking-tight","justify-self-end","text-secondary"],[1,"w-full","mt-10"],[1,"px-10"],[1,"pl-10"],[1,"border-r"],[1,"flex","flex-col","px-10","text-md"],[1,"flex","flex-col","pl-10","text-md"],[1,"grid","grid-cols-12","mt-16","gap-x-1"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"font-medium","text-right","text-md","text-secondary"],[1,"col-span-2","font-medium","text-right","text-md","text-secondary"],[1,"col-span-3","font-medium","text-right","text-md","text-secondary"],[4,"ngFor","ngForOf"],[1,"col-span-12","mt-16"],[1,"self-center","col-span-10","font-medium","tracking-tight","text-secondary"],[1,"col-span-2","text-lg","text-right"],[1,"col-span-12","my-3","border-b"],[1,"self-center","col-span-10","text-2xl","font-medium","tracking-tight","text-secondary"],[1,"col-span-2","text-2xl","font-medium","text-right"],[1,"mt-16"],[1,"flex","items-start","mt-4"],["src","assets/images/logo/logo.svg",1,"w-10","mt-2","flex-0"],[1,"ml-6","text-sm","text-secondary"],[1,"col-span-12","my-4","border-b"],[1,"col-span-6"],[1,"text-lg","font-medium"],[1,"mt-2","text-md","text-secondary"],[1,"self-center","text-right"],[1,"self-center","col-span-2","text-right"],[1,"self-center","col-span-3","text-right"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,ta,26,10,"ng-container",3),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"div",4)(6,"button",5),e.NdJ("click",function(){return n.printDocument()}),e._UZ(7,"mat-icon",6),e.TgZ(8,"span",7),e._uU(9,"Imprimir"),e.qZA()()()(),e.TgZ(10,"div",8),e.YNc(11,ia,2,1,"ng-container",3),e.ALo(12,"async"),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("ngIf",e.lcZ(4,3,n.order$)),e.xp6(4),e.Q6J("svgIcon","mat_solid:print"),e.xp6(4),e.Q6J("ngIf",e.lcZ(12,5,n.order$)))},dependencies:[g.yS,m.sg,m.O5,w.PQ,y.lW,C.Hw,m.Ov,m.H9,m.uU],encapsulation:2,changeDetection:0}),o})(),resolve:{order:Yr}}]}];var sa=l(76863),ca=l(6826);let la=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(aa),Jo,sa.K,ca.b,se.m]}),o})()}}]);