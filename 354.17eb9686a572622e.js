"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[354],{74062:(L,O,e)=>{e.d(O,{i:()=>d});class d{constructor(x){this.slug=this._slugGenerator(x)}_slugGenerator(x){return x.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace("  "," ").replace(" ","-")}}},2491:(L,O,e)=>{e.d(O,{L:()=>s});var d=e(93075);class s{static isEmptyInputValue(n){return null==n||0===n.length}static mustMatch(n,o){return a=>{const E=a.get(n),g=a.get(o);if(!E||!g||(g.hasError("mustMatch")&&(delete g.errors.mustMatch,g.updateValueAndValidity()),this.isEmptyInputValue(g.value)||E.value===g.value))return null;const l={mustMatch:"Las contrase\xf1a no coinciden."};return g.setErrors(l),l}}static strongPassWord(n,o,a,E,g){return l=>{const t=l.value;if(!t)return null;const p=!n||/[A-Z]+/.test(t),h=!o||/[a-z]+/.test(t),m=!a||/[0-9]+/.test(t),i=!E||!/^[a-zA-Z0-9]+$/.test(t);return p&&h&&m&&i&&t.length>=g?null:{password:"La contrase\xf1a no cumple con los est\xe1ndares de seguridad requeridos"}}}static onlyNumber(n){return o=>{const a=o.get(n);if(!a||!a.value||(a.hasError("onlyNumber")&&(delete a.errors.onlyNumber,a.updateValueAndValidity()),/^[a-zA-Z0-9]+$/.test(a.value.toString())))return null;const g={onlyNumber:"Solo se admiten n\xfameros."};return console.log(g),a.setErrors(g),g}}static strongPasWordPattern(){return d.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)}static emailPattern(){return d.kI.pattern("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$")}static onlyNumbersPattern(){return d.kI.pattern("^[0-9]*$")}static numbersAndDecimalsPattern(){return d.kI.pattern(/^-?\d*[.,]?\d{0,2}$/)}static onlyAlphabetsWithAccentPattern(){return d.kI.pattern("^[a-zA-Z \xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda\xf1\xd1\xfc\xdc]*$")}static onlyAlphabetsPattern(){return d.kI.pattern("^[a-zA-Z ]*$")}static validateIdNumber(){return n=>{if(!n)return null;let o=n.value;if(!o)return null;void 0!==n.value.idNumber&&(o=n.value.idNumber);const a=parseInt(o.substring(0,2),10),E=parseInt(o.substring(2,4),10)-1,g=parseInt(o.substring(4,6),10),l=new Date(a,E,g);if(l.getFullYear().toString().substring(2,4)===a.toString()&&l.getMonth()===E&&l.getDate()===g)return null;const p={validateIdNumber:"El n\xfamero de identidad introducido es incorrecto"};return n.setErrors(p),p}}static validFullName(n){return o=>{const a=o.get(n);if(!a||!n||(a.hasError("validFullName")&&(delete a.errors.validFullName,a.updateValueAndValidity()),this._isEmptyInputValue(a.value))||a.value.trim().split(" ").length>1)return null;const E={validFullName:"El nombre completo deber\xe1 tener al menos un nombre y un apellido"};return a.setErrors(E),E}}static checkOnSaleQty(n,o){return a=>{const E=a.get(n),g=a.get(o);if(!E||!g||(g.hasError("invalid")&&(delete g.errors.invalid,g.updateValueAndValidity()),E.value>=g.value))return null;const l={invalid:"La cantidad en venta no debe ser mayor a la disponible"};return g.setErrors(l),l}}static luhnValidator(){return n=>n.value?this.luhnCheck(n.value)?null:{luhnCheck:"Formato no v\xe1lido"}:null}static _isEmptyInputValue(n){return null==n||0===n.length}static luhnCheck(n){if(!n||!n.length)return!1;n=n.replace(/\s/g,"");const o=Number(n[n.length-1]),a=n.slice(0,n.length-1).split("").reverse().map(g=>Number(g));let E=0;for(let g=0;g<=a.length-1;g+=2)a[g]=2*a[g],a[g]>9&&(a[g]=a[g]-9);return E=a.reduce((g,l)=>g+l,0),(E+o)%10==0}}},33005:(L,O,e)=>{e.d(O,{YP:()=>x,ZQ:()=>n});var d=e(85094);const s=o=>o.productServices,x=(0,d.P1)(s,o=>o.productService),n=(0,d.P1)(s,o=>o.productServices)},42834:(L,O,e)=>{e.d(O,{z:()=>p});var d=e(40520),s=e(18505),x=e(75714),n=e(92340),o=e(5057),a=e(20755),E=e(5e3),g=e(1235),l=e(85094);const t=n.N.API_URL;let p=(()=>{class h{constructor(i,r,f){this._httpClient=i,this.rolesService=r,this.store=f}getProductServices(i=0,r=20,f="active",I="desc",C=""){const P=(new d.LE).append("page",i).append("size",r).append("sort",f).append("order",I).append("search",C);return this._httpClient.get(`${t}/goods/`,{params:P}).pipe((0,s.b)(M=>{this.store.dispatch((0,x.Jr)({pagination:M.pagination})),this.store.dispatch((0,o.C5)({productServices:M.dataArr}))}))}getPublicActiveGoods(i=0,r=15,f="createdAt",I="desc",C="",P={city:"",state:"",range:{start:0,end:1e4},type:null,uomId:""},M=!1){const q=(new d.LE).append("page",i).append("size",r).append("sort",f).append("order",I).append("search",C).append("state",P.state).append("city",P.city).append("type",P.type).append("uomId",P.uomId).append("start",P.range.start).append("end",P.range.end);return this._httpClient.get(`${t}/goods/public/active`,{params:q}).pipe((0,s.b)(b=>{this.store.dispatch((0,x.Jr)({pagination:b.pagination})),this.store.dispatch(M?(0,o.yu)({productServices:b.dataArr}):(0,o.C5)({productServices:b.dataArr}))}))}getActiveProductServices(){return this._httpClient.get(`${t}/goods/active`).pipe((0,s.b)(i=>{this.store.dispatch((0,o.C5)({productServices:i.dataArr}))}))}getPublicProductServicesByMerchantId(i,r=0,f=10,I="active",C="desc",P="",M=!1){const q=(new d.LE).append("page",r).append("size",f).append("sort",I).append("order",C).append("search",P);return this._httpClient.get(`${t}/goods/public/by-merchantId/${i}`,{params:q}).pipe((0,s.b)(b=>{this.store.dispatch((0,x.Jr)({pagination:b.pagination})),this.store.dispatch((0,a.p5)({merchant:b.data})),this.store.dispatch(M?(0,o.yu)({productServices:b.dataArr}):(0,o.C5)({productServices:b.dataArr}))}))}getPublicProductServiceById(i){return this._httpClient.get(`${t}/goods/public/by-id/${i}`).pipe((0,s.b)(r=>{this.store.dispatch((0,o.Fl)({productService:r.data}))}))}getProductServiceById(i){return this._httpClient.get(`${t}/goods/${i}`).pipe((0,s.b)(r=>{this.store.dispatch((0,o.Fl)({productService:r.data}))}))}createProductService(i){return this._httpClient.post(`${t}/goods`,i).pipe((0,s.b)(r=>{this.store.dispatch((0,o.QI)({productService:r.data}))}))}updateProductService(i){return this._httpClient.patch(`${t}/goods/${i._id}`,i).pipe((0,s.b)(r=>{this.store.dispatch((0,o.pF)({productService:r.data}))}))}deleteProductService(i,r=0,f=20,I="active",C="desc",P=""){const M=(new d.LE).append("page",r).append("size",f).append("sort",I).append("order",C).append("search",P);return this._httpClient.delete(`${t}/goods/${i}`,{params:M}).pipe((0,s.b)(q=>{this.store.dispatch((0,x.Jr)({pagination:q.pagination})),this.store.dispatch((0,o.C5)({productServices:q.dataArr}))}))}}return h.\u0275fac=function(i){return new(i||h)(E.LFG(d.eN),E.LFG(g.cM),E.LFG(l.yh))},h.\u0275prov=E.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},31915:(L,O,e)=>{e.d(O,{_:()=>$});var d=e(54787),s=e(77579),x=e(82722),n=e(27939),o=e(58493),a=e(54641),g=e(15439),l=e.n(g),t=e(5e3),p=e(85094),h=e(69808),m=e(35357),i=e(29071),r=e(47423),f=e(25245);function I(c,T){if(1&c){const u=t.EpF();t.TgZ(0,"div",38)(1,"button",39),t.NdJ("click",function(){t.CHM(u);const S=t.oxw();return t.KtG(S.generatePDF("open"))}),t._UZ(2,"mat-icon",40),t.qZA(),t.TgZ(3,"button",39),t.NdJ("click",function(){t.CHM(u);const S=t.oxw();return t.KtG(S.generatePDF("download"))}),t._UZ(4,"mat-icon",40),t.qZA(),t.TgZ(5,"button",39),t.NdJ("click",function(){t.CHM(u);const S=t.oxw();return t.KtG(S.generatePDF("print"))}),t._UZ(6,"mat-icon",40),t.qZA()()}2&c&&(t.xp6(2),t.Q6J("svgIcon","heroicons_outline:eye"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:download"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:printer"))}const C=function(){return[""]};function P(c,T){if(1&c&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&c){const u=T.$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,u.total,t.DdM(5,C))," ",u.currency,"")}}function M(c,T){if(1&c&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&c){const u=t.oxw();t.xp6(1),t.hij(" ",u.merchantInvoice.phoneNumbers[0].stateCode+" "+u.merchantInvoice.phoneNumbers[0].phoneNumber,"")}}function q(c,T){if(1&c&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&c){const u=t.oxw();t.xp6(1),t.Oqu(u.merchantInvoice.emails[0].email)}}function b(c,T){if(1&c&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&c){const u=t.oxw();t.xp6(1),t.Oqu(u.divInSpaces())}}function F(c,T){if(1&c&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&c){const u=t.oxw();t.xp6(1),t.lnq("",u.requestQuotation.address,", ",u.requestQuotation.city,", ",u.requestQuotation.state,", Cuba ")}}const j=function(){return["$"]};function k(c,T){if(1&c&&(t.TgZ(0,"div",41),t._UZ(1,"div",42),t.TgZ(2,"div",43),t._uU(3),t.qZA(),t.TgZ(4,"div",44),t._uU(5),t.qZA(),t.TgZ(6,"div",45),t._uU(7),t.ALo(8,"currency"),t.qZA(),t.TgZ(9,"div",45),t._uU(10),t.ALo(11,"currency"),t.qZA()()),2&c){const u=T.$implicit;t.xp6(3),t.Oqu(u.name),t.xp6(2),t.Oqu(u.amount),t.xp6(2),t.AsE("",t.xi3(8,5,u.price,t.DdM(11,C))," ",u.currency,""),t.xp6(3),t.Oqu(t.xi3(11,8,u.quantity,t.DdM(12,j)))}}function R(c,T){1&c&&t._UZ(0,"div",46)}const z=function(c,T){return{"my-4":c,"my-3":T}};function D(c,T){if(1&c&&t._UZ(0,"div",47),2&c){const u=t.oxw();t.Q6J("ngClass",t.WLB(1,z,u.quotationInvoice.description,!u.quotationInvoice.description))}}function U(c,T){if(1&c&&(t.TgZ(0,"div",48),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&c){const u=T.$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,u.total,t.DdM(5,C))," ",u.currency,"")}}function B(c,T){1&c&&(t.TgZ(0,"div",49),t._uU(1," OBSERVACIONES"),t.qZA())}function Q(c,T){if(1&c&&(t.TgZ(0,"span",50),t._uU(1),t.qZA()),2&c){const u=t.oxw();t.xp6(1),t.Oqu(u.quotationInvoice.description)}}function K(c,T){if(1&c&&(t.TgZ(0,"div",51)(1,"div",52)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5,"-"),t.qZA()(),t.TgZ(6,"span",53),t._uU(7),t.qZA()()),2&c){const u=T.$implicit;t.xp6(3),t.hij("",u.percent,"%"),t.xp6(4),t.Oqu(u.description)}}function N(c,T){if(1&c&&(t.TgZ(0,"div",56)(1,"span",57),t._uU(2),t.qZA(),t._UZ(3,"img",58),t.qZA()),2&c){const u=t.oxw(2);t.xp6(2),t.Oqu(u.eQr.name),t.xp6(1),t.Q6J("src",u.eQr.qrUrl,t.LSH)}}function J(c,T){if(1&c&&(t.TgZ(0,"div",56)(1,"span",57),t._uU(2),t.qZA(),t._UZ(3,"img",58),t.qZA()),2&c){const u=t.oxw(2);t.xp6(2),t.Oqu(u.tQr.name),t.xp6(1),t.Q6J("src",u.tQr.qrUrl,t.LSH)}}function A(c,T){if(1&c&&(t.TgZ(0,"div",54),t.YNc(1,N,4,2,"div",55),t.YNc(2,J,4,2,"div",55),t.qZA()),2&c){const u=t.oxw();t.xp6(1),t.Q6J("ngIf",u.eQr),t.xp6(1),t.Q6J("ngIf",u.tQr)}}const Z=function(c,T){return[c,T]},v=function(c,T){return{"text-lg":c,"text-2xl":T}},y=function(c,T){return{"col-span-3":c,"col-span-2":T}};a.vfs=o.I.vfs,l().locale("es");let $=(()=>{class c{constructor(u,_){this.store=u,this._changeDetectorRef=_,this.selectedInvoice$=null,this.selectedInvoice=null,this.authUser=null,this.eQr=null,this.tQr=null,this.totalQuantity=[],this._unsubscribeAll=new s.x}ngOnInit(){this.store.select(d.rk).pipe((0,x.R)(this._unsubscribeAll)).subscribe(u=>{this.linkRequest=u?"/modules/commercial/quotations":"/public/quotation",this.authUser=u,this._changeDetectorRef.markForCheck()}),this.selectedInvoice$=this.store.select(n.xF),this.selectedInvoice$.pipe((0,x.R)(this._unsubscribeAll)).subscribe(u=>{this.selectedInvoice=u,this.merchantInvoice=u.merchantId,this.quotationInvoice=u.quotationId,this.requestQuotation=this.quotationInvoice.requestId,this.totalQuantity=this.getTotalQuantity(this.quotationInvoice);const _=this.selectedInvoice.merchantId;_.commercialManagement.enzonaQr&&(this.eQr={name:"Enzona",qrUrl:_.commercialManagement.enzonaQr}),_.commercialManagement.transfermovilQr&&(this.tQr={name:"Transfermovil",qrUrl:_.commercialManagement.transfermovilQr}),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(u){const S={content:[{columns:[{stack:[{columns:[{stack:[{text:"FACTURA",fontSize:16},{text:"VALIDEZ",margin:[0,4,0,0],fontSize:9},{text:"ESTADO",margin:[0,4,0,0],fontSize:9},{text:"IMPORTE TOTAL",margin:[0,4,0,0],fontSize:9}],width:100,color:"#7b838e"},{stack:[{text:this.selectedInvoice.no,alignment:"left",fontSize:16,margin:[0,0,0,0],bold:!0},{text:this.getValidity(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{text:this.selectedInvoice.status.toUpperCase(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{stack:[...this.totalQuantity.map(W=>[{text:`${W.total.toFixed(2)} ${W.currency}`,alignment:"left",bold:!0,opacity:.7,fontSize:9}])],margin:[0,4,0,0]}]}]},{columns:[{text:"OFERTA",margin:[0,4,0,0],fontSize:9,width:100,color:"#7b838e"},{text:this.selectedInvoice.quotationNo,margin:[0,4,0,0],alignment:"left",fontSize:9}],width:320}],width:320},{columns:[this.merchantInvoice.logoUrl?{image:"logo",width:60,alignment:"center",margin:[0,10,15,0]}:{},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:80,lineWidth:.5}],width:1},{stack:[{text:this.merchantInvoice.name,alignment:"left",fontSize:8,bold:!0},{text:`${this.merchantInvoice.address}  ${this.merchantInvoice.city}   ${this.merchantInvoice.state}   ${this.merchantInvoice.country}`,alignment:"left",fontSize:8},this.merchantInvoice.phoneNumbers.length>0?{text:`${this.merchantInvoice.phoneNumbers[0].stateCode}  ${this.merchantInvoice.phoneNumbers[0].phoneNumber}`,alignment:"left",fontSize:8}:{},this.merchantInvoice.emails.length>0?{text:`${this.merchantInvoice.emails[0].email}`,alignment:"left",fontSize:8}:{},{text:this.merchantInvoice.website,alignment:"left",fontSize:8},this.quotationInvoice.paymentMethodData.includeBankAccount?{text:this.divInSpaces(),alignment:"left",fontSize:8}:{}],margin:[15,2,0,0],lineHeight:1.2,alignment:"right"}],margin:[0,4,0,0]}]},{stack:[{text:`${this.requestQuotation.name}  ${this.requestQuotation.lastname}`,alignment:"left",fontSize:12,lineHeight:1.2,bold:!0,opacity:.8},this.requestQuotation.address?{text:`${this.requestQuotation.address}, ${this.requestQuotation.city}, ${this.requestQuotation.state}, Cuba`,alignment:"left",lineHeight:1.2,fontSize:8}:{},{text:`${this.requestQuotation.phoneNumber.stateCode} ${this.requestQuotation.phoneNumber.phoneNumber}`,alignment:"left",lineHeight:1.2,fontSize:8},{text:this.requestQuotation.email,alignment:"left",lineHeight:1.2,fontSize:8}],margin:[0,20,0,0]},{columns:[{text:"PRODUCTO O SERVICIO",color:"#64748B",alignment:"left",fontSize:8,width:350},{text:"CANTIDAD",color:"#64748B",alignment:"center",fontSize:8,width:40},{text:"PRECIO",color:"#64748B",alignment:"right",fontSize:8,width:70},{text:"TOTAL",color:"#64748B",alignment:"right",fontSize:8}],margin:[0,35,0,5]},...this.quotationInvoice.goodsData.map(W=>[{stack:[{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:W.name,alignment:"left",fontSize:9,bold:!0,opacity:.7,width:350},{text:W.amount,alignment:"center",fontSize:9,width:40},{text:`${W.price.toFixed(2)} ${W.currency}`,alignment:"right",fontSize:9,width:70},{text:`$${W.quantity.toFixed(2)}`,alignment:"right",fontSize:9}],margin:[0,4,0,4]}]}]),{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:"Total",alignment:"left",fontSize:9,color:"#7b838e"},{stack:[...this.totalQuantity.map(W=>[{text:`${W.total.toFixed(2)} ${W.currency}`,alignment:"right",bold:!0,opacity:.7,fontSize:9}])]}],margin:[0,5,0,0]},this.quotationInvoice.description?{stack:[{text:"OBSERVACIONES",color:"#64748B",alignment:"left",fontSize:8},{text:this.quotationInvoice.description,alignment:"left",fontSize:9,margin:[0,2,0,0]}],margin:[0,25,0,0]}:{}],footer:(W,w,Y)=>[{stack:[{text:"T\xe9rminos o condiciones de pago.",alignment:"left",fontSize:9,bold:!0,opacity:.9},{columns:[this.merchantInvoice.logoUrl?{image:"logo",width:20,alignment:"center"}:{},{layout:"noBorders",lineHeight:1,table:{headerRows:0,widths:[15,2,"*"],body:[...this.quotationInvoice.paymentMethodData.terms.map(V=>[{text:`${V.percent}%`,alignment:"left",fontSize:6,opacity:.6},{text:"-",alignment:"left",fontSize:6,opacity:.6},{text:V.description,alignment:"left",fontSize:6,opacity:.6}])]},margin:[10,0,0,0]},"UseMerchantPayments"===this.quotationInvoice.paymentMethodData.paymentBy?{stack:[{columns:[this.merchantInvoice.commercialManagement.transfermovilQr?{stack:[],width:1}:{stack:[],width:55},this.merchantInvoice.commercialManagement.enzonaQr?{stack:[{text:"Enzona",alignment:"center",fontSize:8,opacity:.6,bold:!0,margin:[0,0,0,2]},{image:"enzonaUrl",width:55,alignment:"center"}],margin:[0,-10,0,0]}:{stack:[],width:55},this.merchantInvoice.commercialManagement.transfermovilQr?{stack:[{text:"Transfermovil",alignment:"center",fontSize:8,opacity:.6,bold:!0,margin:[0,0,0,2]},{image:"transfermovilUrl",width:55,alignment:"center"}],margin:[0,-10,0,0]}:{stack:[],width:1}],columnGap:15}],width:150,margin:[15,0,0,0]}:{stack:[],width:1}],margin:[0,8,0,0]}],margin:w>1?[40,30,40,15]:[40,50,40,15]},w>1?{text:W.toString()+" de "+w,alignment:"center"}:{text:"",alignment:"center"},{canvas:[{type:"rect",x:170,y:32,w:Y.width-170,h:40}]}],defaultStyle:{fontSize:12},pageOrientation:"portrait",pageSize:"LETTER",pageMargins:[40,40,40,145],info:{title:"Factura",author:"",subject:"",creationDate:new Date},images:{logo:this.merchantInvoice.logoUrl,enzonaUrl:"UseMerchantPayments"===this.quotationInvoice.paymentMethodData.paymentBy&&this.merchantInvoice.commercialManagement.enzonaQr?this.merchantInvoice.commercialManagement.enzonaQr:"",transfermovilUrl:"UseMerchantPayments"===this.quotationInvoice.paymentMethodData.paymentBy&&this.merchantInvoice.commercialManagement.transfermovilQr?this.merchantInvoice.commercialManagement.transfermovilQr:""}};switch(u){case u="download":a.createPdf(S).download();break;case u="open":a.createPdf(S).open();break;case u="print":a.createPdf(S).print()}}getTotalQuantity(u){return u.goodsData.reduce((_,{currency:S})=>{if(!_.some(W=>W.currency===S)){const W=u.goodsData.filter(w=>w.currency===S).map(w=>w.quantity).reduce((w,Y)=>w+Y,0);_.push({currency:S,total:W})}return _},[])}getValidity(){return`${l()(this.selectedInvoice.createdAt).format("L")} - ${l()(this.selectedInvoice.createdAt).add(this.selectedInvoice.expirationDays,"days").format("L")}`}divInSpaces(){const u=this.selectedInvoice.bankAccount,_=[];for(let S=0;S<u.length;S++)_.push(u.substring(S,S+4)),S+=3;return _.join("-")}}return c.\u0275fac=function(u){return new(u||c)(t.Y36(p.yh),t.Y36(t.sBO))},c.\u0275cmp=t.Xpm({type:c,selectors:[["invoice-details"]],decls:74,vars:47,consts:[["cdkScrollable","",1,"flex","md:justify-center","w-full","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","text-left","print:p-0"],["class","flex items-center flex-shrink-0 mt-6 md:mt-0 sm:ml-4 gap-x-4 justify-end",4,"ngIf"],[1,"w-240","p-16","rounded-2xl","shadow","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start","justify-between"],[1,"whitespace-nowrap","grid","grid-cols-2","gap-y-1",2,"width","260px !important"],[1,"text-3xl","tracking-tight","text-secondary"],[1,"text-2xl","flex","items-center","font-medium"],[1,"font-medium","tracking-tight","text-secondary"],[1,"font-medium"],[4,"ngFor","ngForOf"],[1,"font-medium","text-primary-500","hover:text-primary-700","cursor-pointer",3,"routerLink"],[1,"grid","auto-cols-max","grid-flow-col","gap-x-8","-mr-16","py-6","px-8","rounded-l-2xl","light"],[1,"place-self-center","w-24"],[1,"w-24",3,"src"],[1,"pl-8","overflow-auto","break-word","border-l","text-md",2,"width","220px !important","border-color","black"],[4,"ngIf"],[1,"mt-4","text-md","w-96","pr-8"],[1,"text-xl","font-medium"],[1,"grid","grid-cols-12","gap-x-1","mt-14"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"col-span-2","font-medium","text-md","text-center","text-secondary","pl-10"],[1,"col-span-2","font-medium","text-md","text-right","text-secondary"],["class","col-span-12 grid grid-cols-12 gap-x-1",4,"ngFor","ngForOf"],["class","col-span-12 mt-16",4,"ngIf"],["class","col-span-12  border-b",3,"ngClass",4,"ngIf"],[1,"col-span-10","font-medium","tracking-tight","text-secondary",3,"ngClass"],[1,"flex","flex-col","col-span-2","text-right","font-medium",3,"ngClass"],["class","col-span-2",4,"ngFor","ngForOf"],["class","col-span-8 font-medium text-md mt-10 text-secondary",4,"ngIf"],["class","col-span-12 break-words mt-2",4,"ngIf"],[1,"mt-16","grid","grid-cols-3"],[1,"",3,"ngClass"],[1,"flex","items-start","mt-4"],[1,"flex-0","w-10","mt-1",3,"src"],[1,"flex","flex-col","ml-6","w-full"],["style","grid-template-columns: 45px auto !important;","class","grid grid-cols-2 text-sm text-secondary w-full",4,"ngFor","ngForOf"],["class","col-span-1 flex justify-end gap-8",4,"ngIf"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-end"],["mat-button","",1,"rounded-full",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"col-span-12","grid","grid-cols-12","gap-x-1"],[1,"col-span-12","my-4","border-b"],[1,"col-span-6","text-lg","font-medium"],[1,"col-span-2","self-center","text-center","pl-10"],[1,"col-span-2","self-center","text-right"],[1,"col-span-12","mt-16"],[1,"col-span-12","border-b",3,"ngClass"],[1,"col-span-2"],[1,"col-span-8","font-medium","text-md","mt-10","text-secondary"],[1,"col-span-12","break-words","mt-2"],[1,"grid","grid-cols-2","text-sm","text-secondary","w-full",2,"grid-template-columns","45px auto !important"],[1,"flex","justify-between"],[1,"ml-4"],[1,"col-span-1","flex","justify-end","gap-8"],["class","text-center",4,"ngIf"],[1,"text-center"],[1,"text-md","font-medium","text-secondary"],[1,"w-24","h-24","object-cover","mt-2",3,"src"]],template:function(u,_){1&u&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,I,7,3,"div",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t._uU(7,"FACTURA"),t.qZA(),t.TgZ(8,"div",7),t._uU(9),t.qZA(),t.TgZ(10,"div",8),t._uU(11,"VALIDEZ"),t.qZA(),t.TgZ(12,"div",9),t._uU(13),t.qZA(),t.TgZ(14,"div",8),t._uU(15,"ESTADO"),t.qZA(),t.TgZ(16,"div",9),t._uU(17),t.qZA(),t.TgZ(18,"div",8),t._uU(19,"IMPORTE TOTAL"),t.qZA(),t.TgZ(20,"div",9),t.YNc(21,P,3,6,"div",10),t.qZA(),t.TgZ(22,"div",8),t._uU(23,"OFERTA"),t.qZA(),t.TgZ(24,"a",11),t._uU(25),t.qZA()(),t.TgZ(26,"div",12)(27,"div",13),t._UZ(28,"img",14),t.qZA(),t.TgZ(29,"div",15)(30,"div",9),t._uU(31),t.qZA(),t.TgZ(32,"div"),t._uU(33),t.qZA(),t.YNc(34,M,2,1,"div",16),t.YNc(35,q,2,1,"div",16),t.TgZ(36,"div"),t._uU(37),t.qZA(),t.YNc(38,b,2,1,"div",16),t.qZA()()(),t.TgZ(39,"div",17)(40,"div",18),t._uU(41),t.qZA(),t.YNc(42,F,2,3,"div",16),t.TgZ(43,"div"),t._uU(44),t.qZA(),t.TgZ(45,"div"),t._uU(46),t.qZA()(),t.TgZ(47,"div",19)(48,"div",20),t._uU(49,"PRODUCTO O SERVICIO"),t.qZA(),t.TgZ(50,"div",21),t._uU(51,"CANTIDAD"),t.qZA(),t.TgZ(52,"div",22),t._uU(53,"PRECIO"),t.qZA(),t.TgZ(54,"div",22),t._uU(55,"TOTAL"),t.qZA(),t.YNc(56,k,12,13,"div",23),t.YNc(57,R,1,0,"div",24),t.YNc(58,D,1,4,"div",25),t.TgZ(59,"div",26),t._uU(60,"TOTAL"),t.qZA(),t.TgZ(61,"div",27),t.YNc(62,U,3,6,"div",28),t.qZA(),t.YNc(63,B,2,0,"div",29),t.YNc(64,Q,2,1,"span",30),t.qZA(),t.TgZ(65,"div",31)(66,"div",32)(67,"div",9),t._uU(68,"T\xe9rminos o condiciones de pago."),t.qZA(),t.TgZ(69,"div",33),t._UZ(70,"img",34),t.TgZ(71,"div",35),t.YNc(72,K,8,2,"div",36),t.qZA()()(),t.YNc(73,A,3,2,"div",37),t.qZA()()()()),2&u&&(t.xp6(2),t.Q6J("ngIf",!_.authUser),t.xp6(7),t.hij("#",_.selectedInvoice.no,""),t.xp6(4),t.Oqu(_.getValidity()),t.xp6(4),t.Oqu(_.selectedInvoice.status.toUpperCase()),t.xp6(4),t.Q6J("ngForOf",_.totalQuantity),t.xp6(3),t.Q6J("routerLink",t.WLB(35,Z,_.linkRequest,_.quotationInvoice._id)),t.xp6(1),t.hij("#",_.selectedInvoice.quotationNo,""),t.xp6(3),t.Q6J("src",_.merchantInvoice.logoUrl,t.LSH),t.xp6(3),t.Oqu(_.merchantInvoice.name),t.xp6(2),t.HOy("",_.merchantInvoice.address,", ",_.merchantInvoice.city,", ",_.merchantInvoice.state,", ",_.merchantInvoice.country," "),t.xp6(1),t.Q6J("ngIf",_.merchantInvoice.phoneNumbers.length>0),t.xp6(1),t.Q6J("ngIf",_.merchantInvoice.emails.length>0),t.xp6(2),t.Oqu(_.merchantInvoice.website),t.xp6(1),t.Q6J("ngIf",_.quotationInvoice.paymentMethodData.includeBankAccount),t.xp6(3),t.AsE("",_.requestQuotation.name," ",_.requestQuotation.lastname,""),t.xp6(1),t.Q6J("ngIf",_.requestQuotation.address),t.xp6(2),t.AsE("",_.requestQuotation.phoneNumber.stateCode," ",_.requestQuotation.phoneNumber.phoneNumber,""),t.xp6(2),t.Oqu(_.requestQuotation.email),t.xp6(10),t.Q6J("ngForOf",_.quotationInvoice.goodsData),t.xp6(1),t.Q6J("ngIf",!_.quotationInvoice.description),t.xp6(1),t.Q6J("ngIf",_.quotationInvoice.description),t.xp6(1),t.Q6J("ngClass",t.WLB(38,v,_.quotationInvoice.description,!_.quotationInvoice.description)),t.xp6(2),t.Q6J("ngClass",t.WLB(41,v,_.quotationInvoice.description,!_.quotationInvoice.description)),t.xp6(1),t.Q6J("ngForOf",_.totalQuantity),t.xp6(1),t.Q6J("ngIf",_.quotationInvoice.description),t.xp6(1),t.Q6J("ngIf",_.quotationInvoice.description),t.xp6(2),t.Q6J("ngClass",t.WLB(44,y,!_.eQr&&!_.tQr||"UseMerchantPayments"!==_.quotationInvoice.paymentMethodData.paymentBy,!(!_.eQr&&!_.tQr)&&"UseMerchantPayments"===_.quotationInvoice.paymentMethodData.paymentBy)),t.xp6(4),t.Q6J("src",_.merchantInvoice.logoUrl,t.LSH),t.xp6(2),t.Q6J("ngForOf",_.quotationInvoice.paymentMethodData.terms),t.xp6(1),t.Q6J("ngIf",!(!_.eQr&&!_.tQr)&&"UseMerchantPayments"===_.quotationInvoice.paymentMethodData.paymentBy))},dependencies:[h.mk,h.sg,h.O5,m.yS,i.PQ,r.lW,f.Hw,h.H9],encapsulation:2,changeDetection:0}),c})()},6826:(L,O,e)=>{e.d(O,{b:()=>x});var d=e(17460),s=e(5e3);let x=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=s.oAB({type:n}),n.\u0275inj=s.cJS({imports:[d.m]}),n})()},32567:(L,O,e)=>{e.d(O,{l:()=>E,u:()=>g});var d=e(62843),s=e(70262),x=e(54004),n=e(5e3),o=e(29997),a=e(35357);let E=(()=>{class l{constructor(p){this._invoicesService=p}resolve(p,h){return this._invoicesService.getInvoices()}}return l.\u0275fac=function(p){return new(p||l)(n.LFG(o.x))},l.\u0275prov=n.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})(),g=(()=>{class l{constructor(p,h){this._invoicesService=p,this._router=h}resolve(p,h){return this._invoicesService.getInvoiceById(p.params.invoiceId).pipe((0,s.K)(i=>{console.error(i);const r=h.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(r),(0,d._)(i)}),(0,x.U)(i=>{if(!i.ok){let r=h.url.split("/").slice(0,-1).join("/");h.url.includes("public")&&(r=h.url.split("/").slice(0,-2).join("/")),this._router.navigateByUrl(r)}}))}}return l.\u0275fac=function(p){return new(p||l)(n.LFG(o.x),n.LFG(a.F0))},l.\u0275prov=n.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},27939:(L,O,e)=>{e.d(O,{vm:()=>n,xF:()=>x});var d=e(85094);const s=o=>o.invoices,x=(0,d.P1)(s,o=>o.invoice),n=(0,d.P1)(s,o=>o.invoices)},29997:(L,O,e)=>{e.d(O,{x:()=>t});var d=e(40520),s=e(18505),x=e(75714),n=e(92340),o=e(76995),a=e(5e3),E=e(1235),g=e(85094);const l=n.N.API_URL;let t=(()=>{class p{constructor(m,i,r){this._httpClient=m,this.rolesService=i,this.store=r}getInvoices(m=0,i=20,r="createdAt",f="desc",I="",C=""){const P=(new d.LE).append("page",m).append("size",i).append("sort",r).append("order",f).append("search",I).append("filter",C);return this._httpClient.get(`${l}/invoices/`,{params:P}).pipe((0,s.b)(M=>{this.store.dispatch((0,x.Jr)({pagination:M.pagination})),this.store.dispatch((0,o.Nr)({invoices:M.dataArr}))}))}getInvoiceById(m){return this._httpClient.get(`${l}/invoices/${m}`).pipe((0,s.b)(i=>{this.store.dispatch((0,o.zm)({invoice:i.data}))}))}createInvoice(m){return this._httpClient.post(`${l}/invoices`,m).pipe((0,s.b)(i=>{this.store.dispatch((0,o.Z$)({invoice:i.data}))}))}updateInvoice(m){return this._httpClient.patch(`${l}/invoices/${m._id}`,m).pipe((0,s.b)(i=>{this.store.dispatch((0,o.aL)({invoice:i.data}))}))}updateStatus(m,i,r=""){return this._httpClient.patch(`${l}/invoices/update-status`,{_id:m,status:i,canceledReason:r}).pipe((0,s.b)(f=>{this.store.dispatch((0,o.aL)({invoice:f.data}))}))}deleteInvoice(m,i=0,r=20,f="createdAt",I="desc",C="",P=""){const M=(new d.LE).append("page",i).append("size",r).append("sort",f).append("order",I).append("search",C).append("filter",P);return this._httpClient.delete(`${l}/invoices/${m}`,{params:M}).pipe((0,s.b)(q=>{this.store.dispatch((0,x.Jr)({pagination:q.pagination})),this.store.dispatch((0,o.Nr)({invoices:q.dataArr}))}))}}return p.\u0275fac=function(m){return new(m||p)(a.LFG(d.eN),a.LFG(E.cM),a.LFG(g.yh))},p.\u0275prov=a.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},96679:(L,O,e)=>{e.d(O,{x:()=>t});var d=e(40520),s=e(18505),x=e(54004),n=e(78335),o=e(75714),a=e(92340),E=e(5e3),g=e(85094);const l=a.N.API_URL;let t=(()=>{class p{constructor(m,i){this._httpClient=m,this.store=i}getPaymentWays(m=0,i=20,r="active",f="desc",I=""){const C=(new d.LE).append("page",m).append("size",i).append("sort",r).append("order",f).append("search",I);return this._httpClient.get(`${l}/payment-ways/`,{params:C}).pipe((0,s.b)(P=>{this.store.dispatch((0,o.Jr)({pagination:P.pagination})),this.store.dispatch((0,n.e9)({paymentWays:P.dataArr}))}))}getActivePaymentWays(){return this._httpClient.get(`${l}/payment-ways/active`).pipe((0,x.U)(m=>m.dataArr),(0,s.b)(m=>{this.store.dispatch((0,n.e9)({paymentWays:m}))}))}getPaymentWayById(m){return this._httpClient.get(`${l}/payment-ways/${m}`).pipe((0,s.b)(i=>{this.store.dispatch((0,n.NQ)({paymentWay:i.data}))}))}createPaymentWay(m){return this._httpClient.post(`${l}/payment-ways`,m).pipe((0,s.b)(i=>{this.store.dispatch((0,o.W4)()),this.store.dispatch((0,n.Fh)({paymentWay:i.data}))}))}updatePaymentWay(m){return this._httpClient.patch(`${l}/payment-ways/${m._id}`,m).pipe((0,s.b)(i=>{this.store.dispatch((0,n.op)({paymentWay:i.data}))}))}deletePaymentWay(m,i=0,r=20,f="active",I="desc",C=""){const P=(new d.LE).append("page",i).append("size",r).append("sort",f).append("order",I).append("search",C);return this._httpClient.delete(`${l}/payment-ways/${m}`,{params:P}).pipe((0,s.b)(M=>{this.store.dispatch((0,o.Jr)({pagination:M.pagination})),this.store.dispatch((0,n.e9)({paymentWays:M.dataArr}))}))}}return p.\u0275fac=function(m){return new(m||p)(E.LFG(d.eN),E.LFG(g.yh))},p.\u0275prov=E.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},65453:(L,O,e)=>{e.d(O,{i:()=>J});var d=e(54787),s=e(77579),x=e(82722),n=e(66861),o=e(58493),a=e(54641),g=e(15439),l=e.n(g),t=e(5e3),p=e(85094),h=e(69808),m=e(35357),i=e(29071),r=e(47423),f=e(25245);function I(A,Z){if(1&A){const v=t.EpF();t.TgZ(0,"div",36)(1,"button",37),t.NdJ("click",function(){t.CHM(v);const $=t.oxw();return t.KtG($.generatePDF("open"))}),t._UZ(2,"mat-icon",38),t.qZA(),t.TgZ(3,"button",37),t.NdJ("click",function(){t.CHM(v);const $=t.oxw();return t.KtG($.generatePDF("download"))}),t._UZ(4,"mat-icon",38),t.qZA(),t.TgZ(5,"button",37),t.NdJ("click",function(){t.CHM(v);const $=t.oxw();return t.KtG($.generatePDF("print"))}),t._UZ(6,"mat-icon",38),t.qZA()()}2&A&&(t.xp6(2),t.Q6J("svgIcon","heroicons_outline:eye"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:download"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:printer"))}const C=function(){return[""]};function P(A,Z){if(1&A&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&A){const v=Z.$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,v.total,t.DdM(5,C))," ",v.currency,"")}}function M(A,Z){if(1&A&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&A){const v=t.oxw();t.xp6(1),t.hij(" ",v.merchantQuotation.phoneNumbers[0].stateCode+" "+v.merchantQuotation.phoneNumbers[0].phoneNumber,"")}}function q(A,Z){if(1&A&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&A){const v=t.oxw();t.xp6(1),t.Oqu(v.merchantQuotation.emails[0].email)}}function b(A,Z){if(1&A&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&A){const v=t.oxw();t.xp6(1),t.lnq("",v.requestQuotation.address,", ",v.requestQuotation.city,", ",v.requestQuotation.state,", Cuba ")}}const F=function(){return["$"]};function j(A,Z){if(1&A&&(t.TgZ(0,"div",39),t._UZ(1,"div",40),t.TgZ(2,"div",41),t._uU(3),t.qZA(),t.TgZ(4,"div",42),t._uU(5),t.qZA(),t.TgZ(6,"div",43),t._uU(7),t.ALo(8,"currency"),t.qZA(),t.TgZ(9,"div",43),t._uU(10),t.ALo(11,"currency"),t.qZA()()),2&A){const v=Z.$implicit;t.xp6(3),t.Oqu(v.name),t.xp6(2),t.Oqu(v.amount),t.xp6(2),t.AsE("",t.xi3(8,5,v.price,t.DdM(11,C))," ",v.currency,""),t.xp6(3),t.Oqu(t.xi3(11,8,v.quantity,t.DdM(12,F)))}}function k(A,Z){1&A&&t._UZ(0,"div",44)}const R=function(A,Z){return{"my-4":A,"my-3":Z}};function z(A,Z){if(1&A&&t._UZ(0,"div",45),2&A){const v=t.oxw();t.Q6J("ngClass",t.WLB(1,R,v.selectedQuotation.description,!v.selectedQuotation.description))}}function D(A,Z){if(1&A&&(t.TgZ(0,"div",46),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&A){const v=Z.$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,v.total,t.DdM(5,C))," ",v.currency,"")}}function U(A,Z){1&A&&(t.TgZ(0,"div",47),t._uU(1,"OBSERVACIONES"),t.qZA())}function B(A,Z){if(1&A&&(t.TgZ(0,"span",48),t._uU(1),t.qZA()),2&A){const v=t.oxw();t.xp6(1),t.Oqu(v.selectedQuotation.description)}}function Q(A,Z){if(1&A&&(t.TgZ(0,"div",49)(1,"div",50)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5,"-"),t.qZA()(),t.TgZ(6,"span",51),t._uU(7),t.qZA()()),2&A){const v=Z.$implicit;t.xp6(3),t.hij("",v.percent,"%"),t.xp6(4),t.Oqu(v.description)}}const K=function(A,Z){return[A,Z]},N=function(A,Z){return{"text-lg":A,"text-2xl":Z}};a.vfs=o.I.vfs,l().locale("es");let J=(()=>{class A{constructor(v,y){this.store=v,this._changeDetectorRef=y,this.selectedQuotation$=null,this.selectedQuotation=null,this.authUser=null,this.totalQuantity=[],this._unsubscribeAll=new s.x}ngOnInit(){this.store.select(d.rk).pipe((0,x.R)(this._unsubscribeAll)).subscribe(v=>{this.linkRequest=v?"/modules/commercial/request":"/public/request",this.authUser=v,this._changeDetectorRef.markForCheck()}),this.selectedQuotation$=this.store.select(n.$i),this.selectedQuotation$.pipe((0,x.R)(this._unsubscribeAll)).subscribe(v=>{this.selectedQuotation=v,this.merchantQuotation=v.merchantId,this.requestQuotation=v.requestId,this.totalQuantity=this.getTotalQuantity(v),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(v){const $={content:[{columns:[{stack:[{columns:[{stack:[{text:"OFERTA",fontSize:16},{text:"VALIDEZ",margin:[0,4,0,0],fontSize:9},{text:"ESTADO",margin:[0,4,0,0],fontSize:9},{text:"IMPORTE TOTAL",margin:[0,4,0,0],fontSize:9}],width:100,color:"#7b838e"},{stack:[{text:this.selectedQuotation.no,alignment:"left",fontSize:16,margin:[0,0,0,0],bold:!0},{text:this.getValidity(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{text:this.selectedQuotation.status.toUpperCase(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{stack:[...this.totalQuantity.map(c=>[{text:`${c.total.toFixed(2)} ${c.currency}`,alignment:"left",bold:!0,opacity:.7,fontSize:9}])],margin:[0,4,0,0]}]}],width:320},{columns:[{text:"SOLICITUD",margin:[0,4,0,0],fontSize:9,width:100,color:"#7b838e"},{text:this.selectedQuotation.requestNo,margin:[0,4,0,0],alignment:"left",fontSize:9}],width:320}],width:320},{columns:[this.merchantQuotation.logoUrl?{image:"logo",width:60,alignment:"center",margin:[0,7,15,0]}:{},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:73,lineWidth:.1}],width:1},{stack:[{text:this.merchantQuotation.name,alignment:"left",fontSize:8,bold:!0},{text:`${this.merchantQuotation.address}  ${this.merchantQuotation.city}   ${this.merchantQuotation.state}   ${this.merchantQuotation.country}`,alignment:"left",fontSize:8},this.merchantQuotation.phoneNumbers.length>0?{text:`${this.merchantQuotation.phoneNumbers[0].stateCode}  ${this.merchantQuotation.phoneNumbers[0].phoneNumber}`,alignment:"left",fontSize:8}:{},this.merchantQuotation.emails.length>0?{text:`${this.merchantQuotation.emails[0].email}`,alignment:"left",fontSize:8}:{},{text:this.merchantQuotation.website,alignment:"left",fontSize:8}],margin:[15,2,0,0],lineHeight:1.2,alignment:"right"}],margin:[0,4,0,0]}]},{stack:[{text:`${this.requestQuotation.name}  ${this.requestQuotation.lastname}`,alignment:"left",fontSize:12,lineHeight:1.2,bold:!0,opacity:.8},this.requestQuotation.address?{text:`${this.requestQuotation.address}, ${this.requestQuotation.city}, ${this.requestQuotation.state}, Cuba`,alignment:"left",lineHeight:1.2,fontSize:8}:{},{text:`${this.requestQuotation.phoneNumber.stateCode} ${this.requestQuotation.phoneNumber.phoneNumber}`,alignment:"left",lineHeight:1.2,fontSize:8},{text:this.requestQuotation.email,alignment:"left",lineHeight:1.2,fontSize:8}],margin:[0,20,0,0]},{columns:[{text:"PRODUCTO O SERVICIO",color:"#64748B",alignment:"left",fontSize:8,width:350},{text:"CANTIDAD",color:"#64748B",alignment:"center",fontSize:8,width:40},{text:"PRECIO",color:"#64748B",alignment:"right",fontSize:8,width:70},{text:"TOTAL",color:"#64748B",alignment:"right",fontSize:8}],margin:[0,35,0,5]},...this.selectedQuotation.goodsData.map(c=>[{stack:[{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:c.name,alignment:"left",fontSize:9,bold:!0,opacity:.7,width:350},{text:c.amount,alignment:"center",fontSize:9,width:40},{text:`${c.price.toFixed(2)} ${c.currency}`,alignment:"right",fontSize:9,width:70},{text:`$${c.quantity.toFixed(2)}`,alignment:"right",fontSize:9}],margin:[0,4,0,4]}]}]),{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},{columns:[{text:"Total",alignment:"left",fontSize:9,color:"#7b838e"},{stack:[...this.totalQuantity.map(c=>[{text:`${c.total.toFixed(2)} ${c.currency}`,alignment:"right",bold:!0,opacity:.7,fontSize:9}])]}],margin:[0,5,0,0]},this.selectedQuotation.description?{stack:[{text:"OBSERVACIONES",color:"#64748B",alignment:"left",fontSize:8},{text:this.selectedQuotation.description,alignment:"left",fontSize:9,margin:[0,2,0,0]}],margin:[0,25,0,0]}:{}],footer:(c,T,u)=>[{stack:[{text:"T\xe9rminos o condiciones de pago.",alignment:"left",fontSize:9,bold:!0,opacity:.9},{columns:[this.merchantQuotation.logoUrl?{image:"logo",width:20,alignment:"center"}:{},{layout:"noBorders",lineHeight:1,table:{headerRows:0,widths:[15,2,"*"],body:[...this.selectedQuotation.paymentMethodData.terms.map(_=>[{text:`${_.percent}%`,alignment:"left",fontSize:6,opacity:.6},{text:"-",alignment:"left",fontSize:6,opacity:.6},{text:_.description,alignment:"left",fontSize:6,opacity:.6}])]},margin:[10,0,0,0]}],margin:[0,8,0,0]}],margin:T>1?[40,30,40,15]:[40,70,40,15]},T>1?{text:c.toString()+" de "+T,alignment:"center"}:{text:"",alignment:"center"},{canvas:[{type:"rect",x:170,y:32,w:u.width-170,h:40}]}],defaultStyle:{fontSize:12},pageOrientation:"portrait",pageSize:"LETTER",pageMargins:[40,40,40,145],info:{title:"Oferta",author:"",subject:"",creationDate:new Date},images:{logo:this.merchantQuotation.logoUrl}};switch(v){case v="download":a.createPdf($).download();break;case v="open":a.createPdf($).open();break;case v="print":a.createPdf($).print()}}getTotalQuantity(v){return v.goodsData.reduce((y,{currency:$})=>{if(!y.some(c=>c.currency===$)){const c=v.goodsData.filter(T=>T.currency===$).map(T=>T.quantity).reduce((T,u)=>T+u,0);y.push({currency:$,total:c})}return y},[])}getValidity(){return`${l()(this.selectedQuotation.createdAt).format("L")} - ${l()(this.selectedQuotation.createdAt).add(this.selectedQuotation.expirationDays,"days").format("L")}`}}return A.\u0275fac=function(v){return new(v||A)(t.Y36(p.yh),t.Y36(t.sBO))},A.\u0275cmp=t.Xpm({type:A,selectors:[["quotation-details"]],decls:71,vars:41,consts:[["cdkScrollable","",1,"flex","md:justify-center","w-full","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","text-left","print:p-0"],["class","flex items-center flex-shrink-0 mt-6 md:mt-0 sm:ml-4 gap-x-4 justify-end",4,"ngIf"],[1,"w-240","p-16","rounded-2xl","shadow","bg-card","print:w-auto","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start","justify-between"],[1,"grid","grid-cols-2","gap-y-1","whitespace-nowrap",2,"width","260px !important"],[1,"text-3xl","tracking-tight","text-secondary"],[1,"text-2xl","flex","items-center","font-medium"],[1,"font-medium","tracking-tight","text-secondary"],[1,"font-medium"],[4,"ngFor","ngForOf"],[1,"font-medium","text-primary-500","hover:text-primary-700","cursor-pointer",3,"routerLink"],[1,"grid","auto-cols-max","grid-flow-col","gap-x-8","-mr-16","py-6","px-8","rounded-l-2xl","light"],[1,"place-self-center","w-24"],[1,"w-24",3,"src"],[1,"pl-8","overflow-auto","break-word","border-l","text-md",2,"width","220px !important","border-color","black"],[4,"ngIf"],[1,"mt-4","text-md","w-96","pr-8"],[1,"text-xl","font-medium"],[1,"grid","grid-cols-12","gap-x-1","mt-14"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"col-span-2","font-medium","text-md","text-center","text-secondary","pl-10"],[1,"col-span-2","font-medium","text-md","text-right","text-secondary"],["class","col-span-12 grid grid-cols-12 gap-x-1",4,"ngFor","ngForOf"],["class","col-span-12 mt-16",4,"ngIf"],["class","col-span-12  border-b",3,"ngClass",4,"ngIf"],[1,"col-span-10","font-medium","tracking-tight","text-secondary",3,"ngClass"],[1,"flex","flex-col","col-span-2","text-right","font-medium",3,"ngClass"],["class","col-span-2",4,"ngFor","ngForOf"],["class","col-span-8 font-medium text-md mt-10 text-secondary",4,"ngIf"],["class","col-span-12 break-words mt-2",4,"ngIf"],[1,"mt-16"],[1,"flex","items-start","mt-4"],[1,"flex-0","w-10","mt-1",3,"src"],[1,"flex","flex-col","ml-6","w-full"],["style","grid-template-columns: 45px auto !important;","class","grid grid-cols-2 text-sm text-secondary w-full",4,"ngFor","ngForOf"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-end"],["mat-button","",1,"rounded-full",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"col-span-12","grid","grid-cols-12","gap-x-1"],[1,"col-span-12","my-4","border-b"],[1,"col-span-6","text-lg","font-medium"],[1,"col-span-2","self-center","text-center","pl-10"],[1,"col-span-2","self-center","text-right"],[1,"col-span-12","mt-16"],[1,"col-span-12","border-b",3,"ngClass"],[1,"col-span-2"],[1,"col-span-8","font-medium","text-md","mt-10","text-secondary"],[1,"col-span-12","break-words","mt-2"],[1,"grid","grid-cols-2","text-sm","text-secondary","w-full",2,"grid-template-columns","45px auto !important"],[1,"flex","justify-between"],[1,"ml-4"]],template:function(v,y){1&v&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,I,7,3,"div",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),t._uU(7,"OFERTA"),t.qZA(),t.TgZ(8,"div",7),t._uU(9),t.qZA(),t.TgZ(10,"div",8),t._uU(11,"VALIDEZ"),t.qZA(),t.TgZ(12,"div",9),t._uU(13),t.qZA(),t.TgZ(14,"div",8),t._uU(15,"ESTADO"),t.qZA(),t.TgZ(16,"div",9),t._uU(17),t.qZA(),t.TgZ(18,"div",8),t._uU(19,"IMPORTE TOTAL"),t.qZA(),t.TgZ(20,"div",9),t.YNc(21,P,3,6,"div",10),t.qZA(),t.TgZ(22,"div",8),t._uU(23,"SOLICITUD"),t.qZA(),t.TgZ(24,"a",11),t._uU(25),t.qZA()(),t.TgZ(26,"div",12)(27,"div",13),t._UZ(28,"img",14),t.qZA(),t.TgZ(29,"div",15)(30,"div",9),t._uU(31),t.qZA(),t.TgZ(32,"div"),t._uU(33),t.qZA(),t.YNc(34,M,2,1,"div",16),t.YNc(35,q,2,1,"div",16),t.TgZ(36,"div"),t._uU(37),t.qZA()()()(),t.TgZ(38,"div",17)(39,"div",18),t._uU(40),t.qZA(),t.YNc(41,b,2,3,"div",16),t.TgZ(42,"div"),t._uU(43),t.qZA(),t.TgZ(44,"div"),t._uU(45),t.qZA()(),t.TgZ(46,"div",19)(47,"div",20),t._uU(48,"PRODUCTO O SERVICIO"),t.qZA(),t.TgZ(49,"div",21),t._uU(50,"CANTIDAD"),t.qZA(),t.TgZ(51,"div",22),t._uU(52,"PRECIO"),t.qZA(),t.TgZ(53,"div",22),t._uU(54,"TOTAL"),t.qZA(),t.YNc(55,j,12,13,"div",23),t.YNc(56,k,1,0,"div",24),t.YNc(57,z,1,4,"div",25),t.TgZ(58,"div",26),t._uU(59,"TOTAL"),t.qZA(),t.TgZ(60,"div",27),t.YNc(61,D,3,6,"div",28),t.qZA(),t.YNc(62,U,2,0,"div",29),t.YNc(63,B,2,1,"span",30),t.qZA(),t.TgZ(64,"div",31)(65,"div",9),t._uU(66,"T\xe9rminos o condiciones de pago."),t.qZA(),t.TgZ(67,"div",32),t._UZ(68,"img",33),t.TgZ(69,"div",34),t.YNc(70,Q,8,2,"div",35),t.qZA()()()()()()),2&v&&(t.xp6(2),t.Q6J("ngIf",!y.authUser),t.xp6(7),t.hij("#",y.selectedQuotation.no,""),t.xp6(4),t.Oqu(y.getValidity()),t.xp6(4),t.Oqu(y.selectedQuotation.status.toUpperCase()),t.xp6(4),t.Q6J("ngForOf",y.totalQuantity),t.xp6(3),t.Q6J("routerLink",t.WLB(32,K,y.linkRequest,y.requestQuotation._id)),t.xp6(1),t.hij("#",y.selectedQuotation.requestNo,""),t.xp6(3),t.Q6J("src",y.merchantQuotation.logoUrl,t.LSH),t.xp6(3),t.Oqu(y.merchantQuotation.name),t.xp6(2),t.HOy("",y.merchantQuotation.address,", ",y.merchantQuotation.city,", ",y.merchantQuotation.state,", ",y.merchantQuotation.country," "),t.xp6(1),t.Q6J("ngIf",y.merchantQuotation.phoneNumbers.length>0),t.xp6(1),t.Q6J("ngIf",y.merchantQuotation.emails.length>0),t.xp6(2),t.Oqu(y.merchantQuotation.website),t.xp6(3),t.AsE("",y.requestQuotation.name," ",y.requestQuotation.lastname,""),t.xp6(1),t.Q6J("ngIf",y.requestQuotation.address),t.xp6(2),t.AsE("",y.requestQuotation.phoneNumber.stateCode," ",y.requestQuotation.phoneNumber.phoneNumber,""),t.xp6(2),t.Oqu(y.requestQuotation.email),t.xp6(10),t.Q6J("ngForOf",y.selectedQuotation.goodsData),t.xp6(1),t.Q6J("ngIf",!y.selectedQuotation.description),t.xp6(1),t.Q6J("ngIf",y.selectedQuotation.description),t.xp6(1),t.Q6J("ngClass",t.WLB(35,N,y.selectedQuotation.description,!y.selectedQuotation.description)),t.xp6(2),t.Q6J("ngClass",t.WLB(38,N,y.selectedQuotation.description,!y.selectedQuotation.description)),t.xp6(1),t.Q6J("ngForOf",y.totalQuantity),t.xp6(1),t.Q6J("ngIf",y.selectedQuotation.description),t.xp6(1),t.Q6J("ngIf",y.selectedQuotation.description),t.xp6(5),t.Q6J("src",y.merchantQuotation.logoUrl,t.LSH),t.xp6(2),t.Q6J("ngForOf",y.selectedQuotation.paymentMethodData.terms))},dependencies:[h.mk,h.sg,h.O5,m.yS,i.PQ,r.lW,f.Hw,h.H9],encapsulation:2,changeDetection:0}),A})()},76863:(L,O,e)=>{e.d(O,{K:()=>x});var d=e(17460),s=e(5e3);let x=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=s.oAB({type:n}),n.\u0275inj=s.cJS({imports:[d.m]}),n})()},59641:(L,O,e)=>{e.d(O,{S:()=>E,x:()=>g});var d=e(62843),s=e(70262),x=e(54004),n=e(5e3),o=e(67272),a=e(35357);let E=(()=>{class l{constructor(p){this._quotationsService=p}resolve(p,h){return this._quotationsService.getQuotations()}}return l.\u0275fac=function(p){return new(p||l)(n.LFG(o.D))},l.\u0275prov=n.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})(),g=(()=>{class l{constructor(p,h){this._quotationsService=p,this._router=h}resolve(p,h){return this._quotationsService.getQuotationById(p.params.quotationId).pipe((0,s.K)(i=>{console.error(i);const r=h.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(r),(0,d._)(i)}),(0,x.U)(i=>{if(!i.ok){let r=h.url.split("/").slice(0,-1).join("/");h.url.includes("public")&&(r=h.url.split("/").slice(0,-2).join("/")),this._router.navigateByUrl(r)}}))}}return l.\u0275fac=function(p){return new(p||l)(n.LFG(o.D),n.LFG(a.F0))},l.\u0275prov=n.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},66861:(L,O,e)=>{e.d(O,{$i:()=>x,uy:()=>n});var d=e(85094);const s=o=>o.quotations,x=(0,d.P1)(s,o=>o.quotation),n=(0,d.P1)(s,o=>o.quotations)},67272:(L,O,e)=>{e.d(O,{D:()=>p});var d=e(40520),s=e(18505),x=e(75714),n=e(97205),o=e(92340),a=e(1494),E=e(5e3),g=e(1235),l=e(85094);const t=o.N.API_URL;let p=(()=>{class h{constructor(i,r,f){this._httpClient=i,this.rolesService=r,this.store=f}getQuotations(i=0,r=20,f="createdAt",I="desc",C="",P=""){const M=(new d.LE).append("page",i).append("size",r).append("sort",f).append("order",I).append("search",C).append("filter",P);return this._httpClient.get(`${t}/quotations/`,{params:M}).pipe((0,s.b)(q=>{this.store.dispatch((0,x.Jr)({pagination:q.pagination})),this.store.dispatch((0,a.ZI)({quotations:q.dataArr}))}))}getQuotationById(i){return this._httpClient.get(`${t}/quotations/${i}`).pipe((0,s.b)(r=>{this.store.dispatch((0,a.Yd)({quotation:r.data}))}))}createQuotation(i){return this._httpClient.post(`${t}/quotations`,i).pipe((0,s.b)(r=>{this.store.dispatch((0,a.T9)({quotation:r.data})),this.store.dispatch((0,a.Yd)({quotation:r.data}))}))}updateQuotation(i){return this._httpClient.patch(`${t}/quotations/${i._id}`,i).pipe((0,s.b)(r=>{this.store.dispatch((0,a.qm)({quotation:r.data}))}))}acceptQuotation(i){return this._httpClient.patch(`${t}/quotations/accept`,{_id:i,status:n.qm.Aceptada}).pipe((0,s.b)(r=>{this.store.dispatch((0,a.qm)({quotation:r.data})),this.store.dispatch((0,a.Yd)({quotation:r.data}))}))}rejectQuotation(i,r=""){return this._httpClient.patch(`${t}/quotations/reject`,{_id:i,rejectedReason:r,status:n.qm.Rechazada}).pipe((0,s.b)(f=>{this.store.dispatch((0,a.qm)({quotation:f.data})),this.store.dispatch((0,a.Yd)({quotation:f.data}))}))}deleteQuotation(i,r=0,f=20,I="createdAt",C="desc",P="",M=""){const q=(new d.LE).append("page",r).append("size",f).append("sort",I).append("order",C).append("search",P).append("filter",M);return this._httpClient.delete(`${t}/quotations/${i}`,{params:q}).pipe((0,s.b)(b=>{this.store.dispatch((0,x.Jr)({pagination:b.pagination})),this.store.dispatch((0,a.ZI)({quotations:b.dataArr}))}))}}return h.\u0275fac=function(i){return new(i||h)(E.LFG(d.eN),E.LFG(g.cM),E.LFG(l.yh))},h.\u0275prov=E.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},97205:(L,O,e)=>{e.d(O,{R8:()=>x,qm:()=>s});var s=(()=>{return(n=s||(s={})).Nueva="Nueva",n.Aceptada="Aceptada",n.Facturada="Facturada",n.Rechazada="Rechazada",n.Vencida="Vencida",s;var n})();class x{constructor(o){this.paymentMethodId=o._id,this.name=o.name,this.merchantId=o.merchantId,this.terms=o.terms,this.paymentBy=o.paymentBy,this.includeBankAccount=o.includeBankAccount}}},32627:(L,O,e)=>{e.d(O,{d:()=>k});var d=e(77579),s=e(82722),x=e(54899),n=e(58493),o=e(54641),E=e(15439),g=e.n(E),l=e(54787),t=e(5e3),p=e(85094),h=e(69808),m=e(29071),i=e(47423),r=e(25245);function f(R,z){if(1&R){const D=t.EpF();t.TgZ(0,"div",29)(1,"button",30),t.NdJ("click",function(){t.CHM(D);const B=t.oxw();return t.KtG(B.generatePDF("open"))}),t._UZ(2,"mat-icon",31),t.qZA(),t.TgZ(3,"button",30),t.NdJ("click",function(){t.CHM(D);const B=t.oxw();return t.KtG(B.generatePDF("download"))}),t._UZ(4,"mat-icon",31),t.qZA(),t.TgZ(5,"button",30),t.NdJ("click",function(){t.CHM(D);const B=t.oxw();return t.KtG(B.generatePDF("print"))}),t._UZ(6,"mat-icon",31),t.qZA()()}2&R&&(t.xp6(2),t.Q6J("svgIcon","heroicons_outline:eye"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:download"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:printer"))}function I(R,z){if(1&R&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&R){const D=t.oxw();t.xp6(1),t.hij(" ",D.merchantRequest.phoneNumbers[0].stateCode+" "+D.merchantRequest.phoneNumbers[0].phoneNumber,"")}}function C(R,z){if(1&R&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&R){const D=t.oxw();t.xp6(1),t.Oqu(D.merchantRequest.emails[0].email)}}function P(R,z){if(1&R&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&R){const D=t.oxw();t.xp6(1),t.lnq("",D.selectedRequest.address,", ",D.selectedRequest.city,", ",D.selectedRequest.state,", Cuba ")}}const M=function(){return[""]};function q(R,z){if(1&R&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&R){const D=z.$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,D.total,t.DdM(5,M))," ",D.currency,"")}}const b=function(){return["$"]};function F(R,z){if(1&R&&(t.TgZ(0,"div",32),t._UZ(1,"div",24),t.TgZ(2,"div",33)(3,"div",34),t._uU(4),t.qZA(),t.TgZ(5,"div",35),t._uU(6),t.qZA()(),t.TgZ(7,"div",36),t._uU(8),t.qZA(),t.TgZ(9,"div",37),t._uU(10),t.ALo(11,"currency"),t.qZA(),t.TgZ(12,"div",37),t._uU(13),t.ALo(14,"currency"),t.qZA()()),2&R){const D=z.$implicit;t.xp6(4),t.Oqu(D.name),t.xp6(2),t.hij(" ",D.description," "),t.xp6(2),t.Oqu(D.amount),t.xp6(2),t.AsE("",t.xi3(11,6,D.price,t.DdM(12,M))," ",D.currency,""),t.xp6(3),t.Oqu(t.xi3(14,9,D.quantity,t.DdM(13,b)))}}function j(R,z){if(1&R&&(t.TgZ(0,"div",38),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&R){const D=z.$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,D.total,t.DdM(5,M))," ",D.currency,"")}}o.vfs=n.I.vfs,g().locale("es");let k=(()=>{class R{constructor(D,U){this.store=D,this._changeDetectorRef=U,this.selectedRequest$=null,this.selectedRequest=null,this.authUser=null,this.totalQuantity=[],this._unsubscribeAll=new d.x}ngOnInit(){this.store.select(l.rk).pipe((0,s.R)(this._unsubscribeAll)).subscribe(D=>{this.authUser=D,this._changeDetectorRef.markForCheck()}),this.selectedRequest$=this.store.select(x.V8),this.selectedRequest$.pipe((0,s.R)(this._unsubscribeAll)).subscribe(D=>{this.selectedRequest=D,this.merchantRequest=D.merchantId,this.totalQuantity=this.getTotalQuantity(D),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}generatePDF(D){const B={content:[{columns:[{columns:[this.merchantRequest.logoUrl?{image:"logo",width:60,alignment:"center",margin:[0,9,15,0]}:{},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:77,lineWidth:.1,lineColor:"#d2d6dd"}],width:1},{stack:[{text:this.merchantRequest.name,alignment:"left",fontSize:8,bold:!0},{text:`${this.merchantRequest.address}, ${this.merchantRequest.city}, ${this.merchantRequest.state}, ${this.merchantRequest.country}`,alignment:"left",fontSize:8},this.merchantRequest.phoneNumbers.length>0?{text:`${this.merchantRequest.phoneNumbers[0].stateCode}  ${this.merchantRequest.phoneNumbers[0].phoneNumber}`,alignment:"left",fontSize:8}:{},this.merchantRequest.emails.length>0?{text:`${this.merchantRequest.emails[0].email}`,alignment:"left",fontSize:8}:{},{text:this.merchantRequest.website,alignment:"left",fontSize:8}],width:150,margin:[15,2,0,0],lineHeight:1.2,alignment:"right"}],margin:[0,5,0,0]},{columns:[{stack:[{text:"SOLICITUD",alignment:"right",fontSize:16},{text:"CREADA EL",alignment:"right",margin:[0,4,0,0],fontSize:9},{text:"ESTADO",alignment:"right",margin:[0,4,0,0],fontSize:9},{text:"IMPORTE TOTAL",alignment:"right",margin:[0,4,0,0],fontSize:9}],width:100,color:"#7b838e"},{stack:[{text:this.selectedRequest.no,alignment:"left",fontSize:16,margin:[0,0,0,0],bold:!0},{text:g()(this.selectedRequest.createdAt).format("L"),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},{text:this.selectedRequest.status.toUpperCase(),alignment:"left",bold:!0,opacity:.7,margin:[0,4,0,0],fontSize:9},...this.totalQuantity.map(Q=>[{stack:[{text:`${Q.total.toFixed(2)} ${Q.currency}`,alignment:"left",bold:!0,opacity:.7,fontSize:9}],margin:[0,4,0,0]}])]}],columnGap:10}],margin:[16,0,0,15]},{columns:[{text:"Por",alignment:"center",color:"#7b838e",width:60,fontSize:14,margin:[0,this.selectedRequest.address?17:7,20,0]},{canvas:[{type:"line",x1:0,y1:0,x2:0,y2:this.selectedRequest.address?56:33,lineWidth:.1,lineColor:"#d2d6dd"}],width:1},{stack:[{text:`${this.selectedRequest.name}  ${this.selectedRequest.lastname}`,alignment:"left",fontSize:8,bold:!0,opacity:.8},this.selectedRequest.address?{text:`${this.selectedRequest.address}, ${this.selectedRequest.city}, ${this.selectedRequest.state}, Cuba`,alignment:"left",lineHeight:1.2,fontSize:8}:{},{text:`${this.selectedRequest.phoneNumber.stateCode} ${this.selectedRequest.phoneNumber.phoneNumber}`,alignment:"left",lineHeight:1.2,fontSize:8},{text:this.selectedRequest.email,alignment:"left",lineHeight:1.2,fontSize:8}],lineHeight:1.2,width:150,margin:[15,0,0,0]}],margin:[16,16,0,5]},{columns:[{text:"PRODUCTO O SERVICIO",color:"#64748B",alignment:"left",fontSize:8,width:350},{text:"CANTIDAD",color:"#64748B",alignment:"center",fontSize:8,width:40},{text:"PRECIO",color:"#64748B",alignment:"right",fontSize:8,width:70},{text:"TOTAL",color:"#64748B",alignment:"right",fontSize:8}],margin:[0,35,0,4]},{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]},...this.selectedRequest.goodsData.map(Q=>[{stack:[{columns:[{stack:[{text:Q.name,alignment:"left",fontSize:9,bold:!0,opacity:.7},{text:Q.description,alignment:"left",fontSize:7,bold:!0,color:"#64748B",opacity:.7}],lineHeight:1.5,width:350},{stack:[{columns:[{text:Q.amount,alignment:"center",fontSize:9,width:40},{text:`${Q.price.toFixed(2)} ${Q.currency}`,alignment:"right",fontSize:9,width:70},{text:`$${Q.quantity.toFixed(2)}`,alignment:"right",fontSize:9}],margin:Q.description?[0,7,0,0]:[0,0,0,0]}]}],margin:[0,4,0,2]},{canvas:[{type:"line",x1:0,y1:0,x2:535,y2:0,lineWidth:.1,lineColor:"#d2d6dd"}]}]}]),{columns:[{text:"Total",alignment:"left",fontSize:12,color:"#7b838e"},{stack:[...this.totalQuantity.map(Q=>[{stack:[{text:`${Q.total.toFixed(2)} ${Q.currency}`,alignment:"right",bold:!0,opacity:.7,fontSize:12}]}])]}],margin:[0,35,0,0]}],footer:(Q,K,N)=>[K>1?{text:Q.toString()+" de "+K,alignment:"center",margin:[0,30,0,0]}:{text:"",alignment:"center"},{canvas:[{type:"rect",x:170,y:32,w:N.width-170,h:40}],margin:[0,30,0,0]}],defaultStyle:{fontSize:12},pageOrientation:"portrait",pageSize:"LETTER",pageMargins:[40,40,40,80],info:{title:"Solicitud",author:"",subject:"",creationDate:new Date},images:{logo:this.merchantRequest.logoUrl}};switch(D){case D="download":o.createPdf(B).download();break;case D="open":o.createPdf(B).open();break;case D="print":o.createPdf(B).print()}}getTotalQuantity(D){return D.goodsData.reduce((U,{currency:B})=>{if(!U.some(Q=>Q.currency===B)){const Q=D.goodsData.filter(K=>K.currency===B).map(K=>K.quantity).reduce((K,N)=>K+N,0);U.push({currency:B,total:Q})}return U},[])}}return R.\u0275fac=function(D){return new(D||R)(t.Y36(p.yh),t.Y36(t.sBO))},R.\u0275cmp=t.Xpm({type:R,selectors:[["request-details"]],decls:62,vars:24,consts:[["cdkScrollable","",1,"flex","md:justify-center","w-full","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","text-left","print:p-0"],["class","flex items-center flex-shrink-0 mt-6 md:mt-0 sm:ml-4 gap-x-4 justify-end",4,"ngIf"],[1,"w-240","min-w-240","p-16","rounded-2xl","shadow","bg-card","print:w-auto","print:p-0","print:rounded-none","print:shadow-none","print:bg-transparent"],[1,"flex","items-start","overflow-hidden"],[1,"grid","grid-rows-2","place-items-start","gap-y-12","w-6/12","overflow-hidden"],[1,"grid","gap-x-8","w-full","overflow-hidden",2,"grid-template-columns","96px auto !important"],[1,"place-self-center","w-24"],[1,"w-24",3,"src"],[1,"pl-10","border-l","text-md","overflow-auto","break-word"],[1,"font-medium"],[4,"ngIf"],[1,"grid","gap-x-8",2,"grid-template-columns","96px auto !important"],[1,"place-self-center","w-24","text-center","text-2xl","text-secondary"],[1,"grid","gap-x-4","gap-y-1","ml-auto",2,"grid-template-columns","123px auto !important"],[1,"justify-self-end","text-3xl","tracking-tight","text-secondary"],[1,"text-2xl","flex","items-center","font-medium"],[1,"justify-self-end","font-medium","tracking-tight","text-secondary"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-12","gap-x-1","mt-8"],[1,"col-span-6","font-medium","text-md","text-secondary"],[1,"col-span-2","font-medium","text-md","text-center","text-secondary","pl-10"],[1,"col-span-2","font-medium","text-md","text-right","text-secondary"],["class","col-span-12 grid grid-cols-12 gap-x-1",4,"ngFor","ngForOf"],[1,"col-span-12","my-4","border-b"],[1,"col-span-12","mt-16"],[1,"col-span-4","text-2xl","font-medium","tracking-tight","text-secondary"],[1,"flex","flex-col","col-span-8","justify-end","font-medium","text-right","text-2xl"],["class","col-span-2",4,"ngFor","ngForOf"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-end"],["mat-button","",1,"rounded-full",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"col-span-12","grid","grid-cols-12","gap-x-1"],[1,"col-span-6"],[1,"text-lg","font-medium"],[1,"mt-2","text-md","text-secondary","whitespace-pre-line"],[1,"col-span-2","self-center","text-center","pl-10"],[1,"col-span-2","self-center","text-right"],[1,"col-span-2"]],template:function(D,U){1&D&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,f,7,3,"div",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._UZ(8,"img",8),t.qZA(),t.TgZ(9,"div",9)(10,"div",10),t._uU(11),t.qZA(),t.TgZ(12,"div"),t._uU(13),t.qZA(),t.YNc(14,I,2,1,"div",11),t.YNc(15,C,2,1,"div",11),t.qZA()(),t.TgZ(16,"div",12)(17,"div",13),t._uU(18," Por "),t.qZA(),t.TgZ(19,"div",9)(20,"div",10),t._uU(21),t.qZA(),t._UZ(22,"div"),t.YNc(23,P,2,3,"div",11),t.TgZ(24,"div"),t._uU(25),t.qZA(),t.TgZ(26,"div"),t._uU(27),t.qZA()()()(),t.TgZ(28,"div",14)(29,"div",15),t._uU(30,"SOLICITUD"),t.qZA(),t.TgZ(31,"div",16),t._uU(32),t.qZA(),t.TgZ(33,"div",17),t._uU(34,"CREADA EL"),t.qZA(),t.TgZ(35,"div",10),t._uU(36),t.ALo(37,"date"),t.qZA(),t.TgZ(38,"div",17),t._uU(39,"ESTADO"),t.qZA(),t.TgZ(40,"div",10),t._uU(41),t.qZA(),t.TgZ(42,"div",17),t._uU(43,"IMPORTE TOTAL"),t.qZA(),t.TgZ(44,"div",10),t.YNc(45,q,3,6,"div",18),t.qZA()()(),t.TgZ(46,"div",19)(47,"div",20),t._uU(48,"PRODUCTO O SERVICIO"),t.qZA(),t.TgZ(49,"div",21),t._uU(50,"CANTIDAD"),t.qZA(),t.TgZ(51,"div",22),t._uU(52,"PRECIO"),t.qZA(),t.TgZ(53,"div",22),t._uU(54,"TOTAL"),t.qZA(),t.YNc(55,F,15,14,"div",23),t._UZ(56,"div",24)(57,"div",25),t.TgZ(58,"div",26),t._uU(59,"TOTAL"),t.qZA(),t.TgZ(60,"div",27),t.YNc(61,j,3,6,"div",28),t.qZA()()()()()),2&D&&(t.xp6(2),t.Q6J("ngIf",!U.authUser),t.xp6(6),t.Q6J("src",U.merchantRequest.logoUrl,t.LSH),t.xp6(3),t.Oqu(U.merchantRequest.name),t.xp6(2),t.HOy("",U.merchantRequest.address,", ",U.merchantRequest.city,", ",U.merchantRequest.state,", ",U.merchantRequest.country," "),t.xp6(1),t.Q6J("ngIf",U.merchantRequest.phoneNumbers.length>0),t.xp6(1),t.Q6J("ngIf",U.merchantRequest.emails.length>0),t.xp6(6),t.AsE("",U.selectedRequest.name," ",U.selectedRequest.lastname,""),t.xp6(2),t.Q6J("ngIf",U.selectedRequest.address),t.xp6(2),t.AsE("",U.selectedRequest.phoneNumber.stateCode," ",U.selectedRequest.phoneNumber.phoneNumber,""),t.xp6(2),t.Oqu(U.selectedRequest.email),t.xp6(5),t.hij("#",U.selectedRequest.no,""),t.xp6(4),t.Oqu(t.xi3(37,21,U.selectedRequest.createdAt,"dd/MM/yyyy")),t.xp6(5),t.Oqu(U.selectedRequest.status.toUpperCase()),t.xp6(4),t.Q6J("ngForOf",U.totalQuantity),t.xp6(10),t.Q6J("ngForOf",U.selectedRequest.goodsData),t.xp6(6),t.Q6J("ngForOf",U.totalQuantity))},dependencies:[h.sg,h.O5,m.PQ,i.lW,r.Hw,h.H9,h.uU],encapsulation:2,changeDetection:0}),R})()},94290:(L,O,e)=>{e.d(O,{N:()=>t,r:()=>l});var d=e(4128),s=e(62843),x=e(70262),n=e(54004),o=e(5e3),a=e(12454),E=e(96679),g=e(35357);let l=(()=>{class p{constructor(m,i){this._requestsService=m,this._paymentMethods=i}resolve(m,i){return(0,d.D)([this._requestsService.getRequests(),this._paymentMethods.getActivePaymentWays()])}}return p.\u0275fac=function(m){return new(m||p)(o.LFG(a.r),o.LFG(E.x))},p.\u0275prov=o.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})(),t=(()=>{class p{constructor(m,i){this._requestsService=m,this._router=i}resolve(m,i){return this._requestsService.getRequestById(m.params.requestId).pipe((0,x.K)(f=>{console.error(f);const I=i.url.split("/").slice(0,-1).join("/");return this._router.navigateByUrl(I),(0,s._)(f)}),(0,n.U)(f=>{if(!f.ok){let I=i.url.split("/").slice(0,-1).join("/");i.url.includes("public")&&(I=i.url.split("/").slice(0,-2).join("/")),this._router.navigateByUrl(I)}}))}}return p.\u0275fac=function(m){return new(m||p)(o.LFG(a.r),o.LFG(g.F0))},p.\u0275prov=o.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},54899:(L,O,e)=>{e.d(O,{Mu:()=>n,V8:()=>x});var d=e(85094);const s=o=>o.requests,x=(0,d.P1)(s,o=>o.request),n=(0,d.P1)(s,o=>o.requests)},12454:(L,O,e)=>{e.d(O,{r:()=>p});var d=e(40520),s=e(18505),x=e(75714),n=e(61896),o=e(92340),a=e(82440),E=e(5e3),g=e(1235),l=e(85094);const t=o.N.API_URL;let p=(()=>{class h{constructor(i,r,f){this._httpClient=i,this.rolesService=r,this.store=f}getRequests(i=0,r=20,f="createdAt",I="desc",C="",P=""){const M=(new d.LE).append("page",i).append("size",r).append("sort",f).append("order",I).append("search",C).append("filter",P);return this._httpClient.get(`${t}/requests/`,{params:M}).pipe((0,s.b)(q=>{this.store.dispatch((0,x.Jr)({pagination:q.pagination})),this.store.dispatch((0,a.g1)({requests:q.dataArr}))}))}getRequestById(i){return this._httpClient.get(`${t}/requests/${i}`).pipe((0,s.b)(r=>{this.store.dispatch((0,a.xR)({request:r.data}))}))}createRequest(i){return this._httpClient.post(`${t}/requests`,i).pipe((0,s.b)(r=>{this.store.dispatch((0,a.hG)({request:r.data}))}))}updateRequest(i){return this._httpClient.patch(`${t}/requests/${i._id}`,i).pipe((0,s.b)(r=>{this.store.dispatch((0,a.WN)({request:r.data}))}))}rejectRequest(i,r){return this._httpClient.patch(`${t}/requests/reject`,{_id:i,rejectedReason:r,status:n.eJ.Rechazada}).pipe((0,s.b)(f=>{this.store.dispatch((0,a.WN)({request:f.data}))}))}deleteRequest(i,r=0,f=20,I="createdAt",C="desc",P="",M=""){const q=(new d.LE).append("page",r).append("size",f).append("sort",I).append("order",C).append("search",P).append("filter",M);return this._httpClient.delete(`${t}/requests/${i}`,{params:q}).pipe((0,s.b)(b=>{this.store.dispatch((0,x.Jr)({pagination:b.pagination})),this.store.dispatch((0,a.g1)({requests:b.dataArr}))}))}}return h.\u0275fac=function(i){return new(i||h)(E.LFG(d.eN),E.LFG(g.cM),E.LFG(l.yh))},h.\u0275prov=E.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},61896:(L,O,e)=>{e.d(O,{eJ:()=>s});var s=(()=>{return(n=s||(s={})).Nueva="Nueva",n.Aceptada="Aceptada",n.Rechazada="Rechazada",s;var n})()},71121:(L,O,e)=>{e.d(O,{g:()=>m});var d=e(93075),s=e(48966),x=e(63844),n=e(5e3),o=e(69808),a=e(47423),E=e(25245),g=e(67322),l=e(98833);function t(i,r){1&i&&(n.TgZ(0,"mat-error"),n._uU(1," EL motivo del rechazo es obligatorio "),n.qZA())}function p(i,r){1&i&&(n.TgZ(0,"mat-error"),n._uU(1," EL motivo del rechazo debe contener entre 3 y 1000 caracteres. "),n.qZA())}const h=function(i){return{"cursor-not-allowed":i}};let m=(()=>{class i{constructor(f,I){this.data=f,this._dialogRef=I,this.rejectControl=new d.NI(""),this.rejectedReasonRequired=!0,this.rejectedReasonRequired=f.rejectedReasonRequired}ngOnInit(){this.rejectControl.setValidators(this.rejectedReasonRequired?[d.kI.required,d.kI.minLength(3),d.kI.maxLength(1e3)]:[d.kI.minLength(3),d.kI.maxLength(1e3)]),this.rejectControl.setValue(this.data.rejectedReason)}accept(){this._dialogRef.close({reason:this.rejectControl.value})}cancel(){this._dialogRef.close()}}return i.\u0275fac=function(f){return new(f||i)(n.Y36(s.WI),n.Y36(s.so))},i.\u0275cmp=n.Xpm({type:i,selectors:[["commercial-reject-confirm-dialog"]],decls:28,vars:15,consts:[[1,"ng-star-inserted","h-full"],[1,"relative","flex","flex-col","w-full","h-full"],[1,"h-full","flex","items-center"],[1,"block","w-full"],[1,"flex","flex-col","sm:flex-row","flex-auto","items-center","sm:items-start","p-8","pb-4","sm:pb-6"],["ng-reflect-ng-class","[object Object]",1,"flex","flex-0","items-center","justify-center","w-10","h-10","sm:mr-4","rounded-full","text-blue-600","bg-blue-100","dark:text-blue-50","dark:bg-blue-600","ng-star-inserted"],["role","img","aria-hidden","true","ng-reflect-svg-icon","heroicons_outline:question-mar","data-mat-icon-type","svg","data-mat-icon-name","question-mark-circle","data-mat-icon-namespace","heroicons_outline",1,"mat-icon","notranslate","text-current","mat-icon-no-color"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","fit","","height","100%","width","100%","preserveAspectRatio","xMidYMid meet","focusable","false"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","flex-col","items-center","sm:items-start","mt-4","sm:mt-0","sm:pr-8","space-y-1","text-center","sm:text-left","ng-star-inserted"],[1,"text-xl","leading-6","font-medium","ng-star-inserted"],[1,"text-secondary","ng-star-inserted"],[1,"pr-8","pl-8","mt-10","sm:mt-0","sm:pl-22","pb-6",3,"autocomplete"],[1,"w-full","fuse-mat-textarea"],["matPrefix","","svgIcon","heroicons_solid:menu-alt-2",1,"hidden","sm:flex","icon-size-5"],["matInput","",3,"formControl","placeholder","minLength","maxLength","required"],[4,"ngIf"],[1,"flex","flex-wrap","tems-center","justify-center","md:justify-end","px-6","py-4","space-x-3","bg-gray-50","dark:bg-black","dark:bg-opacity-10","ng-star-inserted"],["mat-stroked-button","",3,"click"],["mat-flat-button","","mat-button","",3,"color","disabled","ngClass","click"]],template:function(f,I){1&f&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"mat-icon",6),n.O4$(),n.TgZ(7,"svg",7),n._UZ(8,"path",8),n.qZA()()(),n.kcU(),n.TgZ(9,"div",9)(10,"div",10),n._uU(11),n.qZA(),n.TgZ(12,"div",11),n._uU(13),n.qZA()()(),n.TgZ(14,"form",12)(15,"div")(16,"mat-form-field",13)(17,"mat-label"),n._uU(18,"Motivo"),n.qZA(),n._UZ(19,"mat-icon",14)(20,"textarea",15),n.YNc(21,t,2,0,"mat-error",16),n.YNc(22,p,2,0,"mat-error",16),n.qZA()()()()(),n.TgZ(23,"div",17)(24,"button",18),n.NdJ("click",function(){return I.cancel()}),n._uU(25,"Cancelar"),n.qZA(),n.TgZ(26,"button",19),n.NdJ("click",function(){return I.accept()}),n._uU(27," Aceptar "),n.qZA()()()()),2&f&&(n.xp6(11),n.Oqu(I.data.title),n.xp6(2),n.Oqu(I.data.message),n.xp6(1),n.Q6J("autocomplete","off"),n.xp6(6),n.Q6J("formControl",I.rejectControl)("placeholder","Escriba el motivo del rechazo")("minLength",3)("maxLength",1e3)("required",I.rejectedReasonRequired),n.xp6(1),n.Q6J("ngIf",I.rejectControl.hasError("required")),n.xp6(1),n.Q6J("ngIf",I.rejectControl.hasError("maxlength")||I.rejectControl.hasError("minlength")),n.xp6(4),n.Q6J("color","primary")("disabled",I.rejectControl.invalid)("ngClass",n.VKq(13,h,I.rejectControl.invalid)))},dependencies:[o.mk,o.O5,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.F,d.oH,a.lW,E.Hw,g.TO,g.KE,g.hX,g.qo,l.Nt],encapsulation:2,data:{animation:x.L},changeDetection:0}),i})()}}]);