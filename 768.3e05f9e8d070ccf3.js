"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[768],{97231:(C,h,s)=>{s.d(h,{C:()=>i});var t=s(40520),A=s(92340),g=s(5e3);const o=A.N.API_URL;let i=(()=>{class r{constructor(n){this._httpClient=n}uploadImage(n,l){const p=new FormData;return p.append("image",l,l.name),this._httpClient.post(`${o}/cloudinary/upload/${n}`,p)}removeImage(n){let l=n.slice(n.indexOf("upload"),n.length).split(".")[0];l=l.split("/").splice(2,l.length).join("/");const p=(new t.LE).set("public_id",l);return this._httpClient.delete(`${o}/cloudinary/remove`,{params:p})}}return r.\u0275fac=function(n){return new(n||r)(g.LFG(t.eN))},r.\u0275prov=g.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},2491:(C,h,s)=>{s.d(h,{L:()=>A});var t=s(93075);class A{static isEmptyInputValue(o){return null==o||0===o.length}static mustMatch(o,i){return r=>{const u=r.get(o),n=r.get(i);if(!u||!n||(n.hasError("mustMatch")&&(delete n.errors.mustMatch,n.updateValueAndValidity()),this.isEmptyInputValue(n.value)||u.value===n.value))return null;const l={mustMatch:"Las contrase\xf1a no coinciden."};return n.setErrors(l),l}}static strongPassWord(o,i,r,u,n){return l=>{const p=l.value;if(!p)return null;const d=!o||/[A-Z]+/.test(p),v=!i||/[a-z]+/.test(p),k=!r||/[0-9]+/.test(p),F=!u||!/^[a-zA-Z0-9]+$/.test(p);return d&&v&&k&&F&&p.length>=n?null:{password:"La contrase\xf1a no cumple con los est\xe1ndares de seguridad requeridos"}}}static onlyNumber(o){return i=>{const r=i.get(o);if(!r||!r.value||(r.hasError("onlyNumber")&&(delete r.errors.onlyNumber,r.updateValueAndValidity()),/^[a-zA-Z0-9]+$/.test(r.value.toString())))return null;const n={onlyNumber:"Solo se admiten n\xfameros."};return console.log(n),r.setErrors(n),n}}static strongPasWordPattern(){return t.kI.pattern(/((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/)}static emailPattern(){return t.kI.pattern("^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$")}static onlyNumbersPattern(){return t.kI.pattern("^[0-9]*$")}static numbersAndDecimalsPattern(){return t.kI.pattern(/^-?\d*[.,]?\d{0,2}$/)}static onlyAlphabetsWithAccentPattern(){return t.kI.pattern("^[a-zA-Z \xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda\xf1\xd1\xfc\xdc]*$")}static onlyAlphabetsPattern(){return t.kI.pattern("^[a-zA-Z ]*$")}static validateIdNumber(){return o=>{if(!o)return null;let i=o.value;if(!i)return null;void 0!==o.value.idNumber&&(i=o.value.idNumber);const r=parseInt(i.substring(0,2),10),u=parseInt(i.substring(2,4),10)-1,n=parseInt(i.substring(4,6),10),l=new Date(r,u,n);if(l.getFullYear().toString().substring(2,4)===r.toString()&&l.getMonth()===u&&l.getDate()===n)return null;const d={validateIdNumber:"El n\xfamero de identidad introducido es incorrecto"};return o.setErrors(d),d}}static validFullName(o){return i=>{const r=i.get(o);if(!r||!o||(r.hasError("validFullName")&&(delete r.errors.validFullName,r.updateValueAndValidity()),this._isEmptyInputValue(r.value))||r.value.trim().split(" ").length>1)return null;const u={validFullName:"El nombre completo deber\xe1 tener al menos un nombre y un apellido"};return r.setErrors(u),u}}static checkOnSaleQty(o,i){return r=>{const u=r.get(o),n=r.get(i);if(!u||!n||(n.hasError("invalid")&&(delete n.errors.invalid,n.updateValueAndValidity()),u.value>=n.value))return null;const l={invalid:"La cantidad en venta no debe ser mayor a la disponible"};return n.setErrors(l),l}}static luhnValidator(){return o=>o.value?this.luhnCheck(o.value)?null:{luhnCheck:"Formato no v\xe1lido"}:null}static _isEmptyInputValue(o){return null==o||0===o.length}static luhnCheck(o){if(!o||!o.length)return!1;o=o.replace(/\s/g,"");const i=Number(o[o.length-1]),r=o.slice(0,o.length-1).split("").reverse().map(n=>Number(n));let u=0;for(let n=0;n<=r.length-1;n+=2)r[n]=2*r[n],r[n]>9&&(r[n]=r[n]-9);return u=r.reduce((n,l)=>n+l,0),(u+i)%10==0}}},76768:(C,h,s)=>{s.d(h,{w:()=>S});var t=s(5e3),A=s(77579),g=s(82722),o=s(68675),i=s(54004),r=s(78372),u=s(44066),n=s(33921);let l=(()=>{class a{constructor(e){this.apolloProvider=e,this._apollo=this.apolloProvider.use("BALANC")}getCardType(e){return this._apollo.query({query:u.NQ,variables:{cardNumber:e},errorPolicy:"all"})}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(n._M))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var p=s(69808),d=s(93075),v=s(91079),k=s(90508),F=s(47423),I=s(25245),b=s(67322),y=s(98833),_=s(74107),Z=s(87238);const x=["bankAccountNgForm"];function E(a,m){1&a&&(t.TgZ(0,"mat-label"),t._uU(1,"N\xfamero de Cuenta"),t.qZA())}function N(a,m){if(1&a&&t._UZ(0,"img",11),2&a){const e=t.oxw();t.Q6J("src",e.cardImage,t.LSH)}}function B(a,m){1&a&&(t.TgZ(0,"mat-error"),t._uU(1," El n\xfamero de cuenta es obligatorio "),t.qZA())}function T(a,m){1&a&&(t.TgZ(0,"mat-label"),t._uU(1,"Banco"),t.qZA())}function U(a,m){if(1&a&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&a){const e=m.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Q(a,m){1&a&&(t.TgZ(0,"mat-label"),t._uU(1,"Moneda"),t.qZA())}function P(a,m){if(1&a&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&a){const e=m.$implicit;t.Q6J("value",e.iso),t.xp6(1),t.hij(" ",e.iso," ")}}function D(a,m){1&a&&(t.TgZ(0,"mat-label"),t._uU(1,"Beneficiario"),t.qZA())}function J(a,m){1&a&&(t.TgZ(0,"mat-error"),t._uU(1," El beneficiario no presenta un formato v\xe1lido "),t.qZA())}function V(a,m){1&a&&(t.TgZ(0,"mat-error"),t._uU(1," El beneficiario es obligatorio "),t.qZA())}function M(a,m){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",13)(2,"button",14),t.NdJ("click",function(){t.CHM(e);const f=t.oxw();return t.KtG(f.removeBankAccount(f.index))}),t._UZ(3,"mat-icon",15),t.qZA()(),t.BQk()}2&a&&(t.xp6(3),t.Q6J("svgIcon","mat_solid:delete"))}let S=(()=>{class a{constructor(e,c){this._changeDetectorRef=e,this._cardTypesService=c,this.currencies=[],this.remove=new t.vpe,this.cardImage=null,this.cubanBanks=["Metropolitano (BMP)","Popular de Ahorro (BPA)","Cr\xe9dito y Comercio (BANDEC)"],this._unsubscribeAll=new A.x}ngOnInit(){this.bankAccountForm.get("cardType").value&&this.fillFormData(this.bankAccountForm.get("cardType").value),this.filteredBanks=this.bankAccountForm.get("bank").valueChanges.pipe((0,g.R)(this._unsubscribeAll),(0,o.O)(""),(0,i.U)(e=>e?this.cubanBanks.filter(c=>c.toLowerCase().includes(e.toLowerCase())):[])),this.bankAccountForm.get("no").valueChanges.pipe((0,r.b)(600),(0,g.R)(this._unsubscribeAll)).subscribe(e=>{e.length>5&&e.length<11&&this._cardTypesService.getCardType(e).subscribe(({data:c})=>{c&&this.fillFormData(c.cardType)}),e||(this.bankAccountForm.get("bank").enable(),this.bankAccountForm.get("currency").enable(),this.bankAccountForm.get("cardType").setValue(""),this.cardImage=null),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}removeBankAccount(e){this.remove.next(e)}clearForm(){this.bankAccountNgForm.resetForm()}fillFormData(e){e?(this.bankAccountForm.get("bank").setValue(e.name),this.bankAccountForm.get("currency").setValue(e.currency),this.bankAccountForm.get("bank").disable(),this.bankAccountForm.get("currency").disable(),("BMPU"===e.bank||"BMPUW"===e.bank)&&(this.cardImage="assets/images/cards/banmet.webp"),("BPAU"===e.bank||"BPAUW"===e.bank)&&(this.cardImage="assets/images/cards/bpa.webp"),("BANU"===e.bank||"BANW"===e.bank)&&(this.cardImage="assets/images/cards/bandec.webp"),"AIS"===e.name&&(this.cardImage="assets/images/cards/ais.webp"),"MN"===e.currency&&this.bankAccountForm.get("currency").setValue("CUP"),"USD"===e.currency&&this.bankAccountForm.get("currency").setValue("USD"),this.bankAccountForm.get("cardType").setValue(e._id)):(this.bankAccountForm.get("bank").enable(),this.bankAccountForm.get("currency").enable(),this.bankAccountForm.get("cardType").setValue(""),this.cardImage=null)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(t.sBO),t.Y36(l))},a.\u0275cmp=t.Xpm({type:a,selectors:[["bank-account"]],viewQuery:function(e,c){if(1&e&&t.Gf(x,5),2&e){let f;t.iGM(f=t.CRH())&&(c.bankAccountNgForm=f.first)}},inputs:{currencies:"currencies",bankAccountForm:"bankAccountForm",first:"first",last:"last",index:"index"},outputs:{remove:"remove"},decls:27,vars:35,consts:[[1,"grid","grid-cols-1","gap-3","md:grid-cols-2",3,"formGroup"],[1,"flex-auto","mat-fuse-dense"],[4,"ngIf"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","",3,"type","minlength","maxlength","formControlName","placeholder","spellcheck"],["class","w-12 h-8","matSuffix","",3,"src",4,"ngIf"],["maxlength","255","matInput","",3,"type","formControlName","matAutocomplete","placeholder","spellcheck"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["required","",3,"formControlName","placeholder"],["maxlength","255","matInput","",3,"type","formControlName","placeholder","spellcheck"],["matSuffix","",1,"w-12","h-8",3,"src"],[3,"value"],[1,"flex","items-center","w-10","pl-2"],["mat-icon-button","","matTooltip","Eliminar cuenta",1,"w-8","h-8","min-h-8",3,"click"],[1,"icon-size-5",3,"svgIcon"]],template:function(e,c){if(1&e&&(t.TgZ(0,"form",0)(1,"mat-form-field",1),t.YNc(2,E,2,0,"mat-label",2),t._UZ(3,"mat-icon",3)(4,"input",4),t.YNc(5,N,1,1,"img",5),t.YNc(6,B,2,0,"mat-error",2),t.qZA(),t.TgZ(7,"mat-form-field",1),t.YNc(8,T,2,0,"mat-label",2),t._UZ(9,"mat-icon",3)(10,"input",6),t.TgZ(11,"mat-autocomplete",null,7),t.YNc(13,U,2,2,"mat-option",8),t.ALo(14,"async"),t.qZA()(),t.TgZ(15,"mat-form-field",1),t.YNc(16,Q,2,0,"mat-label",2),t._UZ(17,"mat-icon",3),t.TgZ(18,"mat-select",9),t.YNc(19,P,2,2,"mat-option",8),t.qZA()(),t.TgZ(20,"mat-form-field",1),t.YNc(21,D,2,0,"mat-label",2),t._UZ(22,"mat-icon",3)(23,"input",10),t.YNc(24,J,2,0,"mat-error",2),t.YNc(25,V,2,0,"mat-error",2),t.qZA(),t.YNc(26,M,4,1,"ng-container",2),t.qZA()),2&e){const f=t.MAs(12);t.Q6J("formGroup",c.bankAccountForm),t.xp6(2),t.Q6J("ngIf",c.first),t.xp6(1),t.Q6J("svgIcon","mat_solid:credit_card"),t.xp6(1),t.Q6J("type","text")("minlength",16)("maxlength",24)("formControlName","no")("placeholder","Ejemplo: 1234567890123456")("spellcheck",!1),t.xp6(1),t.Q6J("ngIf",c.cardImage),t.xp6(1),t.Q6J("ngIf",c.bankAccountForm.get("no").hasError("required")),t.xp6(2),t.Q6J("ngIf",c.first),t.xp6(1),t.Q6J("svgIcon","mat_solid:account_balance"),t.xp6(1),t.Q6J("type","text")("formControlName","bank")("matAutocomplete",f)("placeholder","Ejemplo: Banco Financiero")("spellcheck",!1),t.xp6(3),t.Q6J("ngForOf",t.lcZ(14,33,c.filteredBanks)),t.xp6(3),t.Q6J("ngIf",c.first),t.xp6(1),t.Q6J("svgIcon","mat_solid:monetization_on"),t.xp6(1),t.Q6J("formControlName","currency")("placeholder","Ejemplo: USD"),t.xp6(1),t.Q6J("ngForOf",c.currencies),t.xp6(2),t.Q6J("ngIf",c.first),t.xp6(1),t.Q6J("svgIcon","mat_solid:business"),t.xp6(1),t.Q6J("type","text")("formControlName","beneficiary")("placeholder","Ejemplo: Empresa SRL")("spellcheck",!1),t.xp6(1),t.Q6J("ngIf",c.bankAccountForm.get("beneficiary").hasError("pattern")),t.xp6(1),t.Q6J("ngIf",c.bankAccountForm.get("beneficiary").hasError("required")),t.xp6(1),t.Q6J("ngIf",!(c.first&&c.last))}},dependencies:[p.sg,p.O5,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.wO,d.nD,d.sg,d.u,v.XC,v.ZL,k.ey,F.lW,I.Hw,b.TO,b.KE,b.hX,b.qo,b.R9,y.Nt,_.gD,Z.gM,p.Ov],encapsulation:2,changeDetection:0}),a})()}}]);